define("router",[],function(){return Backbone.Router.extend({routes:{following:"following",followers:"followedBy",contact:"contact",cart:"cart",import:"import","following-feed":"followingFeed","":"following","*actions":"following"},followingFeed:function(t){Following.Events.trigger("slidepanel:close"),$("[data-section]").addClass("hidden"),$('[data-section="following-feed"]').removeClass("hidden"),"object"==typeof Following.View.Navigation&&Following.View.Navigation.setActive("following-feed")},following:function(){console.trace(),Following.Events.trigger("slidepanel:close"),$("[data-section]").addClass("hidden"),$('[data-section="follow-section"]').removeClass("hidden"),Following.View.Following.showSection("following"),"object"==typeof Following.View.Navigation&&Following.View.Navigation.setActive("following")},followedBy:function(){Following.Events.trigger("slidepanel:close"),$("[data-section]").addClass("hidden"),$('[data-section="follow-section"]').removeClass("hidden"),Following.View.Following.showSection("followers"),Following.View.Navigation.setActive("followers")},contact:function(){Following.Events.trigger("slidepanel:show_contact_form")},cart:function(){Following.Events.trigger("slidepanel:show_cart")},import:function(){Following.Events.trigger("slidepanel:show_import")}})}),define("_models/default",[],function(){return Backbone.Model.extend({initialize:function(){},fetch:function(t){$("script[data-set='Default']").html()?(this.set($.parseJSON($("script[data-set='Default']").html()),t),$("script[data-set='Default']").remove()):Backbone.Model.prototype.fetch.apply(this,arguments)}})}),define("text",["module"],function(t){"use strict";var e,n,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,s=l&&location.protocol&&location.protocol.replace(/\:/,""),r=l&&location.hostname,c=l&&(location.port||void 0),d=[],p=t.config&&t.config()||{};return e={version:"2.0.1",strip:function(t){if(t){var e=(t=t.replace(o,"")).match(a);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var t,e,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){n=i[e];try{t=new ActiveXObject(n)}catch(t){}if(t){i=[n];break}}return t},parseName:function(t){var e=!1,n=t.indexOf("."),i=t.substring(0,n),o=t.substring(n+1,t.length);return-1!==(n=o.indexOf("!"))&&(e="strip"===(e=o.substring(n+1,o.length)),o=o.substring(0,n)),{moduleName:i,ext:o,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,n,i,o){var a,l,s,r=e.xdRegExp.exec(t);return!r||(a=r[2],s=(l=(l=r[3]).split(":"))[1],l=l[0],!(a&&a!==n||l&&l.toLowerCase()!==i.toLowerCase()||(s||l)&&s!==o))},finishLoad:function(t,n,i,o){i=n?e.strip(i):i,p.isBuild&&(d[t]=i),o(i)},load:function(t,n,i,o){if(!o.isBuild||o.inlineText){p.isBuild=o.isBuild;var a=e.parseName(t),d=a.moduleName+"."+a.ext,u=n.toUrl(d),g=p.useXhr||e.useXhr;!l||g(u,s,r,c)?e.get(u,function(n){e.finishLoad(t,a.strip,n,i)},function(t){i.error&&i.error(t)}):n([d],function(t){e.finishLoad(a.moduleName+"."+a.ext,a.strip,t,i)})}else i()},write:function(t,n,i,o){if(d.hasOwnProperty(n)){var a=e.jsEscape(d[n]);i.asModule(t+"!"+n,"define(function () { return '"+a+"';});\n")}},writeFile:function(t,n,i,o,a){var l=e.parseName(n),s=l.moduleName+"."+l.ext,r=i.toUrl(l.moduleName+"."+l.ext)+".js";e.load(s,i,function(n){var i=function(t){return o(r,t)};i.asModule=function(t,e){return o.asModule(t,r,e)},e.write(t,s,i,a)},a)}},"undefined"!=typeof process&&process.versions&&process.versions.node?(n=require.nodeRequire("fs"),e.get=function(t,e){var i=n.readFileSync(t,"utf8");0===i.indexOf("\ufeff")&&(i=i.substring(1)),e(i)}):e.createXhr()?e.get=function(t,n,i){var o=e.createXhr();o.open("GET",t,!0),p.onXhr&&p.onXhr(o,t),o.onreadystatechange=function(e){var a,l;4===o.readyState&&((a=o.status)>399&&a<600?((l=new Error(t+" HTTP status: "+a)).xhr=o,i(l)):n(o.responseText))},o.send(null)}:"undefined"!=typeof Packages&&(e.get=function(t,e){var n,i,o=new java.io.File(t),a=java.lang.System.getProperty("line.separator"),l=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),"utf-8")),s="";try{for(n=new java.lang.StringBuffer,(i=l.readLine())&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),n.append(i);null!==(i=l.readLine());)n.append(a),n.append(i);s=String(n.toString())}finally{l.close()}e(s)}),e}),define("text!_templates/navigation.html",[],function(){return'<div class="x h2 c12 oh bs-navigation-primary noselect highlight-disable">\n\t<div class="x xa py2 xjc active clickable" data-destination="following-feed" style="display: none;">\n\t\tFollowing Feed\n\t</div>\n\t<div class="x xa clickable col-half" data-destination="following">\n\t\t<div class="x xa py2 pl4">\n\t\t\tFollowing\n\t\t</div>\n\t\t<div data-following-count class="x xa py2 pr3 xje xn pl1 type-mono type-size-small color-grey-medium" style="line-height: 1.6;">\n\t\t\t<%= (following_count > 0) ? following_count : \'\' %>\n\t\t</div>\n\t</div>\n\t<div class="x xa clickable col-half" data-destination="followers">\n\t\t<div class="x xa py2 pl4">\n\t\t\tFollowers\n\t\t</div>\n\t\t<div data-followers-count class="x xa py2 pr3 xje xn pl1 type-mono type-size-small color-grey-medium" style="line-height: 1.6;">\n\t\t\t<%= (followedby_count > 0) ? followedby_count : \'\' %>\n\t\t</div>\n\t</div>\n\t<div class="" style="width: 4.1rem; background: transparent;" data-container="star"></div>\n</div>'}),define("_views/Navigation",["text!_templates/navigation.html"],function(t){return Backbone.View.extend({template:_.template(t),events:{},initialize:function(){Following.Collection.followingCollection.on("all",this.updateFanCounts,this),Following.Collection.followedByCollection.on("all",this.updateFanCounts,this)},render:function(){return this.$el.html(this.template({following_count:Following.Model.Default.get("following_count"),followedby_count:Following.Model.Default.get("followedby_count")})),this},updateFanCounts:function(){var t=Following.Model.Default.get("following_count");t=t>0?t:"";var e=Following.Model.Default.get("followedby_count");e=e>0?e:"",this.$el.find("[data-following-count]").text(t.toLocaleString()),this.$el.find("[data-followers-count]").text(e.toLocaleString())},setActive:function(t){this.$el.find("[data-destination]").removeClass("active"),$('[data-destination="'+t+'"]').addClass("active")}})}),define("_models/Follow",[],function(){return Backbone.Model.extend({initialize:function(){},url:function(){var t=Following.Model.Default.get("api_path")+"/follow";return t+=this.get("id")?"/"+this.get("id"):""}})}),define("text!_templates/following.html",[],function(){return'<div class="x xw box bs-container-grid" data-section="following" data-fans>\n\t<% if(model.is_editor && !defaults.following_has_imported) { %>\n\t\t<div class="dib color-grey-medium-light color-grey-light type-size-normalish p-2 p-bottom-4" style="opacity: .5;">\n\t\t\t<span data-import-following class="clickable color-grey-medium-light" style="border-bottom: 1px solid #a3a3a3;">Move Following data</span>\n\t\t\t<span>from a Cargo 1 Site</span>\n\t\t</div> \n\t<%}%>\n\t\x3c!-- Yay there is no following data yet --\x3e\n</div>\n\n<div class="x xw box bs-container-grid" data-section="followers" data-fans-of>\n\t<% if(model.is_editor && !defaults.following_has_imported) { %>\n\t\t<div class="dib color-grey-medium-light color-grey-light type-size-normalish p-2 p-bottom-4" style="opacity: .5;">\n\t\t\t<span data-import-following class="clickable color-grey-medium-light" style="border-bottom: 1px solid #a3a3a3;">Move Following data</span>\n\t\t\t<span>from a Cargo 1 Site</span>\n\t\t</div> \n\t<%}%>\n</div>'}),define("text!_templates/follower-single.html",[],function(){return'<div class="c4 p-2" data-follow-id="<%= follow_model.id %>">\n    <a href="<%= follow_model.follow_site_link %>" target="_top">\n        <div class="box">\n            <div\n                class="bg-cover ratio-square bg-grey-dark psr"\n                style="background-image: url(<%= (follower_img !== undefined) ? follower_img : \'\' %>)"\n            >\n                <% if (follower_img == undefined || follower_img == \'\') { %>\n                    <div class="psa bg-grey-darker" style="width: 100%; height: 100%;">\n                    <svg id="default_follower_img" x="0px" y="0px" viewBox="-2 4 34 34" style="enable-background:new -2 4 34 34; opacity: .65;">\n                    <polygon style="enable-background:new;" points="21.2999878,19.5 15.8999939,19.5   18.2000122,11.6000061 9.2999878,22.5 14.7999878,22.5 12.6000061,30.3999939 "/>\n                    </svg>\n                    </div>\n                <% } %>\n\n            </div>\n           \n\n            <div class="pt2 h2 color-grey-light lh-1-3 type-size-small fan-name">\n                <%= follow_model.follow_site_name %>\n            </div>\n        </div>\n    </a>\n </div>'}),define("_views/Follower-Single",["text!_templates/follower-single.html"],function(t){return Backbone.View.extend({className:"spotlight-profile",template:_.template(t),events:{},initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.remove,this)},render:function(){var t=this.model.toJSON();return this.$el.attr("data-follow-id",t.id).html(this.template({follow_model:t,follower_img:this.getFollowerIMG()})),this},remove:function(){void 0!==this.unwrappedChildren&&this.unwrappedChildren.remove(),$('[data-follow-id="'+this.model.get("id")+'"]').remove()},getFollowerIMG:function(){var t;if(null!==this.model.get("follow_profile_image_url"))t=this.model.get("follow_profile_image_url");else if(this.model.get("follow_page_image")){var e=this.model.get("follow_page_image"),n=null!==e.thumbnail_crop?e.thumbnail_crop.imageModel:void 0;if(n)t=new top.Cargo.o.model.image(n).getImageWithOptions({w:400}).url}return t=void 0!==t&&t.match("thumb_default_dark")?void 0:void 0!==t?encodeURI(t):t}})}),define("_views/Following",["_models/Follow","text!_templates/following.html","_views/Follower-Single"],function(t,e,n){return Backbone.View.extend({template:_.template(e),fanCollection:void 0,fanOfCollection:void 0,is_paginating:!1,scroll_threshold:1500,current_section:void 0,events:{"click [data-navigation] a":"navigate"},initialize:function(){Following.Collection.followingCollection.on("add",this.addFollower,this),Following.Collection.followedByCollection.on("add",this.addFollowerOf,this),Following.Collection.followingCollection.on("reset",this.resetFollowers,this),Following.Collection.followedByCollection.on("reset",this.resetFollowersOf,this),Following.Events.on("toggle-fan",this.toggleFan,this)},render:function(){return this.$el.html(this.template({model:this.model.toJSON(),defaults:Following.Model.Default.toJSON()})),Following.Collection.followingCollection.comparator=function(t){return-t.get("fan_date")},Following.Collection.followedByCollection.sort(),Following.Collection.followingCollection.each(_.bind(this.addFollower,this)),Following.Collection.followedByCollection.each(_.bind(this.addFollowerOf,this)),this.showSection("following"),$(".following").off("scroll.following").on("scroll.following",this.detectScroll.bind(this)),this},resetFollowers:function(){this.render(),this.showSection(this.current_section)},resetFollowersOf:function(){this.render(),this.showSection(this.current_section)},addFollowerOf:function(t){var e=new n({model:t}).render().$el.children();e.unwrap(),this.$el.find("[data-fans-of]").append(e)},addFollower:function(t){var e=new n({model:t}),i=e.render().$el.children();i.unwrap(),e.unwrappedChildren=i,!0===t.get("newly_created")?this.$el.find("[data-fans]").prepend(i):this.$el.find("[data-fans]").append(i)},detectScroll:function(t){var e=$(t.currentTarget).scrollTop()+$(t.currentTarget).innerHeight()>=$(t.currentTarget)[0].scrollHeight-this.scroll_threshold;!this.is_paginating&&e&&(this.is_paginating=!0,("followers"==this.current_section?Following.Collection.followedByCollection:Following.Collection.followingCollection).fetchNextPage($.proxy(function(t,e,n){0==e.length&&$(".following").unbind("scroll"),this.is_paginating=!1},this)))},showSection:function(t){$("[data-section]",this.el).hide(),$('[data-section="'+t+'"]',this.el).show(),this.current_section=t},toggleFan:function(){var e=this;if(this.model.get("cookie_url")){if(this.model.get("cookie_id")!=this.model.get("id"))if(this.model.get("is_following")){if(!(n=Following.Collection.followedByCollection.findWhere({follow_site_id:parseInt(this.model.get("cookie_id"))})))var n=new t({id:this.model.get("following_id")});var i=parseInt(Following.Model.Default.get("followedby_count"))-1;Following.Model.Default.set("followedby_count",i),n.destroy(),this.model.set("is_following",!1),Following.View.Star.render()}else{this.has_error=!1,new t({follow_site_id:this.model.get("id"),followedby_site_id:this.model.get("cookie_id")}).save({},{success:function(t){var n=parseInt(Following.Model.Default.get("followedby_count"))+1;Following.Model.Default.set("followedby_count",n),Following.Collection.followedByCollection.add(t),Following.Collection.followedByCollection.sort(),e.render(),e.model.set("is_following",!0),Following.View.Star.render(),Following.View.Main.data.parent.Cargo.Event.trigger("add_history","followers"),e.showSection("followers")},error:function(t,n){var i=JSON.parse(n.responseText);i.message&&(e.has_error=!0,parent.window.Cargo.Modal.Alert({message:i.message,selector:"html"}))}})}}else parent.window.Cargo.Modal.Alert({message:"You must be logged in to Follow this site.",selector:"html"})},navigate:function(t){return Following.Router.navigate($(t.currentTarget).attr("href"),!0),!1}})}),define("text!_templates/following-feed.html",[],function(){return'<div class="x noselect" data-spotlight-header>\n\t<div class="xa pt4 pl4 pb0">\n\t\t<svg style="width: 20px; height: 20px;" viewBox="0 0 792 612"><style>.st0{fill:#fff}</style><path class="st0" d="M395.44 17.994c-158.834 0-287.595 128.762-287.595 287.596S236.606 593.186 395.44 593.186 683.036 464.424 683.036 305.59 554.274 17.994 395.44 17.994zm86.584 462.946c0 47.82-38.767 86.584-86.584 86.584s-86.583-38.764-86.583-86.584v-350.7c0-47.82 38.767-86.584 86.583-86.584s86.584 38.764 86.584 86.584v350.7z"/></svg>\n\t\t<span class="h1">\n\t\t\tStream\n\t\t</span>\n\t</div>\n</div>\n\n<div data-following-feed></div>'}),define("text!_templates/following-feed-single.html",[],function(){return'<div class="col-xs-6 pt4 px4">\n\t<a href="<%= follower.follow_site_link %>" target="_blank">\n\t\t<div class="bg-grey-dark">\n\t\t\t<img class="image-auto-height" src="<%= thumbnail_image %>" alt="">\n\t\t</div>\n\t\t<div class="row">\n\t\t\t\x3c!-- <div class="col-square box" style="min-width: 53px;">\n\t\t\t\t<div class="bg-cover ratio-square bg-grey-dark"\n\t\t\t\t\tstyle="background-image: url(<%= follower.follow_profile_image_url %>)"\n\t\t\t\t></div>\n\t\t\t</div> --\x3e\n\t\t\t\x3c!-- <div class="col h2 p3 bg-grey-dark color-white">\n\t\t\t\t<%= follower.follow_site_name %>\n\t\t\t</div> --\x3e\n\t\t\t<div class="col h2 py2 color-white">\n\t\t\t\t<%= follower.follow_site_name %>\n\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</a>\n</div>'}),define("_views/Following-Feed-Single",["text!_templates/following-feed-single.html"],function(t){return Backbone.View.extend({template:_.template(t),thumbnail_image:null,events:{},initialize:function(t){this.defaults_model=t.defaults_model,this.model=t.model},render:function(){var t=this.model.get("follow_page_image");if("string"==typeof t)this.thumbnail_image=t;else if(t){var e=t.thumbnail_crop.imageModel,n=new top.Cargo.o.model.image(e);this.thumbnail_image=n.getImageWithOptions({w:800})}else this.thumbnail_image=this.model.get("follow_profile_image_url");return this.$el.html(this.template({follower:this.model.toJSON(),defaults:this.defaults_model.toJSON(),thumbnail_image:this.thumbnail_image})),this}})}),define("_views/FollowingFeed",["text!_templates/following-feed.html","_views/Following-Feed-Single"],function(t,e){return Backbone.View.extend({id:"following-feed",template:_.template(t),show_feed:null,events:{},data:{},initialize:function(){this.listenTo(Following.Collection.followingCollection,"sync",this.showFollowingFeed)},render:function(){return this.$el.html(this.template({defaults:this.model.toJSON()})),this.$els={followingFeed:this.$el.find("[data-following-feed]")},this.showFollowingFeed(),this},showFollowingFeed:function(){this.addFollowingFeedItems()},addFollowingFeedItems:function(){var t=this;Following.Collection.followingCollection.each(function(n){var i=new e({model:n,defaults_model:t.model});t.$els.followingFeed.append(i.render().el)})},disableClick:function(t){return t.preventDefault(),!1}})}),define("text!_templates/star.html",[],function(){return'<% if(defaults.is_owner) { %>\n\t<div class="" style="background: #444;">\n\t\t<svg class="db" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 40 40" xml:space="preserve" height="41" width="41">\n\t\t\t<g transform="translate(14, 6) scale(0.7)">\n\t\t\t\t<path style="stroke: #666; fill: transparent;" d="M0.848,33.71c-0.205,0-0.362-0.068-0.477-0.152c-0.255-0.186-0.5-0.59-0.216-1.466l2.288-7.044 c0.244-0.75-0.09-1.774-0.726-2.236l-5.993-4.352c-0.744-0.543-0.783-1.015-0.685-1.316c0.097-0.3,0.407-0.66,1.326-0.66H3.77 c0.79,0,1.662-0.632,1.906-1.382l2.29-7.043c0.283-0.876,0.72-1.06,1.037-1.06c0.317,0,0.754,0.185,1.036,1.06l2.288,7.043 c0.244,0.75,1.116,1.382,1.904,1.382h7.405c0.92,0,1.23,0.358,1.326,0.66c0.098,0.3,0.06,0.772-0.683,1.313l-5.993,4.353 c-0.637,0.464-0.97,1.49-0.73,2.24l2.29,7.043c0.284,0.874,0.04,1.28-0.217,1.465c-0.256,0.186-0.717,0.296-1.463-0.247l-5.99-4.352 c-0.64-0.465-1.716-0.465-2.353,0L1.832,33.31C1.422,33.608,1.099,33.71,0.848,33.71z"/>\n\t\t\t</g>\n\t\t</svg>\n\t</div>\n<% } else if (defaults.is_following) { %>\n\t<div class="bg-blue clickable">\n\t\t<svg class="db" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 40 40" xml:space="preserve" height="41" width="41">\n\t\t\t<g transform="translate(14, 6) scale(0.7)">\n\t\t\t\t<path style="fill: #fff" d="M0.848,33.71c-0.205,0-0.362-0.068-0.477-0.152c-0.255-0.186-0.5-0.59-0.216-1.466l2.288-7.044 c0.244-0.75-0.09-1.774-0.726-2.236l-5.993-4.352c-0.744-0.543-0.783-1.015-0.685-1.316c0.097-0.3,0.407-0.66,1.326-0.66H3.77 c0.79,0,1.662-0.632,1.906-1.382l2.29-7.043c0.283-0.876,0.72-1.06,1.037-1.06c0.317,0,0.754,0.185,1.036,1.06l2.288,7.043 c0.244,0.75,1.116,1.382,1.904,1.382h7.405c0.92,0,1.23,0.358,1.326,0.66c0.098,0.3,0.06,0.772-0.683,1.313l-5.993,4.353 c-0.637,0.464-0.97,1.49-0.73,2.24l2.29,7.043c0.284,0.874,0.04,1.28-0.217,1.465c-0.256,0.186-0.717,0.296-1.463-0.247l-5.99-4.352 c-0.64-0.465-1.716-0.465-2.353,0L1.832,33.31C1.422,33.608,1.099,33.71,0.848,33.71z"/>\n\t\t\t</g>\n\t\t</svg>\n\t</div>\n<% } else { %>\n\t<div class="bg-blue clickable">\n\t\t<svg class="db" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 40 40" xml:space="preserve" height="41" width="41">\n\t\t\t<g transform="translate(14, 6) scale(0.7)">\n\t\t\t\t<path style="stroke: #fff; fill: transparent;" d="M0.848,33.71c-0.205,0-0.362-0.068-0.477-0.152c-0.255-0.186-0.5-0.59-0.216-1.466l2.288-7.044 c0.244-0.75-0.09-1.774-0.726-2.236l-5.993-4.352c-0.744-0.543-0.783-1.015-0.685-1.316c0.097-0.3,0.407-0.66,1.326-0.66H3.77 c0.79,0,1.662-0.632,1.906-1.382l2.29-7.043c0.283-0.876,0.72-1.06,1.037-1.06c0.317,0,0.754,0.185,1.036,1.06l2.288,7.043 c0.244,0.75,1.116,1.382,1.904,1.382h7.405c0.92,0,1.23,0.358,1.326,0.66c0.098,0.3,0.06,0.772-0.683,1.313l-5.993,4.353 c-0.637,0.464-0.97,1.49-0.73,2.24l2.29,7.043c0.284,0.874,0.04,1.28-0.217,1.465c-0.256,0.186-0.717,0.296-1.463-0.247l-5.99-4.352 c-0.64-0.465-1.716-0.465-2.353,0L1.832,33.31C1.422,33.608,1.099,33.71,0.848,33.71z"/>\n\t\t\t</g>\n\t\t</svg>\n\t</div>\n<% } %>'}),define("text!_templates/follow-modal.html",[],function(){return'<div data-follow-modal style="display: block;">\n\t\n\t<div class="fm-note">\n\t\n\t\t<% if (defaults.is_following) { %>\n\t\t\tUnfollow?\n\t\t<% } else { %>\n\t\t\t<% if(defaults.cookie_id != false) { %>\n\t\t\tFollow?\n\t\t\t<% } else { %>\n\t\t\tLogin to Follow\n\t\t<% } } %>\n\t\t\n\t</div>\n\t\n\t<% if(defaults.cookie_id != false) { %>\n\t\n\t<div class="fm-logged-in-as">\n\t\t\n\t\t<div class="col-ellipsis" style="padding-left: 12px; text-align: right;">\n\t\t\t<span>You are: </span><span data-current-user><%= defaults.cookie_display_url %> </span> \n\t\t</div>\n\t\t<div class="" style="padding-right: 13px;">\n\t\t\t<% if (sites_list.length >= 2){ %>\t<a href="#" data-change-current-user>change </a><% } %>\n\t\t</div>\n\n\t</div>\n\n\t<div class="hidden" data-site-list>\n\t\t<select name="site_list">\n\t\t\t<% \n\t\t\t\t_.each(sites_list, function(site) { \n\t\t\t\t\tif(defaults.id != site.c2_id) {\n\t\t\t%>\n\t\t\t<option value="<%= site.sumid %>" <% if(defaults.cookie_display_url == site.display_url) { %>selected="selected"<% } %>><%= site.display_url %></option>\n\t\t\t<% \n\t\t\t\t\t}\n\t\t\t\t}); \n\t\t\t%>\n\t\t</select>\n\t\t<div class="arrow-select">\n\t\t\t<div class="arrow-down"></div>\n\t\t</div>\n\t</div>\n\n\t<div class="fm-actions">\n\t\t<a href="#" class="fm-cancel">Cancel</a>\n\t\t<a href="#" class="fm-ok" data-become-a-fan>OK</a>\n\t</div>\n\n\t<% } else { %>\n\t\n\t<div class="fm-actions">\n\t\t<a href="https://cargocollective.com/login" class="fm-ok" data-login-to-fan>Login</a>\n\t\t<a href="#" class="fm-cancel">Cancel</a>\n\t</div>\n\n\n\t<% } %>\n\n\t<style>\n\n\n\n\t\t.follow-modal-overlay {\n\t\t\t-webkit-font-smoothing: antialiased;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tposition: absolute;\n\t\t\tleft: 0;\n\t\t\ttop: 0;\n\t\t\tbackground: rgba(0,0,0,.1);\n\t\t}\n\n\t\t[data-follow-modal] {\n\t\t\tbackground: #fff;\n\t\t\tdisplay: none;\n\t\t\tmargin: -87px 0 0 -170px;\n\t\t\tposition: fixed;\n\t\t\ttop: 40%;\n\t\t\tleft: 50%;\n\t\t\theight: 174px;\n\t\t\twidth: 340px;\n\t\t\tz-index: 9999;\n\n\t\t\t/* A bunch of resets */\n\t\t\tfont-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;\n\t\t\tletter-spacing: 0;\n\t\t\tword-spacing: 0;\n\t\t\tfont-weight: normal;\n\t\t\ttext-decoration: none;\n\t\t\tline-height: 1.6;\n\t\t\t\n\t\t\tbox-sizing: border-box;\n\n\t\t\t   -moz-box-shadow: 5px 5px 0px rgba(0, 0, 0, 0.1);\n\t\t\t-webkit-box-shadow: 5px 5px 0px rgba(0, 0, 0, 0.1);\n\t\t\t\t\tbox-shadow: 5px 5px 0px rgba(0, 0, 0, 0.1);\n\t\t}\n\n\t\t.switch-sites [data-follow-modal] {\n\t\t\theight: 40px;\n\t\t\ttop: 45%;\n\t\t}\n\n\t\t[data-follow-modal].light {\n\t\t\tborder: 1px solid #CCC;\n\t\t}\n\n\t\t[data-follow-modal] .fm-logged-in-as {\n\t\t\tcolor: #ccc;\n\t\t\tfont-size: 13px;\n\t\t\tline-height: 1.7;\n\t\t\tposition: absolute;\n\t\t\tbottom: 58px;\n\t\t\tleft: 50%;\n\t\t\ttransform: translateX(-50%);\n\t\t\tz-index: 9;\n\t\t\tmax-width: 100%;\n\t\t\ttext-align: center;\n\t\t\t-webkit-flex-wrap: nowrap;\n\t\t\t    -ms-flex-wrap: nowrap;\n\t\t\t        flex-wrap: nowrap;\n\t\t\tdisplay: -webkit-box;\n\t\t\tdisplay: -webkit-flex;\n\t\t\tdisplay: -ms-flexbox;\n\t\t\tdisplay: flex;\n\t\t}\n\n\t\t.col {\n\t\t\tline-height: 1.7;\n\t\t\t-webkit-box-flex: 1;\n\t\t\t-webkit-flex: 1;\n\t\t\t    -ms-flex: 1;\n\t\t\t        flex: 1;\n\t\t\tposition: relative;\n\t\t\twhite-space: nowrap;\n\t\t}\n\n\t\t.col-ellipsis {\n\t\t\t    overflow: hidden;\n\t\t    text-overflow: ellipsis;\n\t\t    white-space: nowrap;\n\t\t}\n\n\t\t.col-right {\n\t\t\t-webkit-align-self: flex-end;\n\t\t\t    -ms-flex-item-align: end;\n\t\t\t        align-self: flex-end;\n\t\t\t-webkit-box-flex: 0;\n\t\t\t-webkit-flex: 0 0 auto;\n\t\t\t    -ms-flex: 0 0 auto;\n\t\t\t        flex: 0 0 auto;\n\t\t}\n\n\t\t[data-follow-modal] .fm-logged-in-as a {\n\t\t\tcolor: #ccc;\n\t\t\ttext-decoration: none;\n\t\t\tmargin-left: 4px;\n\t\t\tborder-bottom: 1px solid #eee;\n\t\t\tpadding-bottom: 1px;\n\t\t}\n\n\t\t[data-follow-modal] .fm-actions {\n\t\t\tposition: absolute;\n\t\t\tbottom: 0px;\n\t\t\tright: 0px;\n\t\t\tz-index: 9;\n\t\t\tleft: 0px;\n\t\t\theight: 45px;\n\t\t\tpadding: 0;\n\t\t}\n\n\t\t[data-follow-modal] .fm-actions a {\n\t\t\tdisplay: block;\n\t\t\tfloat: left;\n\t\t\tcolor: #fff;\n\t\t\ttext-decoration: none;\n\t\t\tfont-size: 17px;\n\t\t\tpadding: 7px 0;\n\t\t\tline-height: 1.7;\n\t\t\tbox-sizing: border-box;\n\t\t\tpadding: 7.5px 15px;\n\t\t\tposition: relative;\n\t\t\theight: 100%;\n\t\t}\n\n\t\t[data-follow-modal].is_mobile .fm-actions a {\n\t\t\tfont-size: 19px;\n\t\t}\n\n\t\t[data-follow-modal] .fm-actions a.fm-ok {\n\t\t\tbackground: #698FFF;\n\t\t\tfont-weight: bold;\n\t\t\tcolor: #fff;\n\t\t\twidth: 220px;\n\t\t}\n\n\t\t[data-follow-modal] .fm-actions a.fm-ok:hover {\n\t\t\topacity: 1;\n\t\t}\n\n\t\t[data-follow-modal] .fm-actions a.fm-ok:active {\n\t\t\tbackground: #5981f7;\n\t\t\topacity: 1;\n\t\t}\n\n\t\t[data-follow-modal] .fm-actions a.fm-cancel {\n\t\t\tbackground: rgba(0,0,0,.53);\n\t\t\twidth: 120px;\n\t\t\tcolor: rgba(255,255,255,.8);\n\t\t}\n\n\t\t[data-follow-modal] .fm-actions a.fm-cancel:hover {\n\t\t    opacity: 1;\n\t\t}\n\n\t\t[data-follow-modal] .fm-actions a.fm-cancel:active {\n\t\t    background: #666;\n\t\t    opacity: 1;\n\t\t}\n\n\t\t.switch-sites [data-follow-modal] .fm-actions {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\t[data-follow-modal] .fm-note {\n\t\t\tposition: absolute;\n\t\t\tline-height: 134px;\n\t\t\ttop: 0;\n\t\t\tleft: 50px;\n\t\t\tright: 50px;\n\t\t\ttext-align: center;\n\t\t\twhite-space: nowrap;\n\t\t\toverflow: hidden;\n\t\t\ttext-overflow: ellipsis;\n\t\t\tfont-size: 20px;\n\t\t\tcolor: #333;\n\t\t\tfont-weight: bold;\n\t\t\theight: 134px;\n\t\t}\n\n\t\t[data-follow-modal] [data-site-list] {\n\t\t\tposition: relative;\n\t\t\theight: 40px;\n\t\t\tpadding: 7.5px 15px;\n\t\t\ttop: 0;\n\t\t\tposition: absolute;\n\t\t\twidth: 100%;\n\t\t\tmargin: 0 auto;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\tcursor: pointer;\n\t\t\tdisplay: -webkit-box;\n\t\t\tdisplay: -webkit-flex;\n\t\t\tdisplay: -ms-flexbox;\n\t\t\tdisplay: flex;\n\t\t}\n\n\t\t[data-follow-modal] select[name="site_list"] {\n\t\t\tbackground: #fff;\n\t\t\tfont-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;\n\t\t\tfont-weight: normal;\n\t\t\tfont-size: 17px;\n\t\t\tappearance: none;\n\t\t\t-moz-appearance: none;\n\t\t\t-webkit-appearance: none;\n\t\t\tposition: relative;\n\t\t\tborder: 0;\n\t\t\tmargin: 0;\n\t\t\toutline: none;\n\t\t\twidth: 100%;\n\t\t\t-webkit-font-smoothing: antialiased;\n\t\t\tcursor: pointer;\n\t\t}\n\n\t\t[data-follow-modal] .arrow-select {\n\t\t\tposition: relative;\n\t\t\tdisplay: -webkit-box;\n\t\t\tdisplay: -webkit-flex;\n\t\t\tdisplay: -ms-flexbox;\n\t\t\tdisplay: flex;\n\t\t\t-webkit-box-align: center;\n\t\t\t-webkit-align-items: center;\n\t\t\t-ms-flex-align: center;\n\t\t\talign-items: center;\n\t\t\t-webkit-box-pack: center;\n\t\t\t-webkit-justify-content: center;\n\t\t\t-ms-flex-pack: center;\n\t\t\tjustify-content: center;\n\t\t\tpointer-events: none;\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\twidth: 40px;\n\t\t\tcursor: pointer;\n\t\t}\n\n\t\t[data-follow-modal] .arrow-down {\n\t\t\twidth: 0;\n\t\t\theight: 0;\n\t\t\tborder-left: 4px inset transparent;\n\t\t\tborder-right: 4px inset transparent;\n\t\t\tborder-top: 6px solid #222222;\n\t\t}\n\n\t\t.hidden {\n\t\t\tdisplay: none !important;\n\t\t}\n\n\t\t.disabled {\n\t\t\tpointer-events: none;\n\t\t\topacity: .3;\n\t\t}\n\n\t\tiframe#login_frame {\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tz-index: 99991;\n\t\t}\n\n\t</style>\n\n</div>'}),define("_views/Follow-modal",["text!_templates/follow-modal.html"],function(t){return Backbone.View.extend({template:_.template(t),events:{click:"stopPropagation","click .fm-cancel":"close","click [data-create-site]":"close","click [data-become-a-fan]":"ok","click [data-login-to-fan]":"loginToFan",click:"onclick",keydown:"bindKeyEvents","change select":"SelectSite","click [data-change-current-user]":"showSelectSite","click [data-site-list]":"triggerSelect"},className:"follow-modal-overlay",initialize:function(){Following.Events.on("disable",this.remove,this),Following.Events.on("login:success",this.loginSuccess,this)},render:function(){return this.$el.html(this.template({defaults:this.model.toJSON(),sites_list:Following.Collection.sitesAsEditorCollection.toJSON()})),$(document.body).on("keyup.modal",_.bind(function(t){this.bindKeyEvents(t)},this)),parent.document.getElementsByTagName("html")[0].insertBefore(this.el,null),this.$el.removeClass("switch-sites"),this.isMobile()&&this.$el.find("[data-follow-modal]").addClass("is_mobile"),this},isIOS:function(){return!!navigator.userAgent.match(/i(Phone|Pod|Pad)/i)},isMobile:function(){if(this.isIOS())return!0;var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e},onclick:function(t){t.target===this.el&&this.close(t)},bindKeyEvents:function(t){13==t.which?this.ok(t):27==t.which&&(this.preventDefault(t),this.stopPropagation(t),this.close(t))},stopPropagation:function(t){t.stopImmediatePropagation()},preventDefault:function(t){t.preventDefault()},close:function(t){return t&&this.preventDefault(t),$(document.body).off("keyup.modal"),this.remove(),this.login_iframe&&$(this.login_iframe).remove(),!1},siteMenu:function(){return!1},ok:function(t){return Following.Events.trigger("toggle-fan"),$(document.body).off("keyup.modal"),this.remove(),!1},loginToFan:function(t){var e=document.createElement("iframe");return e.setAttribute("id","login_frame"),e.src="/login?rd=following",e.frameBorder="0",parent.document.getElementsByTagName("html")[0].insertBefore(e,this.el),this.login_iframe=parent.document.getElementById("login_frame"),!1},loginSuccess:function(){var t=this;return Following.Collection.sitesAsEditorCollection.fetch({success:function(){t.model.fetch({success:function(){$(t.login_iframe).remove(),t.render()}})}}),!1},SelectSite:function(t){var e=this,n=Following.Collection.sitesAsEditorCollection.findWhere({sumid:parseInt($(t.currentTarget).val())});return $.post("/dispatch/auth/changeFollowAuth",{c1_id:n.get("c1_id"),c2_id:n.get("c2_id"),sumid:n.get("sumid"),fansite_url:this.model.get("site_url")},function(t){""!=t.error?parent.window.Cargo.Modal.Alert({message:t.error,selector:"html"}):e.model.fetch({success:function(){e.render()}})},"json"),!1},triggerSelect:function(t){if($(t.target).is("[data-site-list]")){var e=$(t.target).find('select[name="site_list"]');if(document.createEvent)(t=document.createEvent("MouseEvents")).initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e[0].dispatchEvent(t);else element.fireEvent&&e[0].fireEvent("onmousedown")}},showSelectSite:function(t){t.preventDefault(),t.stopPropagation(),$(".fm-logged-in-as, .fm-note",this.el).hide(),$("[data-site-list]",this.el).removeClass("hidden"),this.$el.addClass("switch-sites")}})}),define("_views/Star",["text!_templates/star.html","_views/Follow-modal"],function(t,e){return Backbone.View.extend({id:"star",template:_.template(t),events:{click:"toggleFollowing"},initialize:function(){},render:function(){return this.$el.html(this.template({defaults:this.model.toJSON()})),this},toggleFollowing:function(t){var n=this;!0!==this.model.get("is_owner")&&(!1!==this.model.get("cookie_is_c1")?new e({model:this.model}).render():parent.window.Cargo.Modal.Confirm({message:"<em>You’ve not yet saved your Cargo site, click OK to do so</em>",selector:"html",confirm:function(){top.document.location.href=n.model.get("cookie_direct_link")+"/admin/settings"}}))}})}),define("text!_templates/contact.html",[],function(){return'\x3c!-- <div id="close_panel" class="clickable type-size-big color-grey-light <% if(isMobile){print(\'isMobile\')} %>">×</div> --\x3e\n<div class="row os psa t0 r0 b0 l0 py1" style="bottom: 42px; padding-left: 2rem; padding-right: 2rem;" data-message-wrapper>\n\t<div class="xa py2 cursor-default lh-1" style="border-bottom: 1px solid #333; height: 42px;" data-to-address>\n\t\t<span class="type-size-medium">\n\t\t\t<span class="color-grey">To:</span> <%= defaults.website_title %>\n\t\t</span>\n\t</div>\n\n\t<div class="col-xs-6 psr" id="new-message-area" style="height: calc(100% - 42px);" data-new-message>\n\t\t<div class="box color-black type-lh-1-2 pos-relative" style="height: 42px;" data-from-address>\n\t\t\t\n\t\t\t<div class="c12 text-wrapper pos-relative type-size-medium xa x lh-1" data-input-parent style="border-bottom: 1px solid #333; height: 42px;">\n\t\t\t\t<div class="x xn py2">\n\t\t\t\t\t<span class="color-grey focus-field">From:&nbsp;</span>\t\n\t\t\t\t</div>\n\n\t\t\t\t<div class="psr x xa pr3">\n\t\t\t\t\t<input class="input-reset py2 type-size-medium color-white bg-black p-right-0 type-truncate" type="email" value="<% if (defaults.cookie_email) {print(defaults.cookie_email)} %>" placeholder="Enter Your Email Address" name="sender" data-validate="not-empty email" style="padding: 1rem 0rem calc(1rem + 2px) 0">\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t</div>\n\t\t\t\n\t\t</div>\n\n\t\t<div class="x psr pt2" data-input-parent style="height: calc(100vh - 132px);">\n\t\t\t<textarea id="new-message" placeholder="Message:" data-validate="not-empty"  class="psa hf bb3 type-size-medium new-message-height bg-black color-white" rows="4" style="vertical-align: top; -webkit-overflow-scrolling: touch;"></textarea>\n\t\t</div>\n\n\t</div>\n</div>\n\n<div class="x c12 psa b0 bg-black" data-following-footer>\n\t<div class="c8 bg-blue type-bold color-white clickable noselect x" id="send-new-message" style=" border-left: 1px solid #1a1a1a;">\n\t\t<div class="py2 px3 c6">\n\t\t\tSend Email\n\t\t</div>\n\t\t<div class="processing c2 py2 px2 color-white type-right type-bold pos-relative">\n\t\t\t<%= loading_animation(\'loading_animation pulsing white inline right hidden\') %>\n\t\t</div>\n\t</div>\n\n\t<div class="xa bg-grey-medium-dark color-black py2 px3 clickable noselect" data-cancel-message style="margin-left: 1px;">\n\t\tCancel\n\t</div>\n</div>\n'}),define("_views/Contact",["text!_templates/contact.html"],function(t){var e=/^[a-z0-9.!#$%&'*+\/=?^_`{|}~-]+$/i,n=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)+$/i;return Backbone.View.extend({template:_.template(t),events:{"click #send-new-message":"sendNewMessage","click #close_panel":"closeFollowing","click [data-cancel-message]":"cancelMessage","click .focus-field":"focusNearestField","focusin textarea":"adjustForMobile"},initialize:function(){var t=this;Following.Events.on("slidepanel:open_complete",function(e){"contact"==Backbone.history.fragment&&(t.isMobile||t.focusFirstField(),t.bindKeyEvents(),t.$el.removeClass("hidden").show())}),Following.Events.on("slidepanel:close_complete",function(e){"contact-form"==Backbone.history.getFragment()&&t.resetContactForm()})},validators:{"not-empty":function(t){return t.value.length>0},email:function(t){return i=t.value,2===(o=i.split("@")).length&&!!e.test(o[0])&&!!n.test(o[1]);var i,o}},preventDefault:function(t){t.preventDefault()},isIOS:function(){return!!navigator.userAgent.match(/i(Phone|Pod|Pad)/i)},isMobile:function(){if(this.isIOS())return!0;var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e},validateInput:function(t){var e=!0,n=this,i=t.getAttribute("data-validate");return null!=i&&(_.each(i.toLowerCase().split(" "),function(n){!1===this.validators[n](t)&&(e=!1)},this),!1===e?($(t).one("input",function(){n.validateInput(t)}),$(t).closest("[data-input-parent]").addClass("invalid")):$(t).closest("[data-input-parent]").hasClass("invalid")&&$(t).closest("[data-input-parent]").removeClass("invalid"),e)},bindKeyEvents:function(t){_this=this,$(document.body).on("keyup.contact_form",_.bind(function(t){27==t.which&&(t.preventDefault(),t.stopImmediatePropagation(),_this.closeFollowing())},this))},validateForm:function(){var t=!0,e=[],n=this;return this.$el.find("[data-validate]").each(function(i,o){var a=n.validateInput(o);!1===a&&(t=!1),e.push({el:o,valid:a})}),{valid:t,inputs:e}},render:function(t){return this.$el.html(this.template({defaults:this.model.toJSON(),isMobile:this.isMobile()})),this},growMessageField:function(){var t=document.getElementById("new-message");setTimeout(function(){t.focus(),t.select(),t.style.height="auto",t.style.height=t.scrollHeight+"px"},1)},resetContactForm:function(){$(document.body).off("keyup.contact_form"),$("#processing .message").hide(),this.render(),this.$el.addClass("hidden"),Following.Router.navigate("following",!0)},sendNewMessage:function(t){if(this.processingButton(!0),!0!==this.validateForm().valid)return this.processingButton(!1),!1;var e={from:$('input[name="sender"]',this.el).val(),site_id:Following.Model.Default.get("id"),message:$("#new-message",this.el).val()},n=this;$.post("/dispatch/notifications/sendContactMessage",e,function(t){t.error.length>0?(n.processingButton(!1),parent.window.Cargo.Modal.Alert({message:t.error[0],selector:"html"})):(n.$el.fadeOut(),$("#processing").show(),$("#processing .message").prev(".loading_animation_placeholder").replaceWith(loading_animation("gray-dark psa")),$("#processing .loading_animation").fadeIn(400),setTimeout(function(){$("#processing .message").show(),$("#processing .loading_animation").hide(),setTimeout(function(){n.closeFollowing()},1500)},1500))},"json")},processingButton:function(t){1==t?this.$el.find("#send-new-message .processing .loading_animation").removeClass("hidden"):this.$el.find("#send-new-message .processing .loading_animation").addClass("hidden")},closeSlidePanel:function(){Following.Events.trigger("slidepanel:close")},closeFollowing:function(){parent.Cargo.View.Following.Toggle(),Following.Router.navigate("following",!0)},cancelMessage:function(){parent.Cargo.View.Following.Toggle(),this.$el.find("#new-message").val("")},focusFirstField:function(){""==this.$el.find("input").val()?this.$el.find("input").focus():this.$el.find("textarea").focus()},focusNearestField:function(t){var e=$(t.target).closest("[data-input-parent]").find("input");e.focus().val(e.val())},focusEmailField:function(t){var e=this.model.toJSON().cookie_email;"focusin"==t.type&&$(t.target).val()==e?$(t.target).val("").focus():"focusout"!=t.type||""!=$(t.target).val()&&$(t.target).val()!=e||$(t.target).val(e)},adjustForMobile:function(t){t.preventDefault();var e=parseInt($("[data-to-address]").outerHeight(!0))+parseInt($("[data-from-address]").outerHeight(!0));this.isMobile()&&(parent.document.body.scrollTop=e)}})}),define("text!_templates/cart.html",[],function(){return'<div class="oa psa t0 r0 b0 l0 p4 <% if(no_data) { %>hidden<% } %>" <% if(collectShippingInformation || hasLiveProductsInCart) { %>style="bottom: 42px;"<% } %>>\n\t\n\t<div class="x xdc" style="min-height: 100%">\n\n\t\t<% if(collectShippingInformation) { %>\n\n\t\t<div class="pr3 pt0 pb4">\n\t\t\t<div class="col col-full color-grey-light">\n\t\t\t\tEnter your Shipping information\n\t\t\t</div>\n\t\t</div>\n\n\t\t<form id="shipping_address" class="type-size-normal">\n\t\t\t\x3c!-- <input class="field type-truncate" name="country" ></input> --\x3e\n\t\t\t<div class="col col-full row bg-grey-medium-dark mb1 psr">\n\t\t\t\t<select data-required name="country" id="country">\n\t\t\t\t\t<option value="" disabled>Country</option>\n\t\t\t\t</select>\n\t\t\t\t<div class="arrow-select">\n\t\t\t\t\t<div class="arrow-down-arrow-up"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<input class="field type-truncate" name="name" data-required placeholder="Name"></input>\n\n\t\t\t<input class="field type-truncate" name="line1" data-required placeholder="Street and number, P.O. box, c/o."></input>\n\n\t\t\t<input class="field type-truncate" name="line2" placeholder="Apartment, suite, unit, building, floor, etc."></input>\n\t\t\t\n\t\t\t<input class="field type-truncate" name="city" data-required placeholder="City"></input>\n\t\t\t\n\t\t\t<input data-non-us-states class="field type-truncate" name="state" placeholder="State / Province / Region"></input>\n\n\t\t\t<div class="col col-full row bg-grey-medium-dark mb1 psr">\n\t\t\t\t<select name="state" data-us-states data-required style="color: #999;">\n\t\t\t\t\t<option value="" selected disabled>State</option>\n\t\t\t\t\t<option value="AL">Alabama</option>\n\t\t\t\t\t<option value="AK">Alaska</option>\n\t\t\t\t\t<option value="AZ">Arizona</option>\n\t\t\t\t\t<option value="AR">Arkansas</option>\n\t\t\t\t\t<option value="CA">California</option>\n\t\t\t\t\t<option value="CO">Colorado</option>\n\t\t\t\t\t<option value="CT">Connecticut</option>\n\t\t\t\t\t<option value="DE">Delaware</option>\n\t\t\t\t\t<option value="DC">District Of Columbia</option>\n\t\t\t\t\t<option value="FL">Florida</option>\n\t\t\t\t\t<option value="GA">Georgia</option>\n\t\t\t\t\t<option value="HI">Hawaii</option>\n\t\t\t\t\t<option value="ID">Idaho</option>\n\t\t\t\t\t<option value="IL">Illinois</option>\n\t\t\t\t\t<option value="IN">Indiana</option>\n\t\t\t\t\t<option value="IA">Iowa</option>\n\t\t\t\t\t<option value="KS">Kansas</option>\n\t\t\t\t\t<option value="KY">Kentucky</option>\n\t\t\t\t\t<option value="LA">Louisiana</option>\n\t\t\t\t\t<option value="ME">Maine</option>\n\t\t\t\t\t<option value="MD">Maryland</option>\n\t\t\t\t\t<option value="MA">Massachusetts</option>\n\t\t\t\t\t<option value="MI">Michigan</option>\n\t\t\t\t\t<option value="MN">Minnesota</option>\n\t\t\t\t\t<option value="MS">Mississippi</option>\n\t\t\t\t\t<option value="MO">Missouri</option>\n\t\t\t\t\t<option value="MT">Montana</option>\n\t\t\t\t\t<option value="NE">Nebraska</option>\n\t\t\t\t\t<option value="NV">Nevada</option>\n\t\t\t\t\t<option value="NH">New Hampshire</option>\n\t\t\t\t\t<option value="NJ">New Jersey</option>\n\t\t\t\t\t<option value="NM">New Mexico</option>\n\t\t\t\t\t<option value="NY">New York</option>\n\t\t\t\t\t<option value="NC">North Carolina</option>\n\t\t\t\t\t<option value="ND">North Dakota</option>\n\t\t\t\t\t<option value="OH">Ohio</option>\n\t\t\t\t\t<option value="OK">Oklahoma</option>\n\t\t\t\t\t<option value="OR">Oregon</option>\n\t\t\t\t\t<option value="PA">Pennsylvania</option>\n\t\t\t\t\t<option value="RI">Rhode Island</option>\n\t\t\t\t\t<option value="SC">South Carolina</option>\n\t\t\t\t\t<option value="SD">South Dakota</option>\n\t\t\t\t\t<option value="TN">Tennessee</option>\n\t\t\t\t\t<option value="TX">Texas</option>\n\t\t\t\t\t<option value="UT">Utah</option>\n\t\t\t\t\t<option value="VT">Vermont</option>\n\t\t\t\t\t<option value="VA">Virginia</option>\n\t\t\t\t\t<option value="WA">Washington</option>\n\t\t\t\t\t<option value="WV">West Virginia</option>\n\t\t\t\t\t<option value="WI">Wisconsin</option>\n\t\t\t\t\t<option value="WY">Wyoming</option>\n\t\t\t\t</select>\n\t\t\t\t<div class="arrow-select">\n\t\t\t\t\t<div class="arrow-down-arrow-up"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t<input class="field type-truncate" name="postal_code" data-required placeholder="Zip Code"></input>\n\n\t\t</form> \n\n\n\t\t<% } else if(hasLiveProductsInCart) { %>\n\n\t\t<div class="pr3 pt0 pb4">\n\t\t\t<div class="col col-full color-grey-light">\n\t\t\t\tYour Cart\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="group-vertical" data-item-list>\n\t\t\t<% \n\t\t\t\t_.each(cart, function(cartItem){ \n\t\t\t\t\n\t\t\t\t\tif(cartItem.available){\n\n\t\t\t%>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div class="col col-full group-vertical" data-item>\n\t\t\t\t\t\t\t<div class="col col-full row x xje">\n\t\t\t\t\t\t\t\t<style>\n\t\t\t\t\t\t\t\t\tinput[type="number"] {\n\t\t\t\t\t\t\t\t\t  -webkit-appearance: textfield;\n\t\t\t\t\t\t\t\t\t     -moz-appearance: textfield;\n\t\t\t\t\t\t\t\t\t          appearance: textfield;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tinput[type=number]::-webkit-inner-spin-button, \n\t\t\t\t\t\t\t\t\tinput[type=number]::-webkit-outer-spin-button { \n\t\t\t\t\t\t\t\t\t  -webkit-appearance: none;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t</style>\n\t\t\t\t\t\t\t\t<div class="col bg-grey-medium-dark pad-small mb1 type-truncate">\n\t\t\t\t\t\t\t\t\t<%= cartItem.product.name %>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<% \n\t\t\t\t\t\t\t\t\tif(!cartItem.product.is_file){\t\n\t\t\t\t\t\t\t\t%>\n\t\t\t\t\t\t\t\t<div class="ml1 bg-grey-medium-dark mb1 text col-end text psr" style="min-width: 6.5rem;">\n\t\t\t\t\t\t\t\t\t<input data-change="<%= cartItem.productID + \',\' + cartItem.skuID %>" type="number" value="<%= cartItem.amount %>" name="quantity" id="quantity" class="input-reset" pattern="\\d*">\n\t\t\t\t\t\t\t\t\t<span data-text-mesaure><%= cartItem.amount %></span>\n\t\t\t\t\t\t\t\t\t\x3c!-- × --\x3e\n\t\t\t\t\t\t\t\t\t<div class="arrow-select clickable faux_qty_open" style="cursor: pointer; width: 3rem;">\n\t\t\t\t\t\t\t\t\t\t<div class="arrow-down-arrow-up" style="margin-right: 10px;"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<select data-change="<%= cartItem.productID + \',\' + cartItem.skuID %>" name="faux_qty_select" id="faux_qty_select" class="psa t0 r0 b0" style="opacity: 0; width: 3rem; height: 100%; min-height: 4.2rem; cursor: pointer;">\n\n\t\t\t\t\t\t\t\t\t\t<% for (var i=1;i<=10; i++) { %>\n\t\t\t\t\t\t\t\t\t\t\t<option value="<%= i %>" <% if (cartItem.amount == i) { %>selected="selected"<% } %>><%= i %></option>\n\t\t\t\t\t\t\t\t\t\t<% }%>\n\n\t\t\t\t\t\t\t\t\t\t\x3c!-- <option value="10+" <% if (cartItem.amount > 10) { %>selected="selected"<% } %>>10+</option> --\x3e\n\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<% \n\t\t\t\t\t\t\t\t\t}\t\n\t\t\t\t\t\t\t\t%>\n\t\t\t\t\t\t\t</div>\n\t\t\n\t\t\t\t\t\t\t<% \n\t\t\t\t\t\t\t\tvar values = _.values(cartItem.sku.attributes);\n\t\t\t\t\t\t\t\t\tvalues = _.without(values, \'No description\');\n\n\t\t\t\t\t\t\t\tif(values.length > 0){ \n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t%>\n\t\t\t\t\t\t\t<div class="col col-full bg-grey-medium-dark pad-small mb1">\n\t\t\t\t\t\t\t\t<%= _.values(values).join(\', \') %>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<% } %>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="col col-full row group-horizontal">\n\n\t\t\t\t\t\t\t\t<div class="col bg-grey-dark pad-small" data-price>\n\t\t\t\t\t\t\t\t\t<%= formatPriceForCurrency(\n\t\t\t\t\t\t\t\t\t\tcartItem.sku.price, \n\t\t\t\t\t\t\t\t\t\tcartItem.sku.currency,\n\t\t\t\t\t\t\t\t\t\tcartItem.amount\n\t\t\t\t\t\t\t\t\t) %>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="col bg-grey-dark color-grey-medium pad-small clickable ml1 noselect" data-remove data-change="<%= cartItem.productID + \',\' + cartItem.skuID %>">Remove</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t<%\t\n\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t%>\n\t\t</div>\n\t\t\n\t\t<div class="group-vertical">\n\t\t<div class="col col-full bg-grey-dark pad-block-small color-white multi-line">\n\t\t\tTotal:\n\t\t\t<%\n\t\t\t\tif(currencies.length === 1) {\n\t\t\t%>\n\t\t\t\t<%= formatPriceForCurrency(totalCartPrice, currencies[0]) %>\n\t\t\t<%\n\t\t\t\t} else { %>\n\t\t\t\tUnable to calculate total due to mixed currencies.\n\t\t\t<%\n\t\t\t\t}\n\t\t\t%>\n\t\t</div>\n\t\t</div>\n\n\t\t<%} else {%>\n\t\t\t<div class="pr3 pt0 pb4">\n\t\t\t\t<div class="col col-full color-grey-light">\n\t\t\t\t\tYour Cart is Empty\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t<%}%>\n\t\t\n\t\t<div class="stripe_button_wrapper col col-full psr">\n\t\t\t<a data-powerdbystripe href="http://stripe.com" target="_blank">\n\t\t\t\t<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t\t\t\t\t viewBox="0 0 119 26" style="enable-background:new 0 0 119 26;" xml:space="preserve">\n\t\t\t\t<style type="text/css">\n\t\t\t\t\t.st0{clip-path:url(#SVGID_2_);}\n\t\t\t\t\t.st1{clip-path:url(#SVGID_4_);}\n\t\t\t\t\t.st2{clip-path:url(#SVGID_6_);fill:#fff;}\n\t\t\t\t\t.st3{clip-path:url(#SVGID_8_);fill:#fff;}\n\t\t\t\t\t.st4{clip-path:url(#SVGID_10_);fill:#fff;}\n\t\t\t\t</style>\n\t\t\t\t<g>\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<rect id="SVGID_1_" width="119" height="26"/>\n\t\t\t\t\t</defs>\n\t\t\t\t\t<clipPath id="SVGID_2_">\n\t\t\t\t\t\t<use xlink:href="#SVGID_1_"  style="overflow:visible;"/>\n\t\t\t\t\t</clipPath>\n\t\t\t\t\t<g class="st0">\n\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t<rect id="SVGID_3_" width="119" height="26"/>\n\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t<clipPath id="SVGID_4_">\n\t\t\t\t\t\t\t<use xlink:href="#SVGID_3_"  style="overflow:visible;"/>\n\t\t\t\t\t\t</clipPath>\n\t\t\t\t\t\t<g class="st1">\n\t\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t\t<rect id="SVGID_5_" width="119" height="26"/>\n\t\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t\t<clipPath id="SVGID_6_">\n\t\t\t\t\t\t\t\t<use xlink:href="#SVGID_5_"  style="overflow:visible;"/>\n\t\t\t\t\t\t\t</clipPath>\n\t\t\t\t\t\t\t<path class="st2" d="M113,26H6c-3.3,0-6-2.7-6-6V6c0-3.3,2.7-6,6-6h107c3.3,0,6,2.7,6,6v14C119,23.3,116.3,26,113,26 M118,6\n\t\t\t\t\t\t\t\tc0-2.8-2.2-5-5-5H6C3.2,1,1,3.2,1,6v14c0,2.8,2.2,5,5,5h107c2.8,0,5-2.2,5-5V6z"/>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t\t<g class="st1">\n\t\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t\t<rect id="SVGID_7_" x="8.6" y="8.6" width="55.1" height="9.9"/>\n\t\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t\t<clipPath id="SVGID_8_">\n\t\t\t\t\t\t\t\t<use xlink:href="#SVGID_7_"  style="overflow:visible;"/>\n\t\t\t\t\t\t\t</clipPath>\n\t\t\t\t\t\t\t<path class="st3" d="M60.7,18.4h-1.3l1-2.5l-2-5.1h1.4l1.3,3.5l1.3-3.5h1.4L60.7,18.4z M55.7,16.3c-0.5,0-0.9-0.2-1.3-0.5v0.4H53\n\t\t\t\t\t\t\t\tV8.6h1.3v2.7c0.4-0.3,0.9-0.5,1.3-0.5c1.4,0,2.4,1.1,2.4,2.8C58.1,15.1,57.1,16.3,55.7,16.3 M55.4,11.9c-0.4,0-0.7,0.2-1.1,0.5\n\t\t\t\t\t\t\t\tv2.3c0.3,0.3,0.7,0.5,1.1,0.5c0.8,0,1.3-0.7,1.3-1.6S56.2,11.9,55.4,11.9 M47.6,15.8c-0.4,0.3-0.9,0.5-1.3,0.5\n\t\t\t\t\t\t\t\tc-1.4,0-2.4-1.1-2.4-2.8c0-1.6,1-2.8,2.4-2.8c0.5,0,0.9,0.2,1.3,0.5V8.6h1.4v7.6h-1.4V15.8z M47.6,12.4c-0.3-0.3-0.7-0.5-1-0.5\n\t\t\t\t\t\t\t\tc-0.8,0-1.3,0.7-1.3,1.6s0.5,1.6,1.3,1.6c0.4,0,0.7-0.2,1-0.5V12.4z M39.5,13.9c0.1,0.8,0.7,1.3,1.6,1.3c0.5,0,1-0.2,1.6-0.5v1.1\n\t\t\t\t\t\t\t\tc-0.6,0.3-1.2,0.4-1.8,0.4c-1.6,0-2.7-1.2-2.7-2.8c0-1.6,1.1-2.7,2.6-2.7c1.4,0,2.3,1.1,2.3,2.6c0,0.1,0,0.3,0,0.5H39.5z\n\t\t\t\t\t\t\t\t M40.8,11.8c-0.7,0-1.2,0.5-1.2,1.2h2.3C41.8,12.3,41.4,11.8,40.8,11.8 M36,12.6v3.5h-1.3v-5.3H36v0.5c0.4-0.4,0.8-0.7,1.3-0.7\n\t\t\t\t\t\t\t\tc0.1,0,0.3,0,0.4,0.1V12c-0.1,0-0.3-0.1-0.5-0.1C36.8,11.9,36.3,12.2,36,12.6 M30,13.9c0.1,0.8,0.7,1.3,1.6,1.3\n\t\t\t\t\t\t\t\tc0.5,0,1-0.2,1.6-0.5v1.1c-0.6,0.3-1.2,0.4-1.8,0.4c-1.6,0-2.7-1.2-2.7-2.8c0-1.6,1.1-2.7,2.6-2.7c1.4,0,2.3,1.1,2.3,2.6\n\t\t\t\t\t\t\t\tc0,0.1,0,0.3,0,0.5H30z M31.2,11.8c-0.7,0-1.2,0.5-1.2,1.2h2.3C32.2,12.3,31.8,11.8,31.2,11.8 M25.3,16.1l-1.1-3.6l-1.1,3.6h-1.2\n\t\t\t\t\t\t\t\tl-1.8-5.3h1.3l1.1,3.6l1.1-3.6h1.2l1.1,3.6l1.1-3.6h1.3l-1.8,5.3H25.3z M17,16.3c-1.6,0-2.7-1.1-2.7-2.8c0-1.6,1.1-2.8,2.7-2.8\n\t\t\t\t\t\t\t\ts2.7,1.1,2.7,2.8C19.7,15.1,18.6,16.3,17,16.3 M17,11.9c-0.8,0-1.3,0.7-1.3,1.6s0.5,1.6,1.3,1.6c0.8,0,1.3-0.7,1.3-1.6\n\t\t\t\t\t\t\t\tS17.8,11.9,17,11.9 M11.1,13.5H9.9v2.6H8.6V8.9h2.6c1.5,0,2.5,1,2.5,2.3S12.6,13.5,11.1,13.5 M10.9,10h-1v2.5h1\n\t\t\t\t\t\t\t\tc0.8,0,1.3-0.5,1.3-1.2C12.3,10.5,11.7,10,10.9,10"/>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t\t<g class="st1">\n\t\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t\t<rect id="SVGID_9_" x="69.3" y="4.2" width="41.9" height="17"/>\n\t\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t\t<clipPath id="SVGID_10_">\n\t\t\t\t\t\t\t\t<use xlink:href="#SVGID_9_"  style="overflow:visible;"/>\n\t\t\t\t\t\t\t</clipPath>\n\t\t\t\t\t\t\t<path class="st4" d="M111.1,14.1h-5.6c0.1,1.3,1.1,1.7,2.2,1.7c1.1,0,2-0.2,2.8-0.6v2.3c-0.8,0.4-1.8,0.7-3.1,0.7\n\t\t\t\t\t\t\t\tc-2.8,0-4.7-1.7-4.7-5.2c0-2.9,1.6-5.2,4.3-5.2c2.7,0,4.1,2.3,4.1,5.2C111.2,13.3,111.1,13.9,111.1,14.1 M107,10.1\n\t\t\t\t\t\t\t\tc-0.7,0-1.5,0.5-1.5,1.8h2.9C108.5,10.7,107.7,10.1,107,10.1 M98.1,18.2c-1,0-1.6-0.4-2-0.7l0,3.2l-2.8,0.6l0-13.3h2.5l0.1,0.7\n\t\t\t\t\t\t\t\tc0.4-0.4,1.1-0.9,2.2-0.9c2,0,3.9,1.8,3.9,5.1C102,16.5,100.1,18.2,98.1,18.2 M97.4,10.3c-0.7,0-1.1,0.2-1.4,0.6l0,4.2\n\t\t\t\t\t\t\t\tc0.3,0.3,0.7,0.5,1.3,0.5c1,0,1.8-1.1,1.8-2.7C99.2,11.5,98.5,10.3,97.4,10.3 M89.1,8H92v10h-2.9V8z M89.1,4.8L92,4.2v2.3\n\t\t\t\t\t\t\t\tl-2.9,0.6V4.8z M86.1,11.2V18h-2.8V8h2.5l0.2,0.8c0.7-1.2,2-1,2.4-0.8v2.6C87.9,10.5,86.8,10.3,86.1,11.2 M80,14.5\n\t\t\t\t\t\t\t\tc0,1.7,1.8,1.2,2.2,1v2.3c-0.4,0.2-1.1,0.4-2,0.4c-1.7,0-2.9-1.2-2.9-2.9l0-9.1L80,5.5L80,8h2.2v2.4H80V14.5z M76.5,15\n\t\t\t\t\t\t\t\tc0,2-1.6,3.2-4,3.2c-1,0-2-0.2-3.1-0.6v-2.7c1,0.5,2.2,0.9,3.1,0.9c0.6,0,1.1-0.2,1.1-0.7c0-1.4-4.3-0.8-4.3-4\n\t\t\t\t\t\t\t\tc0-2,1.5-3.2,3.8-3.2c0.9,0,1.9,0.1,2.8,0.5V11c-0.9-0.5-2-0.7-2.8-0.7c-0.6,0-1,0.2-1,0.6C72.1,12.2,76.5,11.6,76.5,15"/>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</g>\n\t\t\t\t</g>\n\t\t\t\t</svg>\n\n\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</div>\n\n\n\n\n\n<div class="x c12 psa b0 bg-black <% if(isIOSWebView) { %>disabled<% } %>" data-following-footer>\n\t<% if(hasLiveProductsInCart) { %>\n\t<div class="c8 bg-blue color-black clickable noselect x type-bold" data-checkout style=" border-left: 1px solid #1a1a1a; background: #9a9a9a;">\n\t\t<div class="py2 px3 c6" style="font-size: 17px;">\n\t\t\t<% if(collectShippingInformation) { %>\n\t\t\t\tNext\n\t\t\t<% } else { %>\n\t\t\t\tCheckout\n\t\t\t<% } %>\n\t\t</div>\n\t\t<div class="processing c2 py2 px2 color-white type-right type-bold pos-relative">\n\t\t\t<%= loading_animation(\'loading_animation pulsing white inline right hidden\') %>\n\t\t</div>\n\t</div>\n\n\t<%\t\n\t\t}\n\n\t\tif(collectShippingInformation) { \n\t%>\n\n\t<div class="xa bg-grey-medium-dark color-black py2 px3 clickable noselect" data-cancel-shipping style="margin-left: 1px; background: #666; font-size: 17px;">\n\t\tBack\n\t</div>\n\n\t<% } else if(hasLiveProductsInCart) { %>\n\n\t<div class="xa bg-grey-medium-dark color-black py2 px3 clickable noselect" data-close style="margin-left: 1px; background: #666; font-size: 17px;">\n\t\tClose\n\t</div>\n\n\t<% } %>\n</div>'}),define("_views/Cart",["text!_templates/cart.html"],function(t){function e(t,e,n){var i;if(void 0!==n&&(t*=n),"string"!=typeof e)i=t/100+"";else{var o={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"֏",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"₼",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:".د.ب",BIF:"FBu",BMD:"$",BND:"$",BOB:"$b",BRL:"R$",BSD:"$",BTC:"฿",BTN:"Nu.",BWP:"P",BYR:"p.",BZD:"BZ$",CAD:"$",CDF:"FC",CHF:"CHF",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUC:"$",CUP:"₱",CVE:"$",CZK:"Kč",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"دج",EEK:"kr",EGP:"£",ERN:"Nfk",ETB:"Br",ETH:"Ξ",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"₾",GGP:"£",GHC:"₵",GHS:"GH₵",GIP:"£",GMD:"D",GNF:"FG",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",IMP:"£",INR:"₹",IQD:"ع.د",IRR:"﷼",ISK:"kr",JEP:"£",JMD:"J$",JOD:"JD",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"CF",KPW:"₩",KRW:"₩",KWD:"KD",KYD:"$",KZT:"лв",LAK:"₭",LBP:"£",LKR:"₨",LRD:"$",LSL:"M",LTC:"Ł",LTL:"Lt",LVL:"Ls",LYD:"LD",MAD:"MAD",MDL:"lei",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"MOP$",MRO:"UM",MUR:"₨",MVR:"Rf",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"﷼",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"Gs",QAR:"﷼",RMB:"￥",RON:"lei",RSD:"Дин.",RUB:"₽",RWF:"R₣",SAR:"﷼",SBD:"$",SCR:"₨",SDG:"ج.س.",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"S",SRD:"$",SSP:"£",STD:"Db",SVC:"$",SYP:"£",SZL:"E",THB:"฿",TJS:"SM",TMT:"T",TND:"د.ت",TOP:"T$",TRL:"₤",TRY:"₺",TTD:"TT$",TVD:"$",TWD:"NT$",TZS:"TSh",UAH:"₴",UGX:"USh",USD:"$",UYU:"$U",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"VT",WST:"WS$",XAF:"FCFA",XBT:"Ƀ",XCD:"$",XOF:"CFA",XPF:"₣",YER:"﷼",ZAR:"R",ZWD:"Z$"};e=e.toUpperCase(),-1===["BIF","CLP","DJF","GNF","JPY","KMF","KRW","MGA","PYG","RWF","VND","VUV","XAF","XOF","XPF"].indexOf(e)&&(t/=100),i="undefined"!=typeof Intl?new Intl.NumberFormat(parent.Cargo.__ecommerce_locale__||"en-US",{style:"currency",currency:e,currencyDisplay:"symbol",useGrouping:!0,minimumFractionDigits:0}).format(t):(o.hasOwnProperty(e)?o[e]:e+" ")+""+t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}if("string"==typeof i&&-1!==i.indexOf(".")){var a=i.split(".");2===a.length&&1===a[1].length&&(a[1]=a[1]+"0",i=a.join("."))}return i}return Backbone.View.extend({template:_.template(t),preventReRender:!1,events:{"click #close_panel":"closeFollowing","click [data-close]":"close","click [data-cancel-shipping]":"cancelShipping","click [data-checkout]":"checkout","click [data-remove]":"deleteFromCart","click [data-add]":"addMoreToCart",'change [name="faux_qty_select"]':"changeFauxQuantitySelect",'focusin [name="quantity"]':"focusQuantityInput",'focusout [name="quantity"]':"focusQuantityInput",'keyup [name="quantity"]':"handleQuantityInputKeyup",'keydown [name="quantity"]':"handleQuantityInputKeydown","keydown #shipping_address input":"handleShippingInputKeydown",mousedown:"handleClick"},handleClick:function(t){$(t.target).is("#faux_qty_select")&&(this.preventReRender=!0,setTimeout(_.bind(function(){this.preventReRender=!1},this),1e3))},initialize:function(){this.currentRenderOptions={},this.totalCartPrice=0,this.totalCartItems=0,this.currenciesInCart=[],this.requiresShippingAddress=!1,this.hasLiveProductsInCart=!1,this.enabled_countries=_.keys(parent.Cargo.Core.Ecommerce.countryMap);var t=parent.Cargo.Model.DisplayOptions.get("ecommerce_options");t&&t.enabled_countries&&t.enabled_countries.length&&(this.enabled_countries=t.enabled_countries),this.checkoutFrame=$('<iframe src="" data-checkout-frame></iframe>')[0];var e="/_jsapps/ecommerce/checkout.html?"+parent.__cargo_js_ver__;parent.__cargo_context__,this.checkoutFrame.src=e,window.addEventListener("message",_.bind(function(t){try{var e=JSON.parse(t.data)}catch(t){return void console.info("message error",t)}"show-frame"===e.type?this.checkoutFrame.style.display="block":"hide-frame"===e.type?(this.checkoutFrame.style.display="",this.render({show_shipping_screen:e.data.load_address})):"payment-success"===e.type&&(this.clearCart(),Following.Events.on("frame-animation-starting",function(){this.checkoutFrame.style.display="",this.render({show_shipping_screen:!1})},this))},this)),this.cart=this.getCartFromStorage(),Following.Events.on("slidepanel:open_complete",function(t){"cart"==Backbone.history.fragment&&(this.$el.removeClass("hidden").show(),this.render())},this),Following.Events.on("slidepanel:close_complete",function(t){},this),Following.Events.on("add-sku-to-cart",function(t){this.addToCart(t.product,t.sku,1)},this),parent.Cargo.Collection.StripeProducts.on("sync",this.render,this)},close:function(){parent.Cargo.View.Following.Toggle()},cancelShipping:function(){this.render({show_shipping_screen:!1})},deleteFromCart:function(t,e){var n=t.currentTarget.getAttribute("data-change").split(",");if(n[0]&&n[1]){var i=_.findWhere(this.cart,{productID:n[0],skuID:n[1]});i&&(e?i.amount-=1:i.amount=0,i.amount<=0&&this.cart.splice(this.cart.indexOf(i),1),this.saveCart(),this.render())}},addMoreToCart:function(t){var e=t.currentTarget.getAttribute("data-change").split(",");e[0]&&e[1]&&this.addToCart(e[0],e[1],1)},updateCart:function(t){var e=$(t.currentTarget).val(),n=t.currentTarget.getAttribute("data-change").split(",");if(n[0]&&n[1]){var i=_.findWhere(this.cart,{productID:n[0],skuID:n[1]});i&&(i.amount=e,this.saveCart(),this.preventReRender||this.render())}},changeFauxQuantitySelect:function(t){var e=$(t.currentTarget).val();this.preventReRender=!1;var n=this.getItemQuantity(t);null!==n&&n<parseInt(e)&&(t.preventDefault(),parent.Cargo.Modal.Alert({selector:"html",message:"You’ve reached the maximum available stock"}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""}),$(t.target).val(this.getItemQuantity(t)),this.setQuantityInputWidth($(t.target))),setTimeout(_.bind(function(){this.updateCart(t)},this),10)},handleShippingInputKeydown:function(t){13==t.keyCode&&this.checkout()},handleQuantityInputKeyup:function(t){13==t.keyCode?$(t.target).blur():(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||9==t.keyCode||8==t.keyCode)&&this.setQuantityInputWidth($(t.currentTarget)),t.currentTarget.value>9999&&(t.preventDefault(),$(t.target).val(9999),this.setQuantityInputWidth($(t.target)));var e=this.getItemQuantity(t);null!==e&&e<parseInt(t.currentTarget.value)&&(t.preventDefault(),parent.Cargo.Modal.Alert({selector:"html",message:"You’ve reached the maximum available stock"}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""}),$(t.target).val(this.getItemQuantity(t)),this.setQuantityInputWidth($(t.target)))},getPriceChange:function(t){var n=t.currentTarget.getAttribute("data-change").split(",");if(n[0]&&n[1]){var i=_.findWhere(this.cart,{productID:n[0],skuID:n[1]});return e(i.sku.price,i.sku.currency,$(t.currentTarget).val())}return!1},getItemQuantity:function(t){var e=t.currentTarget.getAttribute("data-change").split(",");if(e[0]&&e[1]){var n,i=parent.Cargo.Collection.StripeProducts.findWhere({id:e[0]});if(i&&(n=i.getSku(e[1])))return i.getAvailableItemsForSKU(n)}return!1},handleQuantityInputKeydown:function(t){t.keyCode>=37&&t.keyCode<=40?setTimeout(_.bind(function(){this.setQuantityInputWidth($(t.currentTarget))},this),1):t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||9==t.keyCode||8==t.keyCode||t.metaKey||8==t.keyCode||t.preventDefault()},setQuantityInputWidth:function(t){if(0!=t.next("[data-text-mesaure]").length){var e=t.val();t.next("[data-text-mesaure]").html(e);var n=t.next("[data-text-mesaure]")[0].getBoundingClientRect().width;t.css("max-width",n+1+"px")}},focusQuantityInput:function(t){"focusin"==t.type?(this.start_qty_val=$(t.target).val(),this.clean_qty_val=this.start_qty_val.replace("×",""),$(t.target).val(this.clean_qty_val),setTimeout(function(){$(t.target).select()},20)):"focusout"==t.type&&this.start_qty_val!==$(t.target).val()&&setTimeout(_.bind(function(){this.updateCart(t)},this),1)},checkout:function(t){if(parent.Cargo.API.Config.is_template)return parent.Cargo.Modal.Alert({selector:"html",message:"<em>This is a demo of <br>&nbsp;&nbsp;<a style='color: #222222; padding-bottom: 0.1em; border-bottom: 1px solid rgba(0,0,0,.5); text-decoration: none;' href='http://support.cargo.site/E-commerce' target='_blank'>Cargo E-commerce</a><span style='font-family: -apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen,Ubuntu,Cantarell,\"Open Sans\",\"Helvetica Neue\",sans-serif, Icons; color: rgba(0, 0, 0, 0.4); border-bottom: 0;'><sup>︎</sup></span></em>"}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),void parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""});if(this.getCartWithProductData(),this.cart&&0!==this.cart.length)if(this.currenciesInCart.length>1)alert("Unable to mix different curriencies in one order. Please remove items until the cart only contains one currency.");else if(!0!==this.currentRenderOptions.show_shipping_screen&&this.requiresShippingAddress)this.render({show_shipping_screen:!0});else{var e=this.$el.find("#shipping_address")[0],n=!1,i={address:{}};if(e&&_.each(e.elements,function(t){if(!t.hasAttribute("disabled")){t.classList.remove("error");var e=t.getAttribute("name"),i="";"SELECT"===t.nodeName?t.selectedOptions[0]&&(i=t.selectedOptions[0].value):i=t.value,"country"===e&&-1===this.enabled_countries.indexOf(i)&&(!1!==t.hasAttribute("value")&&(parent.Cargo.Modal.Alert({selector:"html",message:"This store does not ship to your country."}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""})),t.classList.add("error"),n=!0),t.hasAttribute("data-required")&&""===i&&("country"===e&&-1===this.enabled_countries.indexOf(i)&&(t.classList.add("error"),n=!0),t.classList.add("error"),n=!0)}},this),!n){var o=this.$el.find("#shipping_address").serializeArray();i={address:{}};_.keys(o).length>0&&_.each(o,function(t){""!==t.value&&("name"===t.name?i[t.name]=t.value:i.address[t.name]=t.value)});var a=[];_.each(_.where(this.cart,{available:!0}),function(t){t.sku&&a.push({type:"sku",parent:t.sku.id,quantity:t.amount})}),a.length>0&&(this.checkoutInitPerformed||(this.checkoutFrame.contentWindow.postMessage(JSON.stringify({type:"init-checkout",options:{public_stripe_key:parent.Cargo.Model.Site.get("ecommerce_key_public"),locale:parent.Cargo.__ecommerce_locale__,site_id:Following.Model.Default.get("id"),currency:this.currenciesInCart[0]}}),"*"),this.checkoutInitPerformed=!0),this.$el.find(".loading_animation").removeClass("hidden"),$.post("/_api/v0/ecommerce/order/"+Following.Model.Default.get("id"),{items:a,shipping:i,currency:this.currenciesInCart[0]}).done(_.bind(function(t){if(t.id)this.checkoutFrame.contentWindow.postMessage(JSON.stringify({type:"open-checkout",options:{order_id:t.id}}),"*");else{var e="Unable to process cart. Please refresh the page and try again.";this.currentRenderOptions.show_shipping_screen&&(e="Unable to process cart. Please make sure the address is correct."),parent.Cargo.Modal.Alert({selector:"html",message:e}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""})}},this)).fail(function(t){var e,n="Unable to create order.";if(t.responseText)try{var i=JSON.parse(t.responseText);i.message&&"string"==typeof i.message&&(e=JSON.parse(i.message))}catch(t){}e&&e.message&&(n=e.message),parent.Cargo.Modal.Alert({selector:"html",message:n}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""})}).always(_.bind(function(){this.$el.find(".loading_animation").addClass("hidden")},this)))}}else alert("Nothing in cart.")},getCartWithProductData:function(){var t=this.totalCartItems;this.totalCartPrice=0,this.totalCartItems=0,this.currenciesInCart=[],this.requiresShippingAddress=!1,this.hasLiveProductsInCart=!1,_.each(this.cart,function(t){t.available=!1;var e,n=parent.Cargo.Collection.StripeProducts.findWhere({id:t.productID});if(n&&(e=n.getSku(t.skuID))){if(t.amount=Math.min(t.amount,n.getAvailableItemsForSKU(e)),0===t.amount)return;t.available=!0,this.hasLiveProductsInCart=!0,-1==this.currenciesInCart.indexOf(e.currency)&&this.currenciesInCart.push(e.currency),this.totalCartPrice+=t.amount*e.price,this.totalCartItems+=t.amount,t.sku=e,t.product=n.toJSON(),t.product.shippable&&(this.requiresShippingAddress=!0)}},this),t!==this.totalCartItems&&parent.Cargo.Event.trigger("cart-size-changed",this.totalCartItems)},addToCart:function(t,e,n){if("string"==typeof e){if(isNaN(n)||0===n)return console.info("not adding to cart, no amount specified"),!1;var i,o,a=parent.Cargo.Collection.StripeProducts.findWhere({id:t});if(!a)return parent.Cargo.Modal.Alert({selector:"html",message:"Product is unavailable"}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""}),!1;if(o=a.getSku(e),(i=a.getAvailableItemsForSKU(o))<=0)return parent.Cargo.Modal.Alert({selector:"html",message:"Product is out of stock"}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""}),!1;var l=_.findWhere(this.cart,{skuID:e,productID:t});if(l){if(l.amount>=i)return parent.Cargo.Modal.Alert({selector:"html",message:"Product is out of stock"}),parent.Cargo.Modal.$el.find(".confirm-box").css({top:""}),parent.Cargo.Modal.$el.find(".modal-overlay").css({top:""}),!1;if(a.get("is_file")&&1==l.amount)return this.checkoutFrame.style.display="",parent.Cargo.Event.trigger("add_history","cart"),!1;l.amount++}else this.cart.length>=25?setTimeout(function(){parent.Cargo.Modal.Alert({selector:"html",message:"You’ve reached the maximum number of 25 items per order."})},1):this.cart.push({productID:t,skuID:e,amount:n});return this.saveCart(),this.render(),setTimeout(_.bind(function(){_.each($('input[name="quantity"]'),_.bind(function(t){this.setQuantityInputWidth($(t))},this))},this),250),this.checkoutFrame.style.display="",parent.Cargo.Event.trigger("add_history","cart"),!0}},clearCart:function(){this.cart=[],this.saveCart(),this.render()},saveCart:function(){if(this.cart){var t=[];_.each(this.cart,function(e){e.productID&&e.skuID&&t.push({productID:e.productID,skuID:e.skuID,amount:e.amount})}),localStorage.setItem("cargo_ecommerce_cart",JSON.stringify(t))}},getCartFromStorage:function(){var t=[],e=localStorage.getItem("cargo_ecommerce_cart");if(null!==e&&e.length>0)try{t=JSON.parse(e)}catch(t){console.error(t)}return t},render:function(t){this.checkoutFrameInitialized||(document.body.appendChild(this.checkoutFrame),this.checkoutFrameInitialized=!0),this.currentRenderOptions=t=t||{},this.getCartWithProductData(),this.$el.addClass("mobile"),this.$el.find("form#shipping_address").length>0&&(this.shippingForm=this.$el.find("form#shipping_address").detach());var n=!parent.Cargo.Collection.StripeProducts.productSyncOccurred;n||$("#following_loading").hide(),this.$el.html(this.template({cart:this.cart,hasLiveProductsInCart:this.hasLiveProductsInCart,currencies:this.currenciesInCart,totalCartItems:this.totalCartItems,totalCartPrice:this.totalCartPrice,collectShippingInformation:!0===t.show_shipping_screen,formatPriceForCurrency:e,no_data:n,isIOSWebView:this.isIOSWebView,IOSWebViewName:this.IOSWebViewName,site_url:window.location.host}));var i=this.$el.find("form#shipping_address");if(this.shippingForm&&this.shippingForm.length>0&&i.length>0)this.shippingForm.insertBefore(i),this.shippingForm=void 0,i.remove();else{this.setupCountrySelect();var o=$('select[name="country"]'),a=this;o.on("change",function(){"US"===this.value?(a.$el.find("[data-non-us-states]").attr("disabled",!0).hide(),a.$el.find("[data-us-states]").removeAttr("disabled").parent().show()):(a.$el.find("[data-us-states]").attr("disabled",!0).parent().hide(),a.$el.find("[data-non-us-states]").removeAttr("disabled").show())}).trigger("change"),this.$el.find('select[name="state"]').on("change",function(){this.style.color=""})}return _.each($('input[name="quantity"]'),_.bind(function(t){this.setQuantityInputWidth($(t))},this)),this.$el.find("[data-checkout]")[this.hasLiveProductsInCart?"removeClass":"addClass"]("disabled"),this},setupCountrySelect:function(){var t=$('select[name="country"]');if(t.length>0){var e=!1;t.html("");var n=document.createElement("option");n.setAttribute("disabled","true"),n.innerText="Country",t.append(n),_.each(parent.Cargo.Core.Ecommerce.countryMap,function(i,o){(n=document.createElement("option")).value=o,n.innerText=i,-1!==this.enabled_countries.indexOf(o)&&("US"===o&&(n.selected=!0,e=!0),t.append(n))},this),!1===e&&(t[0].options[0].selected=!0)}}})}),define("global_libs/require/normalize",[],function(){var t=/([^:])\/+/g,e=function(e){return e.replace(t,"$1/")},n=/[^\:\/]*:\/\/([^\/])*/,o=/^(\/|data:)/;function a(t,i,a){if(t.match(o)||t.match(n))return t;t=e(t);var r=a.match(n),c=i.match(n);return!c||r&&r[1]==c[1]&&r[2]==c[2]?s(l(t,i),a):l(t,i)}function l(t,e){if("./"==t.substr(0,2)&&(t=t.substr(2)),t.match(o)||t.match(n))return t;var i=e.split("/"),a=t.split("/");for(i.pop();curPart=a.shift();)".."==curPart?i.pop():i.push(curPart);return i.join("/")}function s(t,e){var n=e.split("/");for(n.pop(),e=n.join("/")+"/",i=0;e.substr(i,1)==t.substr(i,1);)i++;for(;"/"!=e.substr(i,1);)i--;e=e.substr(i+1),t=t.substr(i+1),n=e.split("/");var o=t.split("/");for(out="";n.shift();)out+="../";for(;curPart=o.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var r=function(t,n,i){n=e(n),i=e(i);for(var o,l,s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;o=s.exec(t);){var r;r=a(l=o[3]||o[2]||o[5]||o[6]||o[4],n,i);var c=o[5]||o[6]?1:0;t=t.substr(0,s.lastIndex-l.length-c-1)+r+t.substr(s.lastIndex-c-1),s.lastIndex=s.lastIndex+(r.length-l.length)}return t};return r.convertURIBase=a,r.absoluteURI=l,r.relativeURI=s,r}),define("css",[],function(){if("undefined"==typeof window)return{load:function(t,e,n){n()}};var t=document.getElementsByTagName("head")[0],e=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,n=!1,i=!0;e[1]||e[7]?n=parseInt(e[1])<6||parseInt(e[7])<=9:e[2]||e[8]?i=!1:e[4]&&(n=parseInt(e[4])<18);var o,a,l,s={pluginBuilder:"global_libs/require/css-builder"},r=function(){o=document.createElement("style"),t.appendChild(o),a=o.styleSheet||o.sheet},c=0,d=[],p=function(t){32==++c&&(r(),c=0),a.addImport(t),o.onload=function(){u()}},u=function(){l();var t=d.shift();return t?(l=t[1],void p(t[0])):void(l=null)},g=function(e,n){var o=document.createElement("link");if(o.type="text/css",o.rel="stylesheet",i)o.onload=function(){o.onload=function(){},setTimeout(n,7)};else var a=setInterval(function(){for(var t=0;t<document.styleSheets.length;t++){if(document.styleSheets[t].href==o.href)return clearInterval(a),n()}},10);o.href=e,t.appendChild(o)};return s.normalize=function(t,e){return".css"==t.substr(t.length-4,4)&&(t=t.substr(0,t.length-4)),e(t)},s.load=function(t,e,i){(n?function(t,e){if(a&&a.addImport||r(),a&&a.addImport)l?d.push([t,e]):(p(t),l=e);else{o.textContent='@import "'+t+'";';var n=setInterval(function(){try{o.sheet.cssRules,clearInterval(n),e()}catch(t){}},10)}}:g)(e.toUrl(t+".css"),i)},s}),define("migration/router",[],function(){return Backbone.Router.extend({initialize:function(){},routes:{"import/progress(/)":"progress","import/content(/)":"payload-chooser","import/login(/)":"c1-login"},routes_in_order:["choose-url","c1-login","payload-chooser","progress"]})}),define("text!migration/_templates/main.html",[],function(){return'<link href="/_jsapps/migration/_css/import.css" rel="stylesheet" type="text/css" />\n\n<div class="pad-medium pad-top-medium">\n\n\t<div  data-view="content">\n\t</div>\n\t<div data-view="footer">\n\t</div>\t\n</div>'}),define("text!migration/_templates/following-result.html",[],function(){return'<div class="group-vertical">\n\n\t<% if(status == "pending") { %>\n\t\t\n\t\t<div class="tal pad-medium">\n\t\t\t\n\t\t\t<div class="row">\n\t\t\t\t<div class="loading_animation pulsing no-delay white middle position-absolute ">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<svg class="loading" width="500" height="500" viewBox="0 0 500 500"><path d="M137.78 362.22c-61.975 0-112.214-50.24-112.214-112.217 0-123.954 100.478-224.432 224.43-224.432 123.955 0 224.433 100.48 224.433 224.436 0-61.977-50.24-112.216-112.22-112.216s-112.216 50.24-112.216 112.215c0 61.976-50.24 112.216-112.216 112.216M249.998 500c138.074 0 249.997-111.93 249.997-249.997 0-138.075-111.924-249.998-250-249.998C111.93.005 0 111.928 0 250.003 0 388.07 111.93 500 249.997 500" fill-rule="evenodd"></path></svg>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t</div>\n\t\t\n\t<% } else if (status == "success"){ %>\n\n\t\t<div class="tal pad-medium">\n\t\t\t\n\t\t\t<div class="row">\n\t\t\t\tSuccesss\n\t\t\t</div>\n\t\t\t<div class="row">\n\n\t\t\t\t<div class="col col-full row clickable bg-green no-select align-middle" data-confirm-success>\n\t\t\t\t\t<div class="pad-small color-white type-size-normalish type-bold col">\n\t\t\t\t\t\tBack\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t<% } %>\n\n</div>\n'}),define("text!migration/_templates/breadcrumbs.html",[],function(){return'<div class="pad-top-medium x row type-size-normal">\n\n\t<% if (show_c1_logout){ %>\n\t\t\x3c!-- <div class="tal col" class="hidden">\n\t\t\t<a class="clickable color-dark" data-c1-logout>Use a different account</a>\n\t\t</div> --\x3e\n\t\t\x3c!-- <div class="col">\n\t\t\t<a href="/admin/settings" data-cancel class="color-dark">Cancel</a>\n\t\t</div> --\x3e\n\t<% } %>\n\n\t<% if ( !end ){  %>\n\n\t\t<% if ( !beginning ){ %>\n\t\t\x3c!-- <div class="tal col">\n\t\t\t<a href="/" data-back class="color-dark">Back</a>\n\t\t</div> --\x3e\n\t\t<% } %>\n\n\t\t\x3c!-- <div class="col">\n\t\t\t<a href="/admin/settings" data-cancel class="color-dark">Cancel</a>\n\t\t</div>\t --\x3e\n\n\t<% } %>\n\n\n</div>'}),define("migration/_views/breadcrumbs",["text!migration/_templates/breadcrumbs.html"],function(t){return Backbone.View.extend({template:_.template(t),initialize:function(t){this.parentView=t.parentView,this.route=t.route},events:{"click [data-c1-logout]":"c1Logout","click [data-back]":"goBack","click [data-cancel]":"cancelImport"},goBack:function(t){t.preventDefault(),history.back()},cancelImport:function(t){t.preventDefault(),Cargo.Router.navigate("/settings",{trigger:!0})},c1Logout:function(t){Cargo.migration.View.contentView.hasOwnProperty("c1LoginForm")&&Cargo.migration.View.contentView.c1LoginForm.logout(),t.preventDefault()},render:function(){if(Cargo.migration.View.contentView){var t,e=Cargo.migration.router.routes_in_order;Cargo.migration.View.contentView.hasOwnProperty("c1LoginForm")&&Cargo.migration.View.contentView.hasOwnProperty("c2LoginForm")?(t=Cargo.migration.View.contentView.c1LoginForm.isLoggedInAccount?Cargo.migration.c1Site:void 0,Cargo.migration.View.contentView.c2LoginForm.isLoggedInAccount?Cargo.migration.c2Site:void 0):(t=Cargo.migration.c1Site,Cargo.migration.c2Site);var n="/import",i=!1,o=!1,a=this.route;_.each(e,function(t,l){t==a&&(0==l?o=!0:n=l>1?e[l-1]:"/import",l==e.length-1&&(i=!0))});var l=Cargo.migration.View.isinCargo2Admin&&t&&"login-controller"==a;this.el.innerHTML=this.template({show_c1_logout:l,prev_route:n,end:i,beginning:o})}}})});var Cargo=Cargo||{};Cargo.migration={},Cargo.migration.c1Site=void 0,Cargo.migration.c2Site=void 0,define("migration/main",["migration/router","text!migration/_templates/main.html","text!migration/_templates/following-result.html"],function(t,e,n){var i=Backbone.View.extend({template:_.template(e),followingStatusTemplate:_.template(n),id:"migration_wrapper",events:{"click [data-ajax]":"navigate"},initialize:function(){this.isC1AdminImport(),this.render(),null==this.el.parentNode&&document.body.appendChild(this.el),this.getCurrentLoginState(),this.startRouter()},isC1AdminImport:function(){"undefined"!=typeof c1_url&&"undefined"!=typeof c2_url&&"undefined"!=typeof title?(Cargo.migration.is_C1Admin_import=!0,Cargo.migration.C1Admin_import_data={c1_url:c1_url,c2_url:c2_url,title:title}):Cargo.migration.is_C1Admin_import=!1},navigate:function(t){return Cargo.migration.router.navigate($(t.currentTarget).attr("href"),{trigger:!0}),!1},startRouter:function(){this.direct_link=!0,Cargo.migration.router||(Cargo.migration.router=new t),Cargo.migration.router.on("route",function(t){this.renderRoute(t)},this),Backbone.History.started?Backbone.history.loadUrl():Backbone.history.start({pushState:!0,root:"/migration/"}),this.direct_link=!1,Cargo.migration.is_C1Admin_import&&this.renderC1ImportFlow()},renderC1ImportFlow:function(){this.renderRoute("c1-admin-flow")},renderRoute:function(t,e){""!=t&&this.direct_link?Cargo.migration.router.navigate("import",{trigger:!0}):require(["migration/_views/"+t,"migration/_views/breadcrumbs"],_.bind(function(n,i){n&&(n.el||n.prototype instanceof Backbone.View)&&(n.el?this.renderContent(t,n):(null==e&&(e={parentView:this}),this.renderContent(t,new n(e)))),i&&(i.el||i.prototype instanceof Backbone.View)&&this.renderFooter(t,new i({parentView:this,route:t}))},this))},renderFooter:function(t,e){this.footerView&&this.footerView.remove(),this.footerView=e,$('[data-view="footer"]').html("").append(e.el),e.render()},renderContent:function(t,e){"c1-admin-flow"!==t?(this.contentView&&this.contentView.remove(),this.contentView=e,$('[data-view="content"]').html("").append(e.el)):(this.C1AdminImportView=e,$("body").addClass(t).append(e.el)),e.render()},render:function(){return this.el.innerHTML=this.template(),Cargo.migration.router&&(Cargo.API.Config.is_importing&&"import/progress"!==Backbone.history.getFragment()?Cargo.migration.c1Site?Cargo.migration.router.navigate("import/progress",{trigger:!0}):(Cargo.API.Config.is_importing=!1,Backbone.history.loadUrl(Backbone.history.getFragment())):"import"==Backbone.history.getFragment()?this.renderRoute("choose-url"):Cargo.migration.router.navigate(Backbone.history.getFragment(),{trigger:!0})),this},remove:function(){this.contentView&&(this.contentView.requestTimeout&&clearTimeout(this.contentView.requestTimeout),this.contentView.import_render&&clearTimeout(this.contentView.import_render)),Backbone.View.prototype.remove.apply(this,arguments)},getCurrentLoginState:function(t){var e="";void 0!==Cargo&&Cargo.Model&&Cargo.Model.Site?e="/"+Cargo.Model.Site.get("id"):"undefined"!=typeof Following&&Following.Model&&Following.Model.Default&&(e="/"+Following.Model.Default.get("id")),$.getJSON("/dispatch/migration/getCurrentUser"+e,_.bind(function(t){Cargo.migration.c2Site=t.jdata},this))}});return Cargo.migration.View=new i,Cargo.migration.View}),define("_views/Import",["css!/_jsapps/admin/_css/foundation.css"],function(){return Backbone.View.extend({events:{"click [data-cancel]":"closeSlidePanel"},initialize:function(){Following.Events.on("slidepanel:show_import",function(){this.initMigration()},this),Following.Events.on("slidepanel:open_complete",function(t){"import"==Backbone.history.fragment&&this.$el.removeClass("hidden").show()},this),Following.Events.on("slidepanel:close_complete",function(t){},this)},closeSlidePanel:function(){var t="following";Following.View.Following.current_section&&(t=Following.View.Following.current_section),Following.View.Following.no_transition_closeplanel=!0,Following.Router.navigate(t,!0)},initMigration:function(){this.inited?this.migrationView&&this.migrationView.render():(this.inited=!0,Cargo.API={},Cargo.API.Config={},Cargo.API.Config.is_importing=!1,require(["migration/main"],_.bind(function(t){Cargo.migration.isFollowingImport=!0,this.migrationView=t,this.render(),this.migrationView.render()},this)))},render:function(){return this.el.innerHTML="",this.migrationView&&(this.el.appendChild(this.migrationView.el),this.$el.append('<div class="pad-x-medium clickable color-grey-medium type-size-normal" data-cancel>Cancel</div>')),this}})}),define("_collections/Following",["_models/Follow"],function(t){return Backbone.Collection.extend({url:function(){return Following.Model.Default.get("follow_api_path")+"following/c2/"+Following.Model.Default.get("id")},model:t,comparator:function(t,e){return-t.get("follow_date").localeCompare(e.get("follow_date"))},fetch:function(t){$("script[data-set='Following']").html()?(this.set($.parseJSON($("script[data-set='Following']").html()),t),$("script[data-set='Following']").remove()):Backbone.Collection.prototype.fetch.apply(this,arguments)},fetchNextPage:function(t){this.fetch({remove:!1,data:{offset:this.length},success:function(e,n,i){"function"==typeof t&&t(e,n,i)}})}})}),define("_collections/FollowedBy",["_models/Follow"],function(t){return Backbone.Collection.extend({url:function(){return Following.Model.Default.get("follow_api_path")+"followedby/c2/"+Following.Model.Default.get("id")},model:t,comparator:function(t,e){return-t.get("follow_date").localeCompare(e.get("follow_date"))},fetch:function(t){$("script[data-set='FollowedBy']").html()?(this.set($.parseJSON($("script[data-set='FollowedBy']").html()),t),$("script[data-set='FollowedBy']").remove()):Backbone.Collection.prototype.fetch.apply(this,arguments)},fetchNextPage:function(t){this.fetch({remove:!1,data:{offset:this.length},success:function(e,n,i){"function"==typeof t&&t(e,n,i)}})}})}),define("_collections/SitesAsEditor",[],function(){return Backbone.Collection.extend({url:function(){return Following.Model.Default.get("api_path")+"/site/"+Following.Model.Default.get("cookie_url")+"?fields=sites_as_editor"},fetch:function(t){if(!$("script[data-set='SitesAsEditor']").html())return Backbone.Collection.prototype.fetch.apply(this,arguments);this.set($.parseJSON($("script[data-set='SitesAsEditor']").html()),t),$("script[data-set='SitesAsEditor']").remove()},parse:function(t){return t.sites_as_editor?t.sites_as_editor:t}})}),shortcut={all_shortcuts:{},add:function(t,e,n){var i={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1};if(n)for(var o in i)void 0===n[o]&&(n[o]=i[o]);else n=i;var a=n.target;"string"==typeof n.target&&(a=document.getElementById(n.target)),t=t.toLowerCase();var l=function(i){var o;if((i=i||window.event,n.disable_in_input)&&(i.target?o=i.target:i.srcElement&&(o=i.srcElement),3==o.nodeType&&(o=o.parentNode),"INPUT"==o.tagName||"TEXTAREA"==o.tagName))return;i.keyCode?code=i.keyCode:i.which&&(code=i.which);var a=String.fromCharCode(code).toLowerCase();188==code&&(a=","),190==code&&(a=".");var l=t.split("+"),s=0,r={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},c={esc:27,escape:27,tab:9,space:32,return:13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,break:19,insert:45,home:36,delete:46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},d={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};i.ctrlKey&&(d.ctrl.pressed=!0),i.shiftKey&&(d.shift.pressed=!0),i.altKey&&(d.alt.pressed=!0),i.metaKey&&(d.meta.pressed=!0);for(var p=0;k=l[p],p<l.length;p++)"ctrl"==k||"control"==k?(s++,d.ctrl.wanted=!0):"shift"==k?(s++,d.shift.wanted=!0):"alt"==k?(s++,d.alt.wanted=!0):"meta"==k?(s++,d.meta.wanted=!0):k.length>1?c[k]==code&&s++:n.keycode?n.keycode==code&&s++:a==k?s++:r[a]&&i.shiftKey&&((a=r[a])==k&&s++);return s!=l.length||d.ctrl.pressed!=d.ctrl.wanted||d.shift.pressed!=d.shift.wanted||d.alt.pressed!=d.alt.wanted||d.meta.pressed!=d.meta.wanted||(e(i),n.propagate)?void 0:(i.cancelBubble=!0,i.returnValue=!1,i.stopPropagation&&(i.stopPropagation(),i.preventDefault()),!1)};this.all_shortcuts[t]={callback:l,target:a,event:n.type},a.addEventListener?a.addEventListener(n.type,l,!1):a.attachEvent?a.attachEvent("on"+n.type,l):a["on"+n.type]=l},remove:function(t){t=t.toLowerCase();var e=this.all_shortcuts[t];if(delete this.all_shortcuts[t],e){var n=e.event,i=e.target,o=e.callback;i.detachEvent?i.detachEvent("on"+n,o):i.removeEventListener?i.removeEventListener(n,o,!1):i["on"+n]=!1}}},define("_plugins/shortcuts",function(){}),function(t,e){function n(e){this.element=e,this.$element=t(e),this.init()}var i="textareaAutoSize",o="plugin_"+i;n.prototype={init:function(){var n=(this.$element.outerHeight(),parseInt(this.$element.css("paddingBottom"))+parseInt(this.$element.css("paddingTop"))||0);(function(t){return t.replace(/\s/g,"").length>0})(this.element.value)&&this.$element.height(this.element.scrollHeight-n),this.$element.on("input keyup",function(){var i=t(e),o=i.scrollTop();t(this).height(0).height(this.scrollHeight-n),i.scrollTop(o)})}},t.fn[i]=function(e){return this.each(function(){t.data(this,o)||t.data(this,o,new n(this,e))}),this}}(jQuery,window,document),define("_plugins/autosize",function(){}),Following.View={},Following.Model={},Following.Collection={},define("main",["_models/default","_views/Navigation","_views/Following","_views/FollowingFeed","_views/Star","_views/Contact","_views/Cart","_views/Import","_collections/Following","_collections/FollowedBy","_collections/SitesAsEditor","router","_plugins/shortcuts","_plugins/autosize"],function(t,e,n,i,o,a,l,s,r,c,d,p){var u=Backbone.View.extend({prevent_render:!1,data:{parent:window.parent,iframe:!1,size:null},el:"body",events:{"click [data-destination]":"navigate","focus input":"inputFocus","focus textarea":"inputFocus","blur input":"inputFocus","blur textarea":"inputFocus"},initialize:function(){window.parent!==window&&(this.data.iframe=!0),Following.Model.Default=new t,Following.Model.Default.fetch(),Following.Model.Default.url="/_api/v0/site/"+Following.Model.Default.get("site_url")+"/followdefaults",Following.Collection.followingCollection=new r,Following.Collection.followedByCollection=new c,Following.Collection.sitesAsEditorCollection=new d,Following.View.Contact=new a({model:Following.Model.Default}),Following.View.Cart=new l({model:Following.Model.Default}),Following.Events.on("slidepanel:show_contact_form",function(t){$(".cargo-logo").hide(),$(".slide-panel [data-section]").addClass("hidden").hide(),$('.slide-panel [data-section="contact"]').removeClass("hidden").show(),Following.Router.navigate("contact",!0),$("#slide-container").addClass("opening"),setTimeout(function(){$("#slide-container").addClass("open").removeClass("opening"),Following.Events.trigger("slidepanel:open_complete")},300)}),Following.Events.on("slidepanel:show_cart",_.bind(function(t){$(".cargo-logo").hide(),$(".slide-panel [data-section]").addClass("hidden").hide(),$('.slide-panel [data-section="cart"]').removeClass("hidden").show(),$("#slide-container").addClass("open"),Following.Router.navigate("cart",!0),setTimeout(function(){Following.Events.trigger("slidepanel:open_complete")},300)},this)),Following.Events.on("slidepanel:show_import",function(t){$(".cargo-logo").hide(),$(".slide-panel [data-section]").addClass("hidden").hide(),$('.slide-panel [data-section="import"]').removeClass("hidden").show(),Following.Router.navigate("import",!0),$("#slide-container").addClass("open"),setTimeout(function(){Following.Events.trigger("slidepanel:open_complete")},300)}),Following.Events.on("slidepanel:close",_.bind(function(t){$("#slide-container").addClass("closing").removeClass("open"),setTimeout(_.bind(function(){$("#slide-container").removeClass("closing"),Following.Events.trigger("slidepanel:close_complete")},this),300)},this)),this.cartRendered=!1,Following.Events.on("frame-animation-starting",function(){this.cartRendered||(Following.View.Cart.setElement($('[data-section="cart"]')).render(),this.cartRendered=!0),$(".container.following").css("display","block")}),this.setDomEvents(),this.startRouter(),this.listenTo(Following.Model.Default,"sync",this.render),Following.Model.Default.fetch({reset:!0})},render:function(){this.prevent_render?this.prevent_render=!1:(this.isMobile()&&this.$el.addClass("mobile"),("cart"!=this.start_route||void 0===parent.Cargo.Collection.StripeProducts||parent.Cargo.Collection.StripeProducts.productSyncOccurred)&&$("#following_loading").hide(),Following.View.Contact.setElement($('[data-section="contact"]')).render(),Following.Events.trigger("init-complete"))},startRouter:function(){Following.Router=new p,Backbone.history.start({pushState:!0,root:"/following/"+Following.Model.Default.get("site_url")}),this.start_route=document.location.pathname.split(Following.Model.Default.get("site_url"))[1],"/"==this.start_route.charAt(0)&&(this.start_route=this.start_route.substring(1)),""==this.start_route&&(this.start_route="following"),"contact"==this.start_route?($('[data-section="contact"]').removeClass("hidden").show(),$("#slide-container").addClass("open"),Following.Events.trigger("slidepanel:open_complete")):"cart"==this.start_route?($('[data-section="cart"]').removeClass("hidden").show(),$("#slide-container").addClass("open"),Following.Events.trigger("slidepanel:open_complete")):Following.Events.trigger("slidepanel:close")},setDomEvents:function(){$(document).on("dragover",function(t){t.preventDefault()}),$(document).on("drop",function(t){t.preventDefault()}),$(document).on("keyup",function(t){27===t.keyCode&&parent!==window&&parent.Cargo.View.Following.isActive()&&parent.Cargo.View.Following.Toggle()}),$(document).on("keypress",function(t){!0===t.shiftKey&&(65===t.charCode?parent!==window&&"TEXTAREA"!==t.target.nodeName&&"INPUT"!==t.target.nodeName&&(window.top.location.href="/admin"):70===t.charCode&&parent!==window&&"TEXTAREA"!==t.target.nodeName&&"INPUT"!==t.target.nodeName&&parent.Cargo.View.Following.Toggle())})},navigate:function(t){var e="/"+$(t.currentTarget).data("destination");return Following.View.Main.data.parent.Cargo.Event.trigger("add_history",e),!1},isIOS:function(){return!!navigator.userAgent.match(/i(Phone|Pod|Pad)/i)},isMobile:function(){if(this.isIOS())return!0;var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e},inputFocus:function(t){this.isIOS()&&("focusin"==t.type?$("[data-following-footer]").addClass("disabled"):"focusout"==t.type&&$("[data-following-footer]").removeClass("disabled"))}});Following.View.Main=new u}),requirejs.config({baseUrl:"/_jsapps/following",deps:["main"],paths:{text:"//static.cargo.site/libs/require/text.2.0.16.min",css:"//static.cargo.site/libs/require/css.min",migration:"../migration"}}),define("main.bootstrap",function(){});