!function(e,t,i){function n(e,t,i){return e.call.apply(e.bind,arguments)}function o(e,t,i){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function a(e,t,i){return(a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?n:o).apply(null,arguments)}var r=Date.now||function(){return+new Date};function s(e,t){this.J=e,this.w=t||e,this.F=this.w.document}function l(e,i,n){(e=e.F.getElementsByTagName(i)[0])||(e=t.documentElement),e&&e.lastChild&&e.insertBefore(n,e.lastChild)}function d(e,t,i){t=t||[],i=i||[];for(var n=e.className.split(/\s+/),o=0;o<t.length;o+=1){for(var a=!1,r=0;r<n.length;r+=1)if(t[o]===n[r]){a=!0;break}a||n.push(t[o])}for(t=[],o=0;o<n.length;o+=1){for(a=!1,r=0;r<i.length;r+=1)if(n[o]===i[r]){a=!0;break}a||t.push(n[o])}e.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function c(e,t){for(var i=e.className.split(/\s+/),n=0,o=i.length;n<o;n++)if(i[n]==t)return!0;return!1}function h(e){if("string"==typeof e.na)return e.na;var t=e.w.location.protocol;return"about:"==t&&(t=e.J.location.protocol),"https:"==t?"https:":"http:"}function u(e,t){var i=e.createElement("link",{rel:"stylesheet",href:t,media:"all"}),n=!1;i.onload=function(){n||(n=!0)},i.onerror=function(){n||(n=!0)},l(e,"head",i)}function g(t,i,n,o){var a=t.F.getElementsByTagName("head")[0];if(a){var r=t.createElement("script",{src:i}),s=!1;return r.onload=r.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,n&&n(null),r.onload=r.onreadystatechange=null,"HEAD"==r.parentNode.tagName&&a.removeChild(r))},a.appendChild(r),e.setTimeout(function(){s||(s=!0,n&&n(Error("Script load timeout")))},o||5e3),r}return null}function p(e,t){this.N=e,this.ga=t}function m(e,t,i,n){this.d=null!=e?e:null,this.g=null!=t?t:null,this.B=null!=i?i:null,this.f=null!=n?n:null}s.prototype.createElement=function(e,t,i){if(e=this.F.createElement(e),t)for(var n in t)t.hasOwnProperty(n)&&("style"==n?e.style.cssText=t[n]:e.setAttribute(n,t[n]));return i&&e.appendChild(this.F.createTextNode(i)),e};var f=/^([0-9]+)(?:[\._-]([0-9]+))?(?:[\._-]([0-9]+))?(?:[\._+-]?(.*))?$/;function v(e){var t=null,i=null,n=null,o=null;return(e=f.exec(e))&&(null!==e[1]&&e[1]&&(t=parseInt(e[1],10)),null!==e[2]&&e[2]&&(i=parseInt(e[2],10)),null!==e[3]&&e[3]&&(n=parseInt(e[3],10)),null!==e[4]&&e[4]&&(o=/^[0-9]+$/.test(e[4])?parseInt(e[4],10):e[4])),new m(t,i,n,o)}function b(e,t,i,n,o,a,r,s){this.L=e,this.m=s}function y(e){this.a=e}m.prototype.compare=function(e){return this.d>e.d||this.d===e.d&&this.g>e.g||this.d===e.d&&this.g===e.g&&this.B>e.B?1:this.d<e.d||this.d===e.d&&this.g<e.g||this.d===e.d&&this.g===e.g&&this.B<e.B?-1:0},m.prototype.toString=function(){return[this.d,this.g||"",this.B||"",this.f||""].join("")},b.prototype.getName=function(){return this.L};var _=new b("Unknown",0,0,0,0,0,0,new p(!1,!1));function w(e){var t=k(e.a,/(iPod|iPad|iPhone|Android|Windows Phone|BB\d{2}|BlackBerry)/,1);return""!=t?(/BB\d{2}/.test(t)&&(t="BlackBerry"),t):""!=(e=k(e.a,/(Linux|Mac_PowerPC|Macintosh|Windows|CrOS|PlayStation|CrKey)/,1))?("Mac_PowerPC"==e?e="Macintosh":"PlayStation"==e&&(e="Linux"),e):"Unknown"}function C(e){if((t=k(e.a,/(OS X|Windows NT|Android) ([^;)]+)/,2))||(t=k(e.a,/Windows Phone( OS)? ([^;)]+)/,2))||(t=k(e.a,/(iPhone )?OS ([\d_]+)/,2)))return t;if(t=k(e.a,/(?:Linux|CrOS|CrKey) ([^;)]+)/,1))for(var t=t.split(/\s/),i=0;i<t.length;i+=1)if(/^[\d\._]+$/.test(t[i]))return t[i];return(e=k(e.a,/(BB\d{2}|BlackBerry).*?Version\/([^\s]*)/,2))?e:"Unknown"}function S(e){var t=w(e),i=v(C(e)),n=v(k(e.a,/AppleWeb(?:K|k)it\/([\d\.\+]+)/,1)),o="Unknown",a=new m;a="Unknown";return/OPR\/[\d.]+/.test(e.a)?o="Opera":-1!=e.a.indexOf("Chrome")||-1!=e.a.indexOf("CrMo")||-1!=e.a.indexOf("CriOS")?o="Chrome":/Silk\/\d/.test(e.a)?o="Silk":"BlackBerry"==t||"Android"==t?o="BuiltinBrowser":-1!=e.a.indexOf("PhantomJS")?o="PhantomJS":-1!=e.a.indexOf("Safari")?o="Safari":-1!=e.a.indexOf("AdobeAIR")?o="AdobeAIR":-1!=e.a.indexOf("PlayStation")&&(o="BuiltinBrowser"),"BuiltinBrowser"==o?a="Unknown":"Silk"==o?a=k(e.a,/Silk\/([\d\._]+)/,1):"Chrome"==o?a=k(e.a,/(Chrome|CrMo|CriOS)\/([\d\.]+)/,2):-1!=e.a.indexOf("Version/")?a=k(e.a,/Version\/([\d\.\w]+)/,1):"AdobeAIR"==o?a=k(e.a,/AdobeAIR\/([\d\.]+)/,1):"Opera"==o?a=k(e.a,/OPR\/([\d.]+)/,1):"PhantomJS"==o&&(a=k(e.a,/PhantomJS\/([\d.]+)/,1)),a=v(a),new b(o,0,0,0,0,0,0,new p("AdobeAIR"==o?2<a.d||2==a.d&&5<=a.g:"BlackBerry"==t?10<=i.d:"Android"==t?2<i.d||2==i.d&&1<i.g:526<=n.d||525<=n.d&&13<=n.g,536>n.d||536==n.d&&11>n.g))}function k(e,t,i){return(e=e.match(t))&&e[i]?e[i]:""}function x(e){this.ma=e||"-"}function E(e,t){this.L=e,this.X=4,this.M="n";var i=(t||"n4").match(/^([nio])([1-9])$/i);i&&(this.M=i[1],this.X=parseInt(i[2],10))}function I(e){return e.M+e.X}function T(e){var t=4,i="n",n=null;return e&&((n=e.match(/(normal|oblique|italic)/i))&&n[1]&&(i=n[1].substr(0,1).toLowerCase()),(n=e.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?t=7:/[1-9]00/.test(n[1])&&(t=parseInt(n[1].substr(0,1),10)))),i+t}function A(e,t){this.c=e,this.q=e.w.document.documentElement,this.P=t,this.j="wf",this.h=new x("-"),this.ha=!1!==t.events,this.C=!1!==t.classes}function M(e){if(e.C){var t=c(e.q,e.h.f(e.j,"active")),i=[],n=[e.h.f(e.j,"loading")];t||i.push(e.h.f(e.j,"inactive")),d(e.q,i,n)}P(e,"inactive")}function P(e,t,i){e.ha&&e.P[t]&&(i?e.P[t](i.getName(),I(i)):e.P[t]())}function O(){this.ca={}}function L(e,t){this.c=e,this.H=t,this.k=this.c.createElement("span",{"aria-hidden":"true"},this.H)}function D(e){l(e.c,"body",e.k)}function N(e){var t;t=[];for(var i=e.L.split(/,\s*/),n=0;n<i.length;n++){var o=i[n].replace(/['"]/g,"");-1==o.indexOf(" ")?t.push(o):t.push("'"+o+"'")}return t=t.join(","),i="normal","o"===e.M?i="oblique":"i"===e.M&&(i="italic"),"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+t+";font-style:"+i+";font-weight:"+e.X+"00;"}function $(e,t,i,n,o,a,r,s){this.Y=e,this.ka=t,this.c=i,this.o=n,this.m=o,this.H=s||"BESbswy",this.v={},this.W=a||3e3,this.ba=r||null,this.G=this.u=this.t=null,this.t=new L(this.c,this.H),this.u=new L(this.c,this.H),this.G=new L(this.c,this.H),e=N(e=new E("serif",I(this.o))),this.t.k.style.cssText=e,e=N(e=new E("sans-serif",I(this.o))),this.u.k.style.cssText=e,e=N(e=new E("monospace",I(this.o))),this.G.k.style.cssText=e,D(this.t),D(this.u),D(this.G),this.v.serif=this.t.k.offsetWidth,this.v["sans-serif"]=this.u.k.offsetWidth,this.v.monospace=this.G.k.offsetWidth}y.prototype.parse=function(){var e;if(-1!=this.a.indexOf("MSIE")||-1!=this.a.indexOf("Trident/")){e=w(this);var t=v(C(this)),i=null,n=k(this.a,/Trident\/([\d\w\.]+)/,1);i=-1!=this.a.indexOf("MSIE")?v(k(this.a,/MSIE ([\d\w\.]+)/,1)):v(k(this.a,/rv:([\d\w\.]+)/,1));""!=n&&v(n),e=new b("MSIE",0,0,0,0,0,0,new p("Windows"==e&&6<=i.d||"Windows Phone"==e&&8<=t.d,!1))}else if(-1!=this.a.indexOf("Opera"))e:if(e=v(k(this.a,/Presto\/([\d\w\.]+)/,1)),v(C(this)),null!==e.d||v(k(this.a,/rv:([^\)]+)/,1)),-1!=this.a.indexOf("Opera Mini/"))e=v(k(this.a,/Opera Mini\/([\d\.]+)/,1)),e=new b("OperaMini",0,0,0,w(this),0,0,new p(!1,!1));else{if(-1!=this.a.indexOf("Version/")&&null!==(e=v(k(this.a,/Version\/([\d\.]+)/,1))).d){e=new b("Opera",0,0,0,w(this),0,0,new p(10<=e.d,!1));break e}e=null!==(e=v(k(this.a,/Opera[\/ ]([\d\.]+)/,1))).d?new b("Opera",0,0,0,w(this),0,0,new p(10<=e.d,!1)):new b("Opera",0,0,0,w(this),0,0,new p(!1,!1))}else/OPR\/[\d.]+/.test(this.a)?e=S(this):/AppleWeb(K|k)it/.test(this.a)?e=S(this):-1!=this.a.indexOf("Gecko")?(e="Unknown",t=new m,v(C(this)),t=!1,-1!=this.a.indexOf("Firefox")?(e="Firefox",t=3<=(t=v(k(this.a,/Firefox\/([\d\w\.]+)/,1))).d&&5<=t.g):-1!=this.a.indexOf("Mozilla")&&(e="Mozilla"),i=v(k(this.a,/rv:([^\)]+)/,1)),t||(t=1<i.d||1==i.d&&9<i.g||1==i.d&&9==i.g&&2<=i.B),e=new b(e,0,0,0,w(this),0,0,new p(t,!1))):e=_;return e},x.prototype.f=function(e){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.ma)},E.prototype.getName=function(){return this.L},L.prototype.remove=function(){var e=this.k;e.parentNode&&e.parentNode.removeChild(e)};var V={sa:"serif",ra:"sans-serif",qa:"monospace"};function H(e,t,i){for(var n in V)if(V.hasOwnProperty(n)&&t===e.v[V[n]]&&i===e.v[V[n]])return!0;return!1}function R(e){var t=e.t.k.offsetWidth,i=e.u.k.offsetWidth;t===e.v.serif&&i===e.v["sans-serif"]||e.m.ga&&H(e,t,i)?r()-e.oa>=e.W?e.m.ga&&H(e,t,i)&&(null===e.ba||e.ba.hasOwnProperty(e.o.getName()))?G(e,e.Y):G(e,e.ka):function(e){setTimeout(a(function(){R(this)},e),50)}(e):G(e,e.Y)}function G(e,t){e.t.remove(),e.u.remove(),e.G.remove(),t(e.o)}function F(e,t,i,n){this.c=t,this.A=i,this.R=0,this.ea=this.aa=!1,this.W=n,this.m=e.m}function B(e,t,i,n,o){if(i=i||{},0===t.length&&o)M(e.A);else for(e.R+=t.length,o&&(e.aa=o),o=0;o<t.length;o++){var r=t[o],s=i[r.getName()],l=e.A,c=r;l.C&&d(l.q,[l.h.f(l.j,c.getName(),I(c).toString(),"loading")]),P(l,"fontloading",c),l=null,(l=new $(a(e.ia,e),a(e.ja,e),e.c,r,e.m,e.W,n,s)).start()}}function z(e){0==--e.R&&e.aa&&(e.ea?((e=e.A).C&&d(e.q,[e.h.f(e.j,"active")],[e.h.f(e.j,"loading"),e.h.f(e.j,"inactive")]),P(e,"active")):M(e.A))}function q(e){this.J=e,this.Z=new O,this.pa=new y(e.navigator.userAgent),this.a=this.pa.parse(),this.T=this.U=0,this.Q=this.S=!0}function W(e,t){re.Z.ca[e]=t}function j(e,t,i){this.O=e||t+U,this.s=[],this.V=[],this.fa=i||""}$.prototype.start=function(){this.oa=r();var e=N(e=new E(this.o.getName()+",serif",I(this.o)));this.t.k.style.cssText=e,e=N(e=new E(this.o.getName()+",sans-serif",I(this.o))),this.u.k.style.cssText=e,R(this)},F.prototype.ia=function(e){var t=this.A;t.C&&d(t.q,[t.h.f(t.j,e.getName(),I(e).toString(),"active")],[t.h.f(t.j,e.getName(),I(e).toString(),"loading"),t.h.f(t.j,e.getName(),I(e).toString(),"inactive")]),P(t,"fontactive",e),this.ea=!0,z(this)},F.prototype.ja=function(e){var t=this.A;if(t.C){var i=c(t.q,t.h.f(t.j,e.getName(),I(e).toString(),"active")),n=[],o=[t.h.f(t.j,e.getName(),I(e).toString(),"loading")];i||n.push(t.h.f(t.j,e.getName(),I(e).toString(),"inactive")),d(t.q,n,o)}P(t,"fontinactive",e),z(this)},q.prototype.load=function(e){this.c=new s(this.J,e.context||this.J),this.S=!1!==e.events,this.Q=!1!==e.classes;var t=new A(this.c,e),i=[],n=e.timeout;t.C&&d(t.q,[t.h.f(t.j,"loading")]),P(t,"loading");i=this.Z;var o,r=this.c,l=[];for(o in e)if(e.hasOwnProperty(o)){var c=i.ca[o];c&&l.push(c(e[o],r))}for(i=l,this.T=this.U=i.length,e=new F(this.a,this.c,t,n),n=0,o=i.length;n<o;n++)(r=i[n]).D(this.a,a(this.la,this,r,t,e))},q.prototype.la=function(e,t,i,n){var o=this;n?e.load(function(e,t,n){!function(e,t,i,n,o){var a=0==--e.U;(e.Q||e.S)&&setTimeout(function(){B(t,i,n||null,o||null,a)},0)}(o,i,e,t,n)}):(e=0==--this.U,this.T--,e&&0==this.T?M(t):(this.Q||this.S)&&B(i,[],{},null,e))};var U="//fonts.googleapis.com/css";function K(e){this.s=e,this.da=[],this.K={}}j.prototype.f=function(){if(0==this.s.length)throw Error("No fonts to load!");if(-1!=this.O.indexOf("kit="))return this.O;for(var e=this.s.length,t=[],i=0;i<e;i++)t.push(this.s[i].replace(/ /g,"+"));return e=this.O+"?family="+t.join("%7C"),0<this.V.length&&(e+="&subset="+this.V.join(",")),0<this.fa.length&&(e+="&text="+encodeURIComponent(this.fa)),e};var Z={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},X={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},Y={i:"i",italic:"i",n:"n",normal:"n"},J=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function Q(e,t){this.a=new y(navigator.userAgent).parse(),this.c=e,this.e=t}K.prototype.parse=function(){for(var e=this.s.length,t=0;t<e;t++){var i=this.s[t].split(":"),n=i[0].replace(/\+/g," "),o=["n4"];if(2<=i.length){var a;if(a=[],r=i[1])for(var r,s=(r=r.split(",")).length,l=0;l<s;l++){var d;if((d=r[l]).match(/^[\w-]+$/)){var c=void 0;if(null==(d=J.exec(d.toLowerCase())))c="";else{if(c=void 0,null==(c=d[1])||""==c)c="4";else{var h=X[c];c=h||(isNaN(c)?"4":c.substr(0,1))}c=[null==(d=d[2])||""==d?"n":Y[d],c].join("")}d=c}else d="";d&&a.push(d)}0<a.length&&(o=a),3==i.length&&(a=[],0<(i=(i=i[2])?i.split(","):a).length&&(i=Z[i[0]])&&(this.K[n]=i))}for(this.K[n]||(i=Z[n])&&(this.K[n]=i),i=0;i<o.length;i+=1)this.da.push(new E(n,o[i]))}};var ee={Arimo:!0,Cousine:!0,Tinos:!0};function te(e,t){this.c=e,this.e=t,this.p=[]}function ie(e,t){this.c=e,this.e=t,this.p=[]}function ne(e,t){this.c=e,this.e=t,this.p=[]}function oe(e,t){this.c=e,this.e=t}function ae(e,t){this.c=e,this.e=t}Q.prototype.D=function(e,t){t(e.m.N)},Q.prototype.load=function(e){var t=this.c;"MSIE"==this.a.getName()&&1!=this.e.blocking?function(e,t){!function i(){e.F.body?t():setTimeout(i,0)}()}(t,a(this.$,this,e)):this.$(e)},Q.prototype.$=function(e){for(var t=this.c,i=new j(this.e.api,h(t),this.e.text),n=this.e.families,o=n.length,a=0;a<o;a++){var r=n[a].split(":");3==r.length&&i.V.push(r.pop());var s="";2==r.length&&""!=r[1]&&(s=":"),i.s.push(r.join(s))}(n=new K(n)).parse(),u(t,i.f()),e(n.da,n.K,ee)},te.prototype.I=function(e){var t=this.c;return h(this.c)+(this.e.api||"//f.fontdeck.com/s/css/js/")+(t.w.location.hostname||t.J.location.hostname)+"/"+e+".js"},te.prototype.D=function(e,t){var i=this.e.id,n=this.c.w,o=this;i?(n.__webfontfontdeckmodule__||(n.__webfontfontdeckmodule__={}),n.__webfontfontdeckmodule__[i]=function(e,i){for(var n=0,a=i.fonts.length;n<a;++n){var r=i.fonts[n];o.p.push(new E(r.name,T("font-weight:"+r.weight+";font-style:"+r.style)))}t(e)},g(this.c,this.I(i),function(e){e&&t(!1)})):t(!1)},te.prototype.load=function(e){e(this.p)},ie.prototype.I=function(e){var t=h(this.c);return(this.e.api||t+"//use.typekit.net")+"/"+e+".js"},ie.prototype.D=function(e,t){var i=this.e.id,n=this.c.w,o=this;i?g(this.c,this.I(i),function(e){if(e)t(!1);else{if(n.Typekit&&n.Typekit.config&&n.Typekit.config.fn){e=n.Typekit.config.fn;for(var i=0;i<e.length;i+=2)for(var a=e[i],r=e[i+1],s=0;s<r.length;s++)o.p.push(new E(a,r[s]));try{n.Typekit.load({events:!1,classes:!1})}catch(e){}}t(!0)}},2e3):t(!1)},ie.prototype.load=function(e){e(this.p)},ne.prototype.D=function(e,t){var i=this,n=i.e.projectId,o=i.e.version;if(n){var a=i.c.w;g(this.c,i.I(n,o),function(o){if(o)t(!1);else{if(a["__mti_fntLst"+n]&&(o=a["__mti_fntLst"+n]()))for(var r=0;r<o.length;r++)i.p.push(new E(o[r].fontfamily));t(e.m.N)}}).id="__MonotypeAPIScript__"+n}else t(!1)},ne.prototype.I=function(e,t){return h(this.c)+"//"+(this.e.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"")+"/"+e+".js"+(t?"?v="+t:"")},ne.prototype.load=function(e){e(this.p)},oe.prototype.load=function(e){var t,i,n=this.e.urls||[],o=this.e.families||[],a=this.e.testStrings||{};for(t=0,i=n.length;t<i;t++)u(this.c,n[t]);for(n=[],t=0,i=o.length;t<i;t++){var r=o[t].split(":");if(r[1])for(var s=r[1].split(","),l=0;l<s.length;l+=1)n.push(new E(r[0],s[l]));else n.push(new E(r[0]))}e(n,a)},oe.prototype.D=function(e,t){return t(e.m.N)},ae.prototype.load=function(e){var t,i,n=this.e.families||[];0<n.length&&(""!==(t=n.join("|"))&&(t=t.replace(/ /g,""),u(this.c,"/type/css?family="+t)));var o=[];for(t=0,i=n.length;t<i;t++){var a=n[t].split(":");if(a[1])for(var r=a[1].split(","),s=0;s<r.length;s+=1)o.push(new E(a[0],r[s]));else o.push(new E(a[0]))}e(o)},ae.prototype.D=function(e,t){return t(e.m.N)};var re=new q(this);W("custom",function(e,t){return new oe(t,e)}),W("Persona",function(e,t){return new ae(t,e)}),W("fontdeck",function(e,t){return new te(t,e)}),W("monotype",function(e,t){return new ne(t,e)}),W("typekit",function(e,t){return new ie(t,e)}),W("google",function(e,t){return new Q(t,e)}),this.WebFont||(this.WebFont={},this.WebFont.load=a(re.load,re),this.WebFontConfig&&re.load(this.WebFontConfig))}(this,document);var Cargo={o:{}};Cargo.o.model={},Cargo.o.collection={},Cargo.o.view={},Cargo.Router={},Cargo.Template={},Cargo.Helper={},Cargo.API={},Cargo.Event={},Cargo.Collection={},Cargo.Model={},Cargo.View={};var Action=window.Action||{};function in_array(e,t,i){var n="";if(!!i){for(n in t)if(t[n]===e)return!0}else for(n in t)if(t[n]==e)return!0;return!1}function strip_tags(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,i){return t.indexOf("<"+i.toLowerCase()+">")>-1?e:""})}function closest(e,t){var i=e&&(t(e)?e:closest(e.parentNode,t));return i||null}function ucFirst(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function lerp(e,t,i){var n=Math.max(Math.min(i,1),0);return(1-n)*e+n*t}Cargo.Core={log:function(e){"undefined"!=typeof console&&window.console&&console.log(e)},KeyboardShortcut:{Add:function(e,t,i){var n={type:"keydown",disable_in_input:!0,propagate:!0,keycode:t};shortcut.add(e,i,n)},Remove:function(e){shortcut.remove(e)},InitDefaults:function(){Cargo.Helper.IsAdminPath()||(this.Add("X",88,function(){lightbox.isActive||Action.Page.Home()}),this.Add("I",73,function(){lightbox.isActive||Action.Page.Home()}),this.Add("J",74,function(){lightbox.isActive||Action.Page.Next()}),this.Add("K",75,function(){lightbox.isActive||Action.Page.Prev()}),this.Add("Right",39,function(){lightbox.isActive||Action.Page.Next()}),this.Add("Left",37,function(){lightbox.isActive||Action.Page.Prev()}),this.Add("R",82,function(){lightbox.isActive||Action.Page.Random()}),this.Add("Shift+G",71,function(){lightbox.isActive||Cargo.Helper.GoToUrl("img")}),this.Add("Meta+/",191,function(e){e.preventDefault(),Action.yepThisIsACargoSite()})),this.Add("Shift+A",65,function(){Cargo.Helper.GoToUrl("admin")});var e=0;mouseY=0,Cargo.Model.DisplayOptions.get("layout_options").is_feed&&window.addEventListener("mousemove",function(t){e=t.clientX,mouseY=t.clientY}),Cargo.Core.loadAdminForActivePage=function(){if(parent.location==window.location)if(Cargo.Model.Site.GetIsEditor()){var t,i,n,o,a,r,s=Cargo.View.Content.el.querySelectorAll(".page.container[data-id]"),l=window.innerHeight/2,d=9e9;_.each(s,function(e){e.style.minHeight="1px"}),_.each(s,function(o){(a=o.getBoundingClientRect()).top<mouseY&&a.bottom>mouseY&&a.left<e&&a.right>e&&(i=o),a.top<l&&a.bottom>l?(t=o,d=0):d>0&&(a.top>l?n=Math.abs(l-a.top):a.bottom<l&&(n=Math.abs(l-a.bottom)),n<d&&(t=o,d=n))}),_.each(s,function(e){e.style.minHeight=""}),(t||i)&&(i?r=parseInt(i.getAttribute("data-id")):t&&(r=parseInt(t.getAttribute("data-id"))),o=Cargo.Collection.Scaffolding.getModel({id:r})),!o&&Cargo.View.Content.currentSet&&(o=Cargo.View.Content.currentSet.model),o&&!o.get("pin")?((o.get("stack")||o.get("is_set"))&&o.get("pages")&&o.get("pages").length>0&&(o=o.get("pages").models[0]),Cargo.Helper.GoToUrl("admin/"+o.id)):Cargo.Helper.GoToUrl("admin")}else Cargo.Helper.GoToUrl("admin")},this.Add("Shift+E",69,Cargo.Core.loadAdminForActivePage),this.Add("Shift+H",72,function(){Cargo.Helper.GoToUrl("admin/design/html")}),this.Add("Shift+C",67,function(){Cargo.Helper.GoToUrl("admin/design/css")}),this.Add("Shift+I",73,function(){Cargo.Helper.GoToUrl("admin/design/css")}),this.Add("Shift+D",68,function(){Cargo.Helper.GoToUrl("admin/design")}),this.Add("Shift+X",88,function(){Cargo.Helper.GoToUrl("")}),this.Add("Esc",27,function(){Cargo.Helper.IsAdminPath()||(Cargo.View.Following.isActive()&&!Cargo.Modal.isActive()?Cargo.View.Following.Toggle():Cargo.View.SiteMenu.isActive()?Cargo.View.SiteMenu.hide():lightbox.isActive||Action.Page.Home())})}},InitKeycodeListener:function(){var e=_.bind(function(e){e.shiftKey||(83==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),Cargo.Event.trigger("save_shortcut_triggered",e),Cargo.contentWindow||window.top.Cargo.Event.trigger("save_shortcut_triggered",e)),13==e.keyCode&&Cargo.Event.trigger("enter_keycode_triggered",e),27==e.keyCode&&Cargo.Event.trigger("esc_keycode_triggered",e))},this);document.addEventListener("keydown",e,!1)},InitMessageListener:function(){window.addEventListener("message",function(e){"object"==typeof e.data&&"retrieve-newsletter-html"===e.data.type&&e.data.pid&&Cargo.View.Content.retrieveActivePageViewForPID(e.data.pid,_.bind(function(t){t&&setTimeout(function(){var i="https://weekly.cargo.site/w/",n=t.el.querySelector(".page_content");_.each(n.querySelectorAll("a[href]"),function(t){t.setAttribute("href",i+e.data.newsLetterID+"/[email-id]/click?l="+t.href)}),_.each(n.querySelectorAll("img"),function(e){var t=e.getAttribute("src"),i=e.offsetWidth,n=e.offsetHeight;for(e.hasAttribute("data-lazy-src")&&(t=e.getAttribute("data-lazy-src"));e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e.setAttribute("src",t),e.setAttribute("width",i),e.setAttribute("height",n)});var o=document.createElement("a"),a=document.createElement("img");o.href=i+e.data.newsLetterID+"/[email-id]/unsubscribe",o.className="unsubscribe-link",o.innerHTML="Unsubscribe",a.src=i+e.data.newsLetterID+"/[email-id]/open.gif",a.width=1,a.height=1,a.style.visibility="hidden",a.className="tracking_pixel",n.appendChild(o),n.insertBefore(a,n.firstChild),parent.postMessage({type:"retrieve-newsletter-html-response",html:n.outerHTML,css:t.getLocalCSSElement().innerHTML.trim()},"*")},1e3)},this))},!1)},ReseedThumbnailCollection:function(){Cargo.Event.trigger("thumbnails:clear_cache"),Cargo.Collection.GlobalThumbnails.fetch({params:Cargo.Collection.GlobalThumbnails.currentParams,from_thumbnail_reseed:!0,reset:!0,merge:!0,success:function(){Cargo.View.Thumbnail.checkAndLoadThumbnails(Cargo.Helper.GetCurrentProjectId()),Cargo.Event.trigger("reseed_thumbnails_complete")}})}},Cargo.o.analytics=Backbone.View.extend({Config:{id:"UA-1837333-7",name:"__cargo_analytics"},initialize:function(){var e,t,i,n,o,a;this.enabled=!0!==Cargo.Model.DisplayOptions.get("analytics_disabled"),this.enabled&&(Cargo.API.Config.is_domain&&(this.Config.custom_url="/"+document.location.host),e=window,t=document,i="script",n="ga",e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,o=t.createElement(i),a=t.getElementsByTagName(i)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",a.parentNode.insertBefore(o,a),ga("create",this.Config.id,"auto",{name:this.Config.name,cookieName:this.Config.name}),this.pageview(!1))},setDimension:function(e,t){this.enabled&&ga(this.Config.name+".set",e,t)},pageview:function(e,t){var i=this.Config.name,n=document.location.pathname.replace(/\/$/,"");if(this.enabled){if(void 0!==t&&!e)return void ga(this.Config.name+".send","pageview",{page:t,dimension3:"Cargo 2"});void 0!==this.Config.custom_url?ga(this.Config.name+".send","pageview",{page:this.Config.custom_url+n,dimension3:"Cargo 2"}):ga(this.Config.name+".send","pageview",{dimension3:"Cargo 2"})}"function"==typeof ga&&e&&(ga(function(){ga.getAll().map(function(e){var t=e.get("name");t!=i&&ga(t+".send","pageview",{page:n})})}),"undefined"!=typeof _gaq&&_gaq.push(["_trackPageview",n]))}}),Cargo.o.api=Backbone.View.extend({Config:{Version:"v0",api_path:"/_api",cargo_id:"",cargo_url:"",filter:"",search_term:"",route_name:"",current_offset:0,current_page:1,is_filter:!1,is_search:!1,is_editor:!1,is_template:!1,is_solo:!1,is_direct_link:!1,is_custom_route:!1,admin_edit_project:!1,first_load_finished:!1,tags:null},initialize:function(){_.extend(this.Config,$.parseJSON($("script[data-set='defaults']").html()))},fetch:function(e,t){$.getJSON(e,t)},GetBasePath:function(){var e=this.Config;return e.api_path+"/"+e.Version},GetSitePath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/site/"+e.cargo_url},GetDesignPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/design/"+e.cargo_url},GetTemplatesPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/templates"},GetDesignFile:function(e){return this.GetDesignPath()+"?file="+e},GetTemplatePath:function(){var e=this.Config,t=e.route_name?e.route_name+"/":"";return this.GetDesignFile(t)},GetFilesPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/files"},GetDesignAndFile:function(e,t){var i=this.GetTemplatePath()+e;return t&&(i+="&to_var=true"),i},GetDisplayOptionsPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/displayoptions/"+e.cargo_url},GetImagesPath:function(e,t,i){e=e||"newest",t=t||"true",i=i||"false";var n=this.GetSitePath()+"/images";return n+="?sort="+e+"&unique="+t+"&projectsonly="+i},GetPluginsPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/backdrops"},GetPagesPath:function(e,t,i){var n=this.GetSitePath()+"/pages";if(void 0!==e||void 0!==t||void 0!==i){"string"==typeof e&&(e=e.replace(/\ /g,"-")),n+="?";var o=new Array;void 0!==e&&o.push("tags="+e),void 0!==t&&o.push("offset="+t),void 0!==i&&o.push("limit="+i),n+=o.join("&")}return n},GetContentCollectionPath:function(e){var t=this.GetSitePath()+"/content";return e&&(t+="?tags="+e),t},GetAdminListPath:function(e,t){return e=e||this.Config.current_offset,t=t||Cargo.Helper.GetPageLimit(),this.GetSitePath()+"/admincollection"},GetSinglePagePath:function(e){var t=this.Config,i=t.api_path+"/"+t.Version+"/page";return e&&void 0!==e&&(i+="/"+e),i},GetSingleContentPath:function(e){var t=this.GetContentCollectionPath();return e?t+"/"+e:t},GetSingleStackPath:function(e){return this.GetSitePath()+"/stack/"+e},GetSiteFilesPutPath:function(){return"/dispatch/files/putFile"},GetDataPackage:function(e,t){var i={site:Cargo.Model.Site.toJSON(),display_options:Cargo.Model.DisplayOptions.toJSON(),config:this.Config};return i[e]=t,i},GetThumbnailsPath:function(e,t,i,n,o,a,r){var s=this.Config,l=s.api_path+"/"+s.Version+"/thumbnails/"+s.cargo_url;if(void 0!==e||void 0!==i||void 0!==n||void 0!==o||void 0!==a||void 0!==r||void 0!==t){"string"==typeof i&&(i=i.replace(/\ /g,"-")),l+="?";var d=new Array;void 0!==e&&d.push("page_id="+e),void 0!==t&&d.push("all=true"),void 0!==i&&d.push("tags="+i),void 0!==n&&d.push("set_id="+n),void 0!==o&&d.push("offset="+o),void 0!==r?(d.push("random_limit="+r),d.push("random=true")):void 0!==a&&d.push("limit="+a),l+=d.join("&")}return l},GetThumbnailModesPath:function(){var e=this.Config;return e.api_path+"/"+e.Version+"/thumbnailsettings/modes"},GetAllThumbnailSettingsPath:function(e,t,i){var n=this.Config,o=n.api_path+"/"+n.Version+"/thumbnailsettings/"+n.cargo_url+"/all";if(e||i||t){o+="?";var a=new Array;e&&a.push("page_id="+e),i&&a.push("iterator="+i),t&&a.push("mode_id="+t),o+=a.join("&")}return o},GetActiveThumbnailSettingsPath:function(e,t,i,n){var o=this.Config,a=o.api_path+"/"+o.Version+"/thumbnailsettings/"+o.cargo_url+"/single";if(n&&(a+="/"+n),e||i||t){a+="?";var r=new Array;e&&r.push("page_id="+e),i&&r.push("iterator="+i),t&&r.push("mode_id="+t),a+=r.join("&")}return a},PutSiteFile:function(e,t,i){$.ajax({type:"POST",url:this.GetSiteFilesPutPath(),context:this,data:{file:e,data:t,uid:Cargo.Model.Site.GetId()},dataType:"json",success:function(e){"function"==typeof i&&i.call(this,e)},error:function(e){}})}}),Action={Page:{Home:function(e){Cargo.View.Main.ShowHome(void 0,e)},Next:function(){Cargo.View.Main.NextPage()},Prev:function(){Cargo.View.Main.PrevPage()},Random:function(){Cargo.View.Main.RandomPage()}},yepThisIsACargoSite:function(){var e=new Image;e.onload=function(){var e=document.createElement("div");e.style.top="20%",e.style.width="100%",e.style.height="60%",e.style.zIndex="999",e.style.position="fixed",e.style.background='url("/assets/bolt.gif") center center / contain no-repeat',setTimeout(function(){e.style.transition="opacity 500ms",setTimeout(function(){e.parentNode.removeChild(e),e=null},700),setTimeout(function(){e.style.opacity="0"})},1e3),document.body.appendChild(e)},e.src="/assets/bolt.gif"},Start:function(e){$("[data-example-start]").html('<div class="loading_animation pulsing white inline right"><div></div></div>'),Cargo.API.Config.cookie_link&&Cargo.API.Config.cookie_site_count>0?Cargo.Modal.Alert({message:"<em>Youâ€™re already logged in; you can create new Sites in your Settings panel.</em>",confirm:function(){top.document.location.href=Cargo.API.Config.cookie_link+"/admin"}}):require(["/_jsapps/admin/_models/adminsite.js"],function(t){var i=new t;i.bind("sync",function(e,t){document.location.href=t.redirect}),i.bind("error",function(e,t){var i=JSON.parse(t.responseText);i&&i.message?Cargo.Modal.Alert({message:i.message,confirm:function(){i.data.redirect&&(document.location.href=i.data.redirect)}}):Cargo.Modal.Alert({message:"There was a problem submitting. Refresh and try again."}),$("[data-example-start]").html("Choose Style")}),e=e||Cargo.Model.Site.GetId(),i.set({template_id:e}),i.save()})}},Cargo.Event=Cargo.Event||{},_.extend(Cargo.Event,Backbone.Events),Cargo.Event.on("add_history",function(e,t){Cargo.Router.is_first_route=!1,(e=Cargo.Helper.NormalizeRouteLink(e))!==Cargo.Helper.GetCurrentProjectUrl()?(Cargo.Helper.IsCurrentRoute(e)?Cargo.Model.DisplayOptions.GetDisableProjectScroll()||Cargo.Helper.ScrollToTop():(t=t||Cargo.Helper.GetPidFromPurl(e),"admin"==e||/^following/.test(e)||/^cart/.test(e)||Cargo.Helper.ShowLoadingAnimation(t,e)),(!/^following/.test(Cargo.Router.previousRoute)&&!/^following/.test(Backbone.history.getFragment())&&/^following/.test(e)||!/^contact-form/.test(Cargo.Router.previousRoute)&&!/^contact-form/.test(Backbone.history.getFragment())&&/^contact-form/.test(e)||!/^cart/.test(Cargo.Router.previousRoute)&&!/^cart/.test(Backbone.history.getFragment())&&/^cart/.test(e))&&(Cargo.Router.previousSiteRoute=Backbone.history.getFragment()),Cargo.Router.previousRoute=Backbone.history.getFragment(),Cargo.Router.navigate(e,{trigger:!0})):Cargo.Model.DisplayOptions.GetDisableProjectScroll()||Cargo.Helper.ScrollToTop()}),Cargo.Event.on("add_history_passive",function(e){e=Cargo.Helper.NormalizeRouteLink(e),Cargo.Router.navigate(e,{trigger:!1,replace:!0})}),Cargo.Event.on("admin_page_update",function(e,t){}),Cargo.Event.on("BaseUnit:set",function(e){var t=Cargo.Helper.IsMobileWindowSize(e.cache.window.w);Cargo.Event.trigger("mobile_size",t)}),Cargo.Event.on("custom_route_loaded",function(e){}),Cargo.Event.on("content_view_closed",function(){}),Cargo.Event.on("first_page_collection_reset",function(){Cargo.API.Config.first_load_finished=!0}),Cargo.Event.on("hide_loading_anim",function(){"object"==typeof Cargo.Helper&&Cargo.Helper.HideLoadingAnimation&&Cargo.Helper.HideLoadingAnimation()}),Cargo.Event.on("homepage_loaded",function(){Cargo.Model.DisplayOptions.GetDisableProjectScroll()||Cargo.Helper.ScrollToTop(),Cargo.View.Main&&(Cargo.View.Main.SetHomepageClass(),Cargo.View.Main.SetFeedClass())}),Cargo.Event.on("loading_anims_replaced",function(){}),Cargo.Event.on("mobile_size",function(e){}),Cargo.Event.on("mobile_padding_set",function(){}),Cargo.Event.on("plugin_render",function(e){e.el.style.opacity=0,e.el.style.transition="opacity .5s ease-in-out",e.el.style.webkitTransition="opacity .5s ease-in-out",void 0===e.deferredLoadEventName?setTimeout(function(){e.el.style.opacity=1},33):Cargo.Event.once(e.deferredLoadEventName,function(){e.el.style.opacity=1})}),Cargo.Event.on("page_change",function(){}),Cargo.Event.on("page_collection_reset",function(){}),Cargo.Event.on("page_load_complete",function(e){Cargo.Event.PageTransition=new $.Deferred,Cargo.View.Main&&!Cargo.Helper.IsOnHomepage()?(Cargo.View.Main.RemoveHomepageClass(),Cargo.View.Main.RemoveFeedClass()):null!==Cargo.View.Content.activeContentModel&&Cargo.View.Content.activeContentModel.get("id")!==Cargo.Helper.GetHomepageId()&&(Cargo.View.Main.RemoveHomepageClass(),Cargo.View.Main.RemoveFeedClass()),Cargo.Helper.HideLoadingAnimation(),Cargo.View.Main.SetWindowTitle(),Cargo.Event.trigger("project_load_complete",e)}),Cargo.Event.on("content_load_complete",function(e){Cargo.View.Main&&!Cargo.Helper.IsOnHomepage()?Cargo.View.Main.RemoveHomepageClass():null!==Cargo.View.Content.activeContentModel&&Cargo.View.Content.activeContentModel.get("id")!==Cargo.Helper.GetHomepageId()&&Cargo.View.Main.RemoveHomepageClass(),Cargo.Model.DisplayOptions.GetDisableProjectScroll()||Cargo.Helper.ScrollToTop(),Cargo.View.Main.SetPageId(e),Cargo.API.Config.is_direct_link||Cargo.Helper.IsOnHomepage()||Cargo.Analytics.pageview(!0),Cargo.Helper.HideLoadingAnimation()}),Cargo.Event.on("set_render_complete",function(e){}),Cargo.Event.on("image_gallery_init_complete",function(e){}),Cargo.Event.on("image_gallery_render_complete",function(e){}),Cargo.Event.on("image_upload_complete",function(e){}),Cargo.Event.on("image_delete_complete",function(e){}),Cargo.Event.on("pagination_complete",function(e,t,i){i&&i.render_changes&&($(window).trigger("resize"),Cargo.Plugins.elementResizer.update())}),Cargo.Event.on("page_load_start",function(e){Cargo.Event.trigger("page_change")}),Cargo.Event.on("project_load_start",function(e){Cargo.Event.trigger("page_load_start",e)}),Cargo.Event.on("reseed_pages_complete",function(e){}),Cargo.Event.on("show_index_complete",function(e){Cargo.View.Main.SetWindowTitle(!0),Cargo.Event.IndexTransition=new $.Deferred}),Cargo.Event.on("show_index_start",function(e){Cargo.Event.trigger("page_change")}),Cargo.Event.on("show_loading_anim",function(){Cargo.Helper.ShowLoadingAnimation(null,"page")}),Cargo.Event.on("solo_link_loaded",function(e){}),Cargo.Event.on("template_loaded",function(e){}),Cargo.Event.PageTransition=new $.Deferred,Cargo.Event.IndexTransition=new $.Deferred,Cargo.Event.ShowPageTransition=function(e,t,i){return Cargo.Event.PageTransition.resolve(),Cargo.Event.PageTransition.promise()},Cargo.Event.ShowIndexTransition=function(e,t){return Cargo.Event.IndexTransition.resolve(),Cargo.Event.IndexTransition.promise()},window.addEventListener("popstate",function(){"object"==typeof lightbox&&void 0!==lightbox.activeGallery&&lightbox.activeGallery.close()}),Cargo.o.helpers=Backbone.View.extend({Data:{is_loading:!1,loading_timout:1e3,projectlist_volatile:!1},initialize:function(){Cargo.Event.on("adminlist_volatile",function(){this.Data.projectlist_volatile=!0},this),Cargo.Event.on("adminlist_stable",function(){this.Data.projectlist_volatile=!1},this)},FindCollectionByProjectUrl:function(e){var t=!1;return _.each(Cargo.Collection.Page,function(i){if(!t){var n=new Backbone.Collection;n.reset(i),n.where({project_url:e})[0]&&(t=i)}}),t},GetBackboneCaseInsensitive:function(e,t){var i={};for(var n in e)!e.hasOwnProperty(n)||"function"!=typeof e[n]&&"object"!=typeof e[n]||(i[n.toLowerCase()]=n);return t?i[t.toLowerCase()]:""},GetBaseUrl:function(e,t){if(Cargo.API.Config.is_domain)return t?"/":"";var i=e?Cargo.API.Config.cargo_url:"";return t?"/"+i:i},IsAdminProjectListSorting:function(){return this.Data.projectlist_volatile},GetBaseCargoDomain:function(){var e=Cargo.Model.Site.get("home_url");return e?e.replace(/(http(s)?:\/\/)/,""):document.location.host},GetAuthDomain:function(){var e=Cargo.Model.Site.get("auth_url");return e||"//"+document.location.host},GetBaseDomain:function(){return Cargo.Model.Site.get("home_url").replace(/(http(s)?:\/\/)/,"")},IsIndexableModel:function(e){return!(!e||"set"!==e.attributes.type)||!!e&&!(!1===e.attributes.display||e.attributes.pin||e.attributes.is_homepage&&!e.attributes.is_set)},GetCurrentProjectUrl:function(){var e=Cargo.View.Content.getActiveContentModel();return e?e.get("project_url"):null},GetCurrentProjectId:function(){if(void 0===Cargo.View.Content)return null;var e=Cargo.View.Content.getActiveContentModel();return e?e.get("id"):null},GetCurrentRoute:function(){return Backbone.history.fragment},GetDomainOrUrl:function(){return Cargo.API.Config.is_domain?this.GetUrl():location.pathname.split("/")[1]},GetHomeUrl:function(e,t){var i=t?"/":"";return Cargo.API.Config.set&&Cargo.API.Config.filter?Cargo.API.Config.is_domain?i+Cargo.API.Config.set+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):this.GetBaseUrl(e,t)+"/"+Cargo.API.Config.set+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):Cargo.API.Config.route&&Cargo.API.Config.filter?Cargo.API.Config.is_domain?Cargo.Helper.GetRouteUrl()+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):this.GetBaseUrl(e,!1)+Cargo.Helper.GetRouteUrl()+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):Cargo.API.Config.filter?Cargo.API.Config.is_domain?i+"filter/"+encodeURIComponent(Cargo.API.Config.filter):this.GetBaseUrl(e,t)+"/filter/"+encodeURIComponent(Cargo.API.Config.filter):Cargo.API.Config.set?Cargo.API.Config.is_domain?i+Cargo.API.Config.set:this.GetBaseUrl(e,t)+"/"+Cargo.API.Config.set:Cargo.API.Config.route&&Cargo.API.Config.is_domain?Cargo.Helper.GetRouteUrl():this.GetBaseUrl(e,t)},GetOffsetFromPage:function(e){return--e*this.GetPageLimit()},GetPageLimit:function(){var e=Cargo.Model.DisplayOptions.GetPaginationCount();return e&&Cargo.Model.DisplayOptions.GetIndexRouteName()&&Cargo.Model.DisplayOptions.GetIndexRouteName().toUpperCase()==Cargo.Helper.GetRouteName().toUpperCase()&&Cargo.Model.DisplayOptions.get("index_pagination_count")?e=Cargo.Model.DisplayOptions.get("index_pagination_count"):Cargo.Model.DisplayOptions.get("mobile_pagination_count")&&this.isMobile()&&(e=Cargo.Model.DisplayOptions.get("mobile_pagination_count")),e||10},IsMobileWindowSize:function(e){return e<this.GetMobileWindowBreakPoint()},GetMobileWindowBreakPoint:function(e){return 770},GetPageViewById:function(e){var t;return void 0===t&&Cargo.View.Content&&(t=Cargo.View.Content.getPageViewById(e)),void 0===t&&Cargo.View.PinnedTop&&(t=Cargo.View.PinnedTop.getPageViewById(e)),void 0===t&&Cargo.View.PinnedBottom&&(t=Cargo.View.PinnedBottom.getPageViewById(e)),t},GetPidFromPurl:function(e){var t=Cargo.Collection.Scaffolding.getModel({project_url:e});return t?t.get("id"):0},GetRouteName:function(){var e=Cargo.API.Config.route_name;return/display_options/.test(Cargo.API.Config.route)&&(e=Cargo.Model.DisplayOptions.GetIndexRouteName()),e},GetRouteUrl:function(){var e=Cargo.API.Config.route_name;return(/display_options/.test(Cargo.API.Config.route)||"feed"==e||"index"==e)&&(e=Cargo.Model.DisplayOptions.GetIndexRouteUrl()),e},GetHomepageId:function(){return Math.floor(Cargo.Model.Site.GetHomepageId())},GetUrl:function(){return Cargo.API.Config.cargo_url},GoToUrl:function(e){top.document.location.href=document.location.origin+"/"+e},HideLoadingAnimation:function(e){this.ClearLoadingAnimationTimeout(),this.Data.is_loading=!1,$("[data-loading]").hide()},IsAdminEdit:function(){var e=/\/adminedit/.test(document.location.pathname)||/\/admin/.test(document.location.pathname);try{var t=parent!=window&&"object"==typeof parent.Cargo,i=null!=Cargo.Editor;return e||t||i}catch(e){return!1}},IsAdminBackdrop:function(){return/\/adminbackdrop/.test(document.location.pathname)},IsStandaloneAdmin:function(){return!!(Cargo&&Cargo.Editor&&Cargo.Editor.hasOwnProperty("Standalone"))},IsCurrentRoute:function(e){return e=this.NormalizeRouteLink(e),Cargo.Helper.GetCurrentRoute()==e},isFeed:function(){return Cargo.Model.DisplayOptions.get("layout_options").is_feed},isFirefox:function(){return/Firefox\/\d+\.\d+/.test(navigator.userAgent)},isSafari:function(){return-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")},isIE:function(){return/MSIE (\d+\.\d+);/.test(navigator.userAgent)},isEdge:function(){return/Edge/.test(navigator.userAgent)},isIE8:function(){var e=-1;this.isIE()&&(null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)&&(e=parseFloat(RegExp.$1)));return e<9&&e>0},isIOS:function(){return!!navigator.userAgent.match(/i(Phone|Pod|Pad)/i)},isMobile:function(){if(this.isIOS())return!0;var e,t=!1,i=navigator.userAgent||navigator.vendor||window.opera;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e=i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t=t||!t&&/(android)/i.test(i.substr(0,40))},isIOSWebView:function(){var e=window.navigator.standalone,t=window.navigator.userAgent.toLowerCase(),i=/safari/.test(t);if(/iphone|ipod|ipad/.test(t)){if(!e&&i)return!1;if(e&&!i)return!1;if(!e&&!i)return!0}return!1},IsOnHomepage:function(){return(""==Cargo.Helper.GetCurrentRoute()||"adminedit"==Cargo.Helper.GetCurrentRoute())&&null!=Cargo.Helper.GetHomepageId()},isOldIE:function(){var e=-1;this.isIE()&&(null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)&&(e=parseFloat(RegExp.$1)));return e<=9&&e>0},IsAdminPath:function(){return/\/admin(\/|$)/.test(document.location.pathname)},IsPresetPreview:function(){return/\/presetpreview(\/|$)/.test(document.location.pathname)},IsCurrentRoute:function(e){return e=e.replace("/",""),this.GetCurrentRoute()&&e&&this.GetCurrentRoute().toLowerCase()==e.toLowerCase()},isTablet:function(){return"string"==typeof new MobileDetect(window.navigator.userAgent).tablet()},NormalizeRouteLink:function(e){if(!e)return e;-1!==e.indexOf(Cargo.Helper.GetBaseDomain())&&(e=e.split(Cargo.Helper.GetBaseDomain())[1]),"/"==e.charAt(0)&&(e=e.replace("/","")),!/following/.test(e)&&this.GetHomeUrl(!0)&&0==e.search(this.GetHomeUrl(!0))&&(e=e.replace(this.GetHomeUrl(!0)+"/","")),"/"==e.charAt(e.length-1)&&(e=e.substr(0,e.length-1));var t=Cargo.Collection.Scaffolding.getModel({project_url:e});return void 0!==t&&t.get("id")==Cargo.Helper.GetHomepageId()&&(e=""),e},ScrollToTop:function(){var e=Cargo.Router.scrollPositions[Backbone.history.getFragment()];requestAnimationFrame(function(){window.scrollTo(0,e)})},ShowLoadingAnimation:function(e,t){this.Data.is_loading=!0,e?this.Data.loadingAnimationTimeoutID=_.delay(function(){Cargo.Helper.ShowLoadingAnimationById(e)},Cargo.Helper.Data.loading_timout):t&&(this.Data.loadingAnimationTimeoutID=_.delay(function(){Cargo.Helper.ShowLoadingAnimationById("page")},Cargo.Helper.Data.loading_timout)),$("*[data-loading=global], *[data-loading=global] .retinaSpinner").show()},ClearLoadingAnimationTimeout:function(){window.clearTimeout(this.Data.loadingAnimationTimeoutID)},ShowLoadingAnimationById:function(e){this.Data.is_loading&&$("*[data-loading="+e+"], *[data-loading="+e+"] .retinaSpinner").show()},TestUrlCaseAndRedirect:function(){if(!Cargo.API.Config.is_domain){var e=document.location.pathname.split("/")[1],t=Cargo.API.Config.cargo_url;e!=t&&e.toUpperCase()==t.toUpperCase()&&history.replaceState(document.location.pathname.replace(e,t),Cargo.Model.Site.GetWebsiteTitle())}},UpdatePinPages:function(e){"top"==e?Cargo.View.PinnedTop.formatOverlayPages():"bottom"==e?Cargo.View.PinnedBottom.formatOverlayPages():(Cargo.View.PinnedTop.formatOverlayPages(),Cargo.View.PinnedBottom.formatOverlayPages())},htmlDecode:function(e){var t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue}}),Cargo.o.router=Backbone.Router.extend({routes:{"":"Home",adminedit:"Home",cart:"Cart","contact-form":"Contact","preview/:which":"Home","search/:query":"Search",":purl/adminedit":"AdminEdit",":purl":"slashProxy",":purl1/:purl2":"slashProxy",":purl1/:purl2/:purl3":"slashProxy","*actions":"defaultAction"},is_first_route:!0,defaultAction:function(e){this.route(e)},preventQueryStringRemoval:!1,initialize:function(){document.location.search&&"?example=true"!=document.location.search&&(this.handleQueryString(document.location.search),this.preventQueryStringRemoval||window.history.replaceState({},document.title,document.location.href.replace(document.location.search,""))),this._lastFrag=null,this.scrollPositions={}},handleQueryString:function(e){if("string"==typeof e){var t=["fontsinuse","wetransfer","wepresent","sightunseen","carbon","NYABF2018"],i=t.indexOf(e.substring(1));-1!==i&&setTimeout(function(){Cargo.Analytics.setDimension("dimension5",t[i])}),this.queryString=e}},execute:function(e,t,i){null!==this._lastFrag&&document.scrollingElement&&(this.scrollPositions[this._lastFrag]=document.scrollingElement.scrollTop),this._lastFrag=Backbone.history.getFragment(),Backbone.Router.prototype.execute.apply(this,arguments)},navigate:function(e){this.scrollPositions.hasOwnProperty(e)&&delete this.scrollPositions[e],Backbone.Router.prototype.navigate.apply(this,arguments)},slashProxy:function(e,t,i){if(this.RouteIsHome(e))this.Home(e);else if(/\,|\~|\+/.test(e)&&!/\?/.test(e))Cargo.Event.trigger("thumbnails:load_tag",e),t?this.Page(t):Cargo.View.Content.hideActiveView();else if(/\,|\~\+/.test(t)){Cargo.Event.trigger("thumbnails:load_tag",t,e);var n=i||e;this.Page(n)}else if(e&&t&&!i){var o=Cargo.Collection.Tags.findTagByUrl(e),a=Cargo.Collection.Tags.findTagByUrl(t);o?(Cargo.Event.trigger("thumbnails:load_tag",o.get("url")),this.Page(t)):a&&(Cargo.Event.trigger("thumbnails:load_tag",a.get("url"),e),Cargo.View.Content.hideActiveView())}else this.Page(e)},Home:function(e){this.CheckToggleFollowing(),e||(e=""),Cargo.Event.trigger("before_purl_render",e),0!==Cargo.Helper.GetHomepageId()||Cargo.Helper.isFeed()?(Cargo.View.Content.RenderHomepage(),Cargo.View.Main&&(Cargo.View.Main.SetHomepageClass(),Cargo.View.Main.SetFeedClass())):Cargo.API.Config.offline?(Cargo.Event.trigger("page_load_complete"),Cargo.Event.trigger("content_load_complete")):(Cargo.View.Content.hideActiveView(),Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId()))},Following:function(){},FollowedBy:function(){},Contact:function(){Cargo.View.Following.loadSection("contact")},Cart:function(){Cargo.View.Following.loadSection("cart",!0)},Page:function(e){Cargo.Event.trigger("before_purl_render",e),this.CheckToggleFollowing(),e=(e+="").replace(/\//g,""),Cargo.View.Content.RenderPidOrPurl(e)},Search:function(e){this.Home()},AdminEdit:function(e){return this.CheckToggleFollowing(),Cargo.API.Config.admin_edit_project=!0,this.Page(e)},CheckToggleFollowing:function(){!0===Cargo.View.Following.isActive()&&Cargo.View.Following.disable()},_routeToRegExp:function(e){return e=e.replace(/[-{}[\]+?.,\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/:\w+/g,"([^/]+/?)").replace(/\*\w+/g,"(.*?)"),new RegExp("^"+e+"$","i")},addroute:function(e,t,i){for(var n=["","/","?*querystring","/?*querystring"],o=0;o<n.length;o++){var a=n[o];this.route(e+a,t,i)}},RouteIsHome:function(e){var t=!1;return Cargo.API.Config.is_domain||e.toLowerCase()!=Cargo.Helper.GetDomainOrUrl().toLowerCase()||document.location.pathname.replace("/").split("/").length<=1&&(t=!0),t}}),Cargo.o.templates=Backbone.View.extend({Data:{},Get:function(e,t){var i=Cargo.Helper.GetBackboneCaseInsensitive(this.Data,e);if(i=i||e,this.Data[i]&&this.Data[i].template)return this.Data[i].template;this.Load(i,t)},Add:function(e,t,i){Cargo.Template.Data[e]={dataset:t,setname:i}},FindAndAddViewStubs:function(){$("[data-view]").each(function(){var e=$(this).data("view"),t=$(this).data("set"),i=new Backbone.Collection;if(t){var n=Cargo.Helper.GetBackboneCaseInsensitive(Cargo.Collection,t),o=Cargo.Helper.GetBackboneCaseInsensitive(Cargo.Model,t);n?i=Cargo.Collection[n]:o&&(i=Cargo.Model[o])}Cargo.Template.Add(e,i,t)})},Load:function(which,file_path){if(!file_path){var file_name=which;file_path=Cargo.API.GetDesignAndFile(file_name,!1)}Cargo.Template.Data[which]&&Cargo.Template.Data[which].loading||(Cargo.Template.Data[which]||(Cargo.Template.Data[which]={}),Cargo.Template.Data[which].loading=!0,Cargo.Event.trigger("template_preload",which),$.loadFiles(file_path).done(function(template){if(template){try{var template=eval(template)}catch(e){}Cargo.Template.Data[which].template=template}else{var template_var="templatesdesign"+file_name.replace(/(\/|\.)/g,"");Cargo.Template.Data[which].template=window[template_var]}return Cargo.Event.trigger("template_loaded",which),Cargo.Template.Data[which].template}))},LoadAll:function(){for(key in this.Data)void 0===this.Data[key].template&&this.Load(key)},LoadFoundViews:function(){for(key in this.Data){var e=0==key.indexOf("pinned")?"Pin":key,t=Cargo.Helper.GetBackboneCaseInsensitive(Cargo.o.view,e);if("function"==typeof Cargo.o.view[t]&&void 0===Cargo.View[t]){var i=0==key.indexOf("pinned")?key.toCamel(!0):t.toCamel(!0);if(void 0===Cargo.View[i]){var n=this;$("[data-view='"+key+"']").each(function(e){i=e>0?t+"_"+e:i,Cargo.View[i]=new Cargo.o.view[t]({el:this,collection:n.Data[key].dataset,template:n.Data[key].template,className:i}),null==n.Data[key].template&&Cargo.View[i].template&&(n.Data[key].template=Cargo.View[i].template)})}}else null==this.Data[key].template&&Cargo.View[t]&&void 0!==Cargo.View[t].template&&(this.Data[key].template=Cargo.View[t].template)}}}),Cargo.o.model.StripeProductModel=Backbone.Model.extend({initialize:function(){},parse:function(e,t){return e.is_file=!1,e&&e.attributes&&-1!==e.attributes.indexOf("link_to_file")&&(e.is_file=!0,e.attributes=[],e.skus.total_count>1&&e.attributes.push("description")),e&&e.skus&&e.skus.data&&_.each(e.skus.data,function(t){e.is_file&&e.skus.total_count>1&&"object"==typeof t.attributes&&0===_.keys(t.attributes).length&&(t.attributes.description=e.name+" - "+Cargo.o.view.ProductWidget.prototype.formatPriceForCurrency(t.price,t.currency)),t.is_file=e.is_file}),e},getSku:function(e){if(null!=this.attributes.skus)return _.findWhere(this.attributes.skus.data,{id:e})},getAvailableItemsForSKU:function(e){if(e){if(!1===e.active)return 0;if("finite"===e.inventory.type&&e.inventory.quantity>0)return e.inventory.quantity;if("infinite"===e.inventory.type)return 9e9;if("bucket"===e.inventory.type&&("in_stock"===e.inventory.value||"limited"===e.inventory.value))return 9e9}return 0}}),Cargo.o.collection.StripeProductCollection=Backbone.Collection.extend({model:Cargo.o.model.StripeProductModel,productSyncOccurred:!1,initialize:function(){this.cart_count=0,Cargo.Event.on("cart-size-changed",function(e){this.cart_count=e,Cargo.Core.Ecommerce.updateCartText(),Cargo.Core.Ecommerce.updateInlineCartCounters()},this),this.on("sync",function(){var e=[],t=localStorage.getItem("cargo_ecommerce_cart");if(null!==t&&t.length>0)try{e=JSON.parse(t)}catch(e){console.error(e)}_.each(e,function(e){e.available=!1;var t,i=this.findWhere({id:e.productID});i&&(t=i.getSku(e.skuID))&&(this.cart_count+=Math.min(e.amount,i.getAvailableItemsForSKU(t)))},this),Cargo.Core.Ecommerce.updateCartText(),Cargo.Core.Ecommerce.updateInlineCartCounters()}),Cargo.Event.on("stripe_account_connected stripe_account_disconnected",this.fetch,this)},parse:function(e){return _.filter(e,function(e){return e.active})},url:function(){return"/_api/v0/ecommerce/products/"+Cargo.Model.Site.get("id")},updateCartText:function(){return Cargo.Core.Ecommerce.updateCartText.apply(Cargo.Core.Ecommerce,arguments)}}),Cargo.Core.PageviewFactory={pageViewTypes:[],constructPageView:function(){var e,t=Cargo.o.view.Page;for(e=0;e<this.pageViewTypes.length;e++)if(!0===this.pageViewTypes[e].filter.apply(this,arguments)){t=this.pageViewTypes[e].constructor;break}return new(Function.prototype.bind.apply(t,[].concat.apply([null],arguments)))},addPageViewType:function(e,t){t.constructor=function(){this.__super__=Object.getPrototypeOf(Object.getPrototypeOf(this)),Backbone.View.prototype.constructor.apply(this,arguments)},this.pageViewTypes.push({filter:e,constructor:Cargo.o.view.Page.extend(t)})}},Cargo.Core.SetViewFactory={setViewTypes:[],constructSetView:function(){var e,t=Cargo.o.view.Set;for(e=0;e<this.setViewTypes.length;e++)if(!0===this.setViewTypes[e].filter.apply(this,arguments)){t=this.setViewTypes[e].constructor;break}return new(Function.prototype.bind.apply(t,[].concat.apply([null],arguments)))},addSetViewType:function(e,t){t.constructor=function(){this.__super__=Object.getPrototypeOf(Object.getPrototypeOf(this)),Backbone.View.prototype.constructor.apply(this,arguments)},this.setViewTypes.push({filter:e,constructor:Cargo.o.view.Set.extend(t)})}},Cargo.Core.ImageGallery={draggingOverGallery:!1,draggingInEditor:!1,idIndex:0,imageGalleryObjects:{},cachedScrollPosition:-1,imageGalleryModes:{},allModesLoaded:!1,galleryLoadInProgress:!1,currentEditableGallery:void 0,cachedPaddingSizes:{0:{fontSize:0,paddingMeasure:0}},setCachedPaddingSize:function(e,t,i){if(0!==i){var n=Math.floor(10*parseFloat(e))/10;t/=i,this.cachedPaddingSizes[n]={fontSize:e,paddingMeasure:t}}},getCachedPaddingSize:function(e,t){if(t>0){var i=Math.floor(10*parseFloat(e))/10;return this.cachedPaddingSizes.hasOwnProperty(i)?this.cachedPaddingSizes[i].paddingMeasure*parseFloat(t):null}return 0},loadGalleryModes:function(){var e=this;!Cargo.Helper.IsAdminEdit()||this.allModesLoaded||this.galleryLoadInProgress||void 0!==Cargo.Homepage&&parent===window||(this.galleryLoadInProgress=!0,require(["/_jsapps/imagegallery/columns/main.js?nocache=18-11-26","/_jsapps/imagegallery/freeform/main.js?nocache=18-11-26","/_jsapps/imagegallery/grid/main.js?nocache=18-11-26","/_jsapps/imagegallery/justify/main.js?nocache=18-11-26","/_jsapps/imagegallery/montessori/main.js?nocache=18-11-26","/_jsapps/imagegallery/slideshow/main.js?nocache=18-11-26"],function(t,i,n,o,a,r){e.imageGalleryModes={columns:t,freeform:i,grid:n,justify:o,montessori:a,slideshow:r},e.allModesLoaded=!0,e.galleryLoadInProgress=!1,e.InitImageGallery()}))},addEditorEvents:function(){"undefined"!=typeof CargoEditor&&CargoEditor.events&&_.each(this.editorEvents,function(e,t){this.boundEditorEvents.push(CargoEditor.events.on(t,_.bind(e,this)))},this)},initialize:function(){this.boundEditorEvents=[],this.addEditorEvents(),Cargo.Event.on("gallery-drag-end",function(e,t){var i=$('.image-gallery[gid="'+t+'"] [data-gallery-uid="'+e+'"]')[0];i&&Cargo.Core.ImageGallery.normalizeSelection(void 0,i)},this),this.InitImageGallery()},galleryDefaults:function(){return{name:"Columns",path:"columns",mode_id:2,gallery_instance_id:0,data:{column_size:10,columns:3,image_padding:2,responsive:!0,mobile_data:{columns:2,column_size:11,image_padding:1,separate_mobile_view:!1},meta_data:{}}}},init_options_defaults:{forceReCollectionOfItems:!1,targetElement:!1},parseGalleryOptions:function(e){for(var t=decodeURIComponent(e),i=0;"{"!==t[0]&&i<3;)t=decodeURIComponent(t),i++;return"{"!==t[0]?this.galleryDefaults():JSON.parse(t)},InitImageGallery:function(e){var t=this;if(!Cargo.Helper.IsAdminEdit()||this.allModesLoaded){if(e||(e={}),!(e=_.defaults(e,this.init_options_defaults)).targetElement||jQuery.contains(document.documentElement,e.targetElement)){var i=[],n=[];(e.targetElement?$(e.targetElement).find(".image-gallery[gid-clone]"):$(".image-gallery[gid-clone]")).remove();var o=e.targetElement?$(e.targetElement).find(".image-gallery[gid]"):$(".image-gallery[gid]"),a=e.targetElement?$(e.targetElement).find(".image-gallery").not(".initialized, .initialization-in-progress").length:$(".image-gallery").not(".initialized, .initialization-in-progress").length;o.each(function(){var e=this.getAttribute("gid");-1==n.indexOf(e)?n.push(e):(this.removeAttribute("gid"),this.setAttribute("gid-clone",e))}),(e.targetElement?$(e.targetElement).find(".image-gallery"):$(".image-gallery")).each(function(){if($(this.parentNode).closest(".image-gallery").length>0)this.parentNode.removeChild(this);else if(Cargo.Helper.IsAdminEdit()&&this.setAttribute("contenteditable",!1),!1===$(this).hasClass("initialized")&&!1===$(this).hasClass("initialization-in-progress")){$(this).addClass("initialization-in-progress"),i.push(parseInt($(this).closest(".page").attr("data-id"))),this.hasAttribute("data-gallery")&&this.setAttribute("data-gallery",JSON.stringify(Cargo.Core.ImageGallery.parseGalleryOptions(this.getAttribute("data-gallery"))));var n,o=this.hasAttribute("gid")&&t.imageGalleryObjects.hasOwnProperty(this.getAttribute("gid"));this.hasAttribute("data-force-gid")&&this.hasAttribute("gid")?(n=this.getAttribute("gid"),this.removeAttribute("data-force-gid")):n=o?this.getAttribute("gid"):++t.idIndex,this.setAttribute("gid",n);var r={};if(o)t.imageGalleryObjects[n].el=this,(r=t.imageGalleryObjects[this.getAttribute("gid")]).subviewInited=!1,r.mobileSubviewInited=!1,r.subviewActive=!1,r.mobileSubviewActive=!1,e.forceReCollectionOfItems&&(r.images=null,r.removeViews(),r.checkMobileAndLoadSubview()),t.imageGalleryObjects[n].storeOptionsOnElement();else{if(r={options:Cargo.Core.ImageGallery.galleryDefaults(n),el:this,images:null,isEditing:!1,hasClick:!1,isEditable:!1,MobileSubview:null,mobileSubviewInitInProgress:!1,mobileSubviewInited:!1,mobileSubviewActive:!1,Subview:null,subviewInitInProgress:!1,subviewInited:!1,inited:!1,bindEvents:function(){var e=this;Cargo.Helper.IsAdminEdit()&&($(this.el).on("mousedown.gallery",function(){e.hasClick=!0}),$(this.el).on("mouseup.gallery mouseleave.gallery",function(){e.hasClick=!1}),this.enableEditable=_.bind(this.enableEditable,this),this.checkIfStillEditable=_.bind(this.checkIfStillEditable,this),$(this.el).on("mousedown.editable",this.enableEditable),$(this.el).on("mouseup.editable mouseleave.editable",this.checkIfStillEditable),CargoEditor.events.on("editor-drop",this.checkIfStillEditable),CargoEditor.events.on("cursor-activity",this.checkIfStillEditable),CargoEditor.events.on("editor-deactivated",this.checkIfStillEditable)),Cargo.Event.on("mobile_size",this.requestTick,this)},unbindEvents:function(){$(this.el).off("mousedown.gallery mouseup.gallery mouseleave.gallery mousedown.editable mouseup.editable mouseleave.editable"),Cargo.Event.off("mobile_size",this.requestTick),Cargo.Helper.IsAdminEdit()&&(CargoEditor.events.off("editor-drop",this.checkIfStillEditable),CargoEditor.events.off("cursor-activity",this.checkIfStillEditable),CargoEditor.events.off("editor-deactivated",this.checkIfStillEditable))},enableEditable:function(){!0!==this.isEditable&&(Cargo.Core.ImageGallery.currentEditableGallery&&Cargo.Core.ImageGallery.currentEditableGallery.disableEditable(),this.el.removeAttribute("contenteditable"),this.isEditable=!0,Cargo.Core.ImageGallery.currentEditableGallery=this,Cargo.Event.trigger("gallery_editing_enabled",this))},disableEditable:function(){!1!==this.isEditable&&(this.el.setAttribute("contenteditable",!1),this.isEditable=!1,Cargo.Event.trigger("gallery_editing_disabled",this),Cargo.Core.ImageGallery.currentEditableGallery&&Cargo.Core.ImageGallery.currentEditableGallery.options.gallery_instance_id==this.options.gallery_instance_id&&(Cargo.Core.ImageGallery.currentEditableGallery=void 0))},checkIfStillEditable:function(e){if(!1!==this.isEditable){var t=CargoEditor.getActiveRange(),i=!1;if(t){var n=t.commonAncestorContainer;n.nodeType!==Node.ELEMENT_NODE&&(n=n.parentNode),i=this.el.contains(n)}i||this.disableEditable()}},setEditMode:function(e){e&&!this.isEditing?$(window).on("scroll.imagegalleryEdit",function(){r.cachedRects.needsUpdate=!0}):!e&&this.isEditing&&$(window).off("scroll.imagegalleryEdit"),this.isEditing=e},setElement:function(e){this.el=e,this.Subview&&this.Subview.setElement(this.el),this.MobileSubview&&this.MobileSubview.setElement(this.el)},checkMobileAndLoadSubview:function(){var e=window.baseUnit.cache.window.w?window.baseUnit.cache.window.w:document.documentElement.clientWidth,t=Cargo.Helper.IsMobileWindowSize(e),i=this.options.data.mobile_data.separate_mobile_view,n=this.options.data.responsive,o=this.mobileSubviewActive,a=this.mobileSubviewInitInProgress,r=this.mobileSubviewInited,s=this.subviewInited,l=this.subviewInitInProgress;t&&i&&!o&&n?a||(r&&this.MobileSubview.galleryOptions.data.mobile_design_path==this.options.data.mobile_data.mobile_design_path?(this.MobileSubview.render(),this.cachedRects.needsUpdate=!0,this.mobileSubviewActive=!0):this.loadMobileSubview(),this.cachedRects.needsUpdate=!0):t&&i&&n||l||(!s||this.Subview&&this.Subview.galleryOptions.path!=this.options.path?this.loadSubview():o&&(this.Subview.render(),this.cachedRects.needsUpdate=!0,this.mobileSubviewActive=!1),this.cachedRects.needsUpdate=!0)},loadSubview:function(){var e=this;if(this.Subview&&this.subviewInited&&(this.Subview.destroy(),this.subviewInited=!1),this.subviewInitInProgress=!0,Cargo.Core.ImageGallery.imageGalleryModes.hasOwnProperty(this.options.path)){var t=Cargo.Core.ImageGallery.imageGalleryModes[this.options.path];_.defer(function(){e.finishSubviewSetup(t)})}else require(["/_jsapps/imagegallery/"+this.options.path+"/main.js?nocache="+__cargo_js_ver__],function(t){Cargo.Core.ImageGallery.imageGalleryModes[e.options.path]=t,e.finishSubviewSetup(t)})},finishSubviewSetup:function(e){var n=window.baseUnit.cache.window.w?window.baseUnit.cache.window.w:document.documentElement.clientWidth,o=Cargo.Helper.IsMobileWindowSize(n),r=new e({el:this.el,galleryOptions:Object.assign({},this.options),parentView:this,mobile_active:o}),s=!t.inited;if(this.Subview=r,this.images||(this.images=this.Subview.serialize()),(_.keys(this.images).length<2&&!Cargo.Core.ImageGallery.draggingInEditor||0==_.keys(this.images).length)&&this.destroy(),$(this.el).removeClass("initialization-in-progress"),this.mobileSubviewActive=!1,this.unbindEvents(),this.Subview.render(),this.cachedRects.needsUpdate=!0,this.subviewInited=!0,this.subviewInitInProgress=!1,this.inited=!0,this.lastSerializedState=this.Subview.serialize(),this.bindEvents(),this.isEditing||this.hasClick)if(-1==Cargo.Core.ImageGallery.cachedScrollPosition){var l=this.el.getBoundingClientRect();(l.top>window.innerHeight-30||l.bottom<30)&&window.scrollTo(0,l.top+$(window).scrollTop())}else window.scrollTo(0,Cargo.Core.ImageGallery.cachedScrollPosition);s&&(Cargo.Event.trigger("image_gallery_render_complete",this),0==--a&&Cargo.Event.trigger("image_gallery_init_complete",i))},loadMobileSubview:function(){var e=this;this.MobileSubview&&this.mobileSubviewInited&&(this.MobileSubview.destroy(),this.mobileSubviewInited=!1),this.options.data.mobile_data.separate_mobile_view&&(this.mobileSubviewInitInProgress=!0,Cargo.Core.ImageGallery.imageGalleryModes.hasOwnProperty(this.options.data.mobile_data.mobile_design_path)?this.finishMobileSubviewSetup(Cargo.Core.ImageGallery.imageGalleryModes[this.options.data.mobile_data.mobile_design_path]):require(["/_jsapps/imagegallery/"+this.options.data.mobile_data.mobile_design_path+"/main.js"],function(t){Cargo.Core.ImageGallery.imageGalleryModes[e.options.data.mobile_data.mobile_design_path]=t,e.finishMobileSubviewSetup(t)}))},finishMobileSubviewSetup:function(e){var t=$.extend(!0,{},this.options);t.data=Object.assign(t.data,t.data.mobile_data),t.data.responsive=!1;var n=!this.inited,o=new e({el:this.el,galleryOptions:t,parentView:this,mobile_active:!0});if(this.MobileSubview=o,this.images=this.MobileSubview.serialize(),(_.keys(this.images).length<2&&!Cargo.Core.ImageGallery.draggingInEditor||0==_.keys(this.images).length)&&this.destroy(),$(this.el).removeClass("initialization-in-progress"),this.mobileSubviewActive=!0,this.unbindEvents(),this.MobileSubview.render(),this.cachedRects.needsUpdate=!0,this.mobileSubviewInited=!0,this.mobileSubviewInitInProgress=!1,this.inited=!0,this.bindEvents(),this.lastSerializedState=this.MobileSubview.serialize(),this.isEditing||this.hasClick)if(-1==Cargo.Core.ImageGallery.cachedScrollPosition){var r=this.el.getBoundingClientRect();(r.top>window.innerHeight-30||r.bottom<30)&&window.scrollTo(0,r.top+$(window).scrollTop())}else window.scrollTo(0,Cargo.Core.ImageGallery.cachedScrollPosition);n&&(Cargo.Event.trigger("image_gallery_render_complete",this),0==--a&&Cargo.Event.trigger("image_gallery_init_complete",i))},handleUpdates:function(e){"responsive"==e.changing&&this.options.data.mobile_data.separate_mobile_view?this.checkMobileAndLoadSubview():this.routeUpdatesToActiveSubview(e)},checkForChanges:function(){var e=this.lastSerializedState,t=this.mobileSubviewActive?this.MobileSubview.serialize():this.Subview.serialize();if(e){var i=_.filter(e,function(e,i){return!t.hasOwnProperty(i)}),n=_.filter(t,function(t,i){return!e.hasOwnProperty(i)}),o={};_.each(t,function(t,i){if(null!=e[i]){var n=_.omit(t,function(t,n){return"data"==n||"itemSrc"==n||("object"==typeof e[i][n]&&"object"==typeof t?_.isEqual(e[i][n],t):e[i][n]==t)},this);_.keys(n).length>0&&(o[i]=n)}},this),(n.length>0||i.length>0||_.keys(o).length>0)&&(this.images=t,this.applyChanges({added:n,removed:i,updated:o}))}this.lastSerializedState=t},applyChanges:function(e){var t=[];for(var i in e.removed)t.push(e.removed[i].index);var n,o,a=CargoEditor.getActiveRange();if(a){var r=Cargo.Core.ImageGallery.getselectedGalleryId(a);void 0!==r&&(n=o=r),_.each(e.removed,function(e){e.index<=o&&n--}),_.each(e.added,function(e){e.index<=o&&n++})}this.removeViews(),this.checkMobileAndLoadSubview(),this.routeUpdatesToActiveSubview({changing:"gallery_changed"}),void 0===n||isNaN(n)||Cargo.Core.ImageGallery.draggingInEditor||Cargo.Event.once("image_gallery_render_complete",function(){var e=this.Subview.$el.find('[data-gallery-item-id="'+n+'"]')[0];e&&Cargo.Core.ImageGallery.normalizeSelection(void 0,e)},this);try{window.top.hasOwnProperty("Cargo")&&window.top.Cargo.hasOwnProperty("Editor")&&window.top.Cargo.Editor.View.ContentView.SaveButton.trigger("save_enable")}catch(e){console.warn("Cargo Editor not found, Image Gallery settings will not be saved")}},routeUpdatesToActiveSubview:function(e){var t=Cargo.Core.ImageGallery.getselectedGalleryId();if(this.mobileSubviewActive){var i=$.extend(!0,{},this.options);i.data=_.extend(i.data,i.data.mobile_data),this.MobileSubview.handleUpdates(i,e)}else this.Subview.handleUpdates(this.options,e);if(void 0!==t&&!isNaN(t)&&!Cargo.Core.ImageGallery.draggingInEditor){var n=this.Subview.$el.find('[data-gallery-item-id="'+t+'"]')[0];n&&Cargo.Core.ImageGallery.normalizeSelection(void 0,n)}},indicateInsertion:function(e,t,i){this.draggingOverGallery=!0,this.updateCacheRects(),this.mobileSubviewActive?"function"==typeof this.MobileSubview.indicateInsertion&&this.MobileSubview.indicateInsertion(e,t,i):"function"==typeof this.Subview.indicateInsertion&&this.Subview.indicateInsertion(e,t,i)},resetIndication:function(){this.draggingOverGallery&&(this.draggingOverGallery=!1,this.mobileSubviewActive?"function"==typeof this.MobileSubview.resetIndication&&this.MobileSubview.resetIndication():"function"==typeof this.Subview.resetIndication&&this.Subview.resetIndication())},removeViews:function(e){!this.isEditing&&!this.hasClick||e?Cargo.Core.ImageGallery.cachedScrollPosition=-1:Cargo.Core.ImageGallery.cachedScrollPosition=$(window).scrollTop(),this.mobileSubviewInited&&"function"==typeof this.MobileSubview.destroy&&this.MobileSubview.destroy(),this.subviewInited&&"function"==typeof this.Subview.destroy&&this.Subview.destroy(),this.inited=!1,this.subviewInited=!1,this.mobileSubviewInited=!1,this.mobileSubviewActive=!1},destroy:function(){this.unbindEvents(),this.setEditMode(!1),this.disableEditable();for(var e=_.sortBy(this.images,"index"),t=0;t<e.length;t++){var i=this.mobileSubviewActive?this.MobileSubview.createItem(e[t],!0):this.Subview.createItem(e[t],!0);this.el.parentNode.insertBefore(i,this.el)}this.removeViews(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.images=void 0,Cargo.Plugins.elementResizer.requestRefreshTick(),delete Cargo.Core.ImageGallery.imageGalleryObjects[this.el.getAttribute("gid")]},cachedRects:{rects:{default:{top:-9e9,left:-9e9,bottom:-9e9,width:0,height:0,positions:{distance:9e9}}},needsUpdate:!0},updateCacheRects:function(){if(this.cachedRects.needsUpdate){var e=window.innerHeight,t=_.clone(this.cachedRects.rects.default);this.cachedRects.rects={default:t};for(var i=this.el.querySelectorAll("[data-gallery-item-id]"),n=0;n<i.length;n++){var o=i[n].getAttribute("data-gallery-item-id"),a=i[n].getBoundingClientRect();a.bottom>=0&&a.top<=e&&(this.cachedRects.rects[o]=a,this.cachedRects.rects[o].midPoint={x:a.left+.5*a.width,y:a.top+.5*a.height})}this.cachedRects.needsUpdate=!1}},requestTick:function(){var e=this;this.ticking||(window.requestAnimationFrame(function(){e.checkMobileAndLoadSubview(),e.ticking=!1}),this.ticking=!0),this.cachedRects.needsUpdate=!0},updateOptions:function(e,t){var i=this.options.path,n=e.path;this.options=e,t&&this.storeOptionsOnElement(),i!=n&&(this.removeViews(!0),this.checkMobileAndLoadSubview())},storeOptionsOnElement:function(){try{this.el.setAttribute("data-gallery",JSON.stringify(this.options))}catch(e){console.warn("unable to store image gallery settings",e)}},addItem:function(e){var t=this,i=parseInt(this.insertionPoint)||0;if($(e).is(".ce-in-progress")){if(!e.hasAttribute("width")||!e.hasAttribute("height")||0==e.getAttribute("width")||0==e.getAttribute("height"))return void(e.onload=function(){e.setAttribute("width",e.naturalWidth),e.setAttribute("height",e.naturalHeight),e.onload=null,t.addItem(e)});parent.Cargo.Event.once("image_upload_complete",function(e){t.checkForChanges()})}e.setAttribute("data-gallery-item-index",i),$(e).find("[data-gallery-item-index]").attr("data-gallery-item-index",i),this.meta_data_cache&&(e.setAttribute("data-meta",this.meta_data_cache),$(e).find("[data-meta]").attr("data-meta",this.meta_data_cache),this.meta_data_cache=""),$(this.el).find("[data-gallery-item-index]").each(function(){var e=parseInt(this.getAttribute("data-gallery-item-index"));e>=i&&this.setAttribute("data-gallery-item-index",e+1)}),e.removeAttribute("data-exclude-item"),$(e).find("[data-exclude-item]").removeAttr("data-exclude-item"),this.el.insertBefore(e,null),this.checkForChanges()}},!this)return;if(this.hasAttribute("data-gallery"))r.options=Cargo.Core.ImageGallery.parseGalleryOptions(this.getAttribute("data-gallery"));else if(this.hasAttribute("gid-clone")){if(!t.imageGalleryObjects.hasOwnProperty(this.getAttribute("gid-clone")))return void this.parentNode.removeChild(this);r.options=t.imageGalleryObjects[this.getAttribute("gid-clone")].options,this.removeAttribute("gid-clone")}r.options.gallery_instance_id=n,r.storeOptionsOnElement()}r.el=this,Cargo.Helper.IsAdminEdit()&&this.setAttribute("contenteditable",!1),r.checkMobileAndLoadSubview(),r.finishSubviewSetup=_.bind(r.finishSubviewSetup,r),r.finishMobileSubviewSetup=_.bind(r.finishMobileSubviewSetup,r),t.imageGalleryObjects[n]=r}}),0==a&&Cargo.Event.trigger("image_gallery_init_complete",i)}}else this.loadGalleryModes()},doDelete:function(){CargoEditor.execCommand("delete")},removeMID:function(e){var t=this,i=0,n=$(".image-gallery img[data-mid="+e+"]");if(n.length>0){var o=n.first();parseInt(o.closest("[data-gallery-item-id]").attr("data-gallery-item-id")),i=o.closest(".image-gallery").attr("gid"),n.length>1&&Cargo.Event.once("image_gallery_render_complete",function(i){t.removeMID(e)}),null!==o.get(0).parentNode&&o.get(0).parentNode.removeChild(o.get(0)),this.imageGalleryObjects[i].checkForChanges()}},normalizeSelection:function(e,t){var i=CargoEditor.getActiveRange();if(i){void 0===t&&(t=e?e.target:i.endContainer);var n=$(t).closest(".gallery_card").get(0);if(n){var o=n.querySelectorAll("img, iframe, video")[0];if(o){var a=CargoEditor.rangy.createRange();a.selectNode(o),CargoEditor.helpers.setActiveRange(a)}else i.setStartBefore(n.firstChild),i.setEndAfter(n.lastChild),CargoEditor.helpers.setActiveRange(i);if(n.hasAttribute("data-gallery-item-index"))parseInt(n.getAttribute("data-gallery-item-index"));else{var r=n.querySelector("[data-gallery-item-index]");r&&parseInt(r.getAttribute("data-gallery-item-index"))}}}},getselectedGalleryId:function(e){if(e||(e=CargoEditor.getActiveRange())){var t=void 0,i=e.getNodes([Node.ELEMENT_NODE],function(e){return e.hasAttribute("data-gallery-item-id")});return 0==i.length&&(i=$(e.commonAncestorContainer).closest("[data-gallery-item-id]")),i[0]&&(t=parseInt(i[0].getAttribute("data-gallery-item-id"))),t}},editorEvents:{"editor-keydown":function(e,t){if(Cargo.Core.ImageGallery.currentEditableGallery)if(8===t.keyCode)this.doDelete(),t.preventDefault(),t.stopImmediatePropagation();else if(37===t.keyCode||39===t.keyCode){t.preventDefault(),t.stopImmediatePropagation();var i=CargoEditor.getActiveRange(),n=0,o=_.keys(Cargo.Core.ImageGallery.currentEditableGallery.images).length-1;if(i){var a=i.commonAncestorContainer.querySelector("[data-gallery-item-index]");a&&(n=parseInt(a.getAttribute("data-gallery-item-index")))}else n=37===t.keyCode?0:9e9;if(37===t.keyCode?n--:n++,n>o||n<0){var r=CargoEditor.rangy.createRange();n<0?(r.setStartBefore(Cargo.Core.ImageGallery.currentEditableGallery.el),r.setEndBefore(Cargo.Core.ImageGallery.currentEditableGallery.el)):(r.setStartAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),r.setEndAfter(Cargo.Core.ImageGallery.currentEditableGallery.el)),r.collapse(),CargoEditor.plugins.forcerange.makeRangeForced(r)}else{var s=Cargo.Core.ImageGallery.currentEditableGallery.el.querySelector('[data-gallery-item-index="'+n+'"]');s&&this.normalizeSelection(null,s),!Cargo.Core.ImageGallery.currentEditableGallery.mobileSubviewActive&&Cargo.Core.ImageGallery.currentEditableGallery.Subview.el.hasOwnProperty("slick")&&Cargo.Core.ImageGallery.currentEditableGallery.Subview.$el.slick("slickGoTo",n,!0)}}else if(13===t.keyCode){t.preventDefault(),(r=CargoEditor.rangy.createRange()).setStartAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),r.setEndAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),r.collapse(),CargoEditor.plugins.forcerange.makeRangeForced(r)}else!1===t.metaKey&&(t.preventDefault(),t.stopImmediatePropagation())},"editor-mousedown":function(e,t){if(Cargo.Core.ImageGallery.currentEditableGallery&&Cargo.Core.ImageGallery.currentEditableGallery.el.contains(t.target)){(t&&"IMG"!==t.target.nodeName||$(t.target).closest('[draggable="true"]').length>0)&&t.preventDefault();var i=Cargo.Core.ImageGallery.currentEditableGallery.el.getBoundingClientRect(),n=!1;if(n=t.clientY<i.top+.5*i.height?"left":"right","IMG"!==t.target.nodeName&&"VIDEO"!==t.target.nodeName&&"IFRAME"!==t.target.nodeName||(n=!1),"left"==n)(o=CargoEditor.rangy.createRange()).setStartBefore(Cargo.Core.ImageGallery.currentEditableGallery.el),o.setEndBefore(Cargo.Core.ImageGallery.currentEditableGallery.el),o.collapse(!1),CargoEditor.plugins.forcerange.makeRangeForced(o);else if("right"==n){var o;(o=CargoEditor.rangy.createRange()).setStartAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),o.setEndAfter(Cargo.Core.ImageGallery.currentEditableGallery.el),o.collapse(!0),CargoEditor.plugins.forcerange.makeRangeForced(o)}else this.normalizeSelection(t)}},"cursor-activity":function(e,t){Cargo.Core.ImageGallery.currentEditableGallery},"editor-paste":function(e,t){Cargo.Core.ImageGallery.currentEditableGallery&&(t.preventDefault(),t.stopImmediatePropagation())},"editor-cut":function(e,t){Cargo.Core.ImageGallery.currentEditableGallery&&(t.preventDefault(),t.stopImmediatePropagation())},"editor-copy":function(e,t){Cargo.Core.ImageGallery.currentEditableGallery&&(t.preventDefault(),t.stopImmediatePropagation())},"editor-before-summary-report":function(e){Cargo.Core.ImageGallery.currentEditableGallery&&0!==e.generateUnreportedMutationSummaries().length&&Cargo.Core.ImageGallery.currentEditableGallery.checkForChanges()},"history-add":function(e,t){t.modifiedGalleryIDs=[],t.removedNodes.forEach(function(e){e&&e.__galleryInstanceUID__&&t.modifiedGalleryIDs.indexOf(e.__galleryInstanceUID__)&&t.modifiedGalleryIDs.push(e.__galleryInstanceUID__)})},"history-before-undo":function(e,t){_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e,i){-1!==t.modifiedGalleryIDs.indexOf(parseInt(i))&&(e.el.innerHTML="")})},"history-undo":function(e,t){var i={},n=!1;for(var o in _.each(t.removedNodes,function(e){$(e).hasClass("image-gallery")&&(e.className="image-gallery",e.setAttribute("data-force-gid",e.getAttribute("gid")),n=!0)}),_.each(t.attributeChanges,function(e){if("data-gallery"==e.attribute&&$(e.element).hasClass("image-gallery")){var t=e.element.getAttribute("gid"),n=Cargo.Core.ImageGallery.imageGalleryObjects[t];if(n){var o=JSON.parse(e.oldValue);n.updateOptions(o,!0),i[o.gallery_instance_id]=n}}}),_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e,n){-1!==t.modifiedGalleryIDs.indexOf(parseInt(n))&&(i[n]=e)}),i)i[o].mobileSubviewActive?i[o].images=i[o].MobileSubview.serialize():i[o].images=i[o].Subview.serialize(),i[o].removeViews(!0),i[o].checkMobileAndLoadSubview();n&&_.defer(function(){Cargo.Core.ImageGallery.InitImageGallery({forceReCollectionOfItems:!0,targetElement:e.getElement()})})},"history-before-redo":function(e,t){_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e,i){-1!==t.modifiedGalleryIDs.indexOf(parseInt(i))&&(e.el.innerHTML="")})},"history-redo":function(e,t){var i={},n=!1;for(var o in _.each(t.addedNodes,function(e){$(e).hasClass("image-gallery")&&(e.className="image-gallery",e.setAttribute("data-force-gid",e.getAttribute("gid")),n=!0)}),_.each(t.attributeChanges,function(e){if("data-gallery"==e.attribute&&$(e.element).hasClass("image-gallery")){var t=e.element.getAttribute("gid"),n=Cargo.Core.ImageGallery.imageGalleryObjects[t];if(n){var o=JSON.parse(e.newValue);n.updateOptions(o,!0),i[o.gallery_instance_id]=n}}}),_.each(Cargo.Core.ImageGallery.imageGalleryObjects,function(e,n){-1!==t.modifiedGalleryIDs.indexOf(parseInt(n))&&(i[n]=e)}),i)i[o].mobileSubviewActive?i[o].images=i[o].MobileSubview.serialize():i[o].images=i[o].Subview.serialize(),i[o].removeViews(!0),i[o].checkMobileAndLoadSubview();n&&_.defer(function(){Cargo.Core.ImageGallery.InitImageGallery({forceReCollectionOfItems:!0,targetElement:e.getElement()})})}}},Cargo.Core.Embeds={embeds:[],songKickWidgets:{},instagramInitialized:!1,initializeInstagram:function(e){requirejs(["https://platform.instagram.com/en_US/embeds.js"],e)},initializeTwitter:function(e){requirejs(["//platform.twitter.com/widgets.js"],e)},initializeBandsInTown:function(e){requirejs(["https://widget.bandsintown.com/main.min.js"],function(){BIT.widgetInitializer?e():BIT.onReady=e})},findEmbedsIn:function(e){_.each(e.querySelectorAll("cargo-embed, persona-embed"),this.add,this)},add:function(e){if(e&&e.nodeType===Node.ELEMENT_NODE){var t=e.getAttribute("data-type");if(t&&e&&e.nodeType===Node.ELEMENT_NODE&&-1===this.embeds.indexOf(e))switch(t){case"tweet":this.handleTwitterEmbed(e);break;case"twitter-timeline":this.handleTwitterTimelineEmbed(e);break;case"bandsintown":this.handleBandsIntownEmbed(e);break;case"songkick":this.handleSongkickEmbed(e);break;case"instagram":this.handleInstagramEmbed(e)}}},handleBandsIntownEmbed:function(e){this.initializeBandsInTown(_.bind(function(){var t={};_.each(e.attributes,function(e){if(/^data-/.test(e.name)&&"data-type"!==e.name){var i=e.name.substr(5).replace(/-/g,"_");t[i]=e.value}});var i=document.createElement("div");if(i.setAttribute("id","bit-widget-"+_.uniqueId()),i.setAttribute("class","bit-widget-initializer"),_.each(t,function(e,t){i.setAttribute("data-"+t.replace(/_/g,"-"),e)}),e.appendChild(i),Cargo.Helper.IsAdminEdit()){var n=new MutationObserver(function(e){_.each(e,function(e){"childList"==e.type&&e.addedNodes.forEach(function(e){e.setAttribute("contenteditable",!1),e&&e.classList.contains("bit-widget-container")&&(e.style.pointerEvents="none",n.disconnect())})})});n.observe(e,{childList:!0})}BIT.widgetInitializer.append(i,{})},this))},handleSongkickEmbed:function(e){var t={};_.each(e.attributes,function(e){if(/^data-/.test(e.name)&&"data-type"!==e.name){var i=e.name.substr(5).replace(/-/g,"_");t[i]=e.value}});var i=document.createElement("a");i.setAttribute("class","songkick-widget"),i.setAttribute("href","https://www.songkick.com/artists/"+t.id),i.setAttribute("contenteditable","false"),_.each(t,function(e,t){i.setAttribute("data-"+t.replace(/_/g,"-"),e)}),e.appendChild(i),this.embeds.push(e);var n="https://widget.songkick.com/"+t.id+"/widget.js";void 0===this.songKickWidgets[t.id]?this.songKickWidgets[t.id]=0:n=n+"?"+ ++this.songKickWidgets[t.id],require([n])},handleTwitterEmbed:function(e){var t=e.getAttribute("data-id");t&&""!==t&&this.initializeTwitter(_.bind(function(){twttr.widgets.createTweet(t,e).then(function(e){e.setAttribute("contenteditable","false")}),this.embeds.push(e)},this))},handleTwitterTimelineEmbed:function(e){try{var t=JSON.parse(e.getAttribute("data-source"))}catch(e){return}var i;if("number"==typeof t&&(t=e.getAttribute("data-source")),e.hasAttribute("data-options"))try{i=JSON.parse(e.getAttribute("data-options"))}catch(e){}this.initializeTwitter(_.bind(function(){twttr.widgets.createTimeline(t,e,i).then(function(e){e&&e.setAttribute("contenteditable","false")}),this.embeds.push(e)},this))},handleInstagramEmbed:function(e){var t=e.getAttribute("data-url");t&&(t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?"))),$.get("/dispatch/services/getInstagramByUrl?url="+t,_.bind(function(t){"object"==typeof t&&this.initializeInstagram(_.bind(function(){e.innerHTML=t.html,instgrm.Embeds.process()},this))},this)))},remove:function(){}},Cargo.Core.Ecommerce={activeWidgets:[],settingsStorage:{},settingsStorageIndex:0,findWidgets:function(e){if(Cargo.Collection.StripeProducts.productSyncOccurred){var t=Array.prototype.slice.call(document.body.querySelectorAll("shop")),i=[],n=0;e&&e.querySelectorAll&&_.each(e.querySelectorAll("shop"),function(e){-1===t.indexOf(e)&&t.push(e)}),_.each(t,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE){var t=e.getAttribute("product");if(t){var o=Cargo.Collection.StripeProducts.findWhere({id:t.trim()});if(!e.__ecommerce_view__||e.__ecommerce_view__.model!==o){var a=new Cargo.o.view.ProductWidget({model:o});if(e.hasAttribute("sid")){var r=e.getAttribute("sid");this.settingsStorage[r]&&a.updateOptions(this.settingsStorage[r]),e.removeAttribute("sid")}a.setElement(e),a.render(),e.__ecommerce_view__=a,i.push({el:e,view:a,id:n++})}}}},this),this.activeWidgets=i}},updateCartText:function(e,t){if(!0===t||void 0!==Cargo.Model.DisplayOptions.get("ecommerce_options")&&"text"==Cargo.Model.DisplayOptions.get("ecommerce_options").shop_icon){var i=document.getElementById("shop_button");e||(e=Cargo.Model.DisplayOptions.get("ecommerce_options").shop_icon_text),i&&e&&(void 0===Cargo.Collection.StripeProducts.cart_count||0===Cargo.Collection.StripeProducts.cart_count?i.innerHTML=e.replace(/&lt;(.*?)#(.*?)&gt;/gi,""):i.innerHTML="string"==typeof e&&""!==e?e.replace(/&lt;(.*?)#(.*?)&gt;/gi,"$1"+Cargo.Collection.StripeProducts.cart_count+"$2"):"")}},updateInlineCartCounters:function(){var e=document.querySelectorAll("cartcount");_.each(e,function(e){var t=e.getAttribute("data-template");void 0===Cargo.Collection.StripeProducts.cart_count||0===Cargo.Collection.StripeProducts.cart_count?e.innerText=t.replace(/<(.*?)#(.*?)>/gi,""):e.innerText="string"==typeof t&&""!==t?t.replace(/<(.*?)#(.*?)>/gi,"$1"+Cargo.Collection.StripeProducts.cart_count+"$2"):""},this)},storeSettingsAndSaveReferences:function(){_.each(this.activeWidgets,function(e){var t=this.settingsStorageIndex++;this.settingsStorage[t]=e.view.getOptions(),e.view.el.setAttribute("sid",t)},this)},initialize:function(){Cargo.Collection.StripeProducts.on("sync error",function(){this.findWidgets()},this),Cargo.Event.on("cargoEditor:before-html-to-projectcontent",function(){this.storeSettingsAndSaveReferences()},this),this.findWidgets()},countryMap:{AF:"Afghanistan",AX:"Ã…land Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"CÃ´te d'Ivoire",HR:"Croatia",CU:"Cuba",CW:"CuraÃ§ao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"RÃ©union",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint BarthÃ©lemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"}},function(){var e=function(e){e?(e.setAttribute("contenteditable","false"),e.innerHTML='<div class="button"><svg class="play icon" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve"><polygon points="4,2 4,14 15.3,8 "/></svg><svg class="pause icon" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve"><polygon points="3,2 3,14 4,14 7,14 7,2 4,2"/><polygon points="12,2 9,2 9,14 12,14 13,14 13,2"/></svg>\t</div>\t<div class="separator">Â </div></div><div class="bar">\t<div class="buffer"> </div>\t<div class="progress"><div class="progress-indicator"></div></div><svg class="note-icon" x="0px" y="0px" viewBox="0 0 42 49.9" style="enable-background:new 0 0 42 49.9;" xml:space="preserve">\t<g>\t\t<g>\t\t\t<path d="M41.5,34.9c0,5.5-3.1,8.2-9.2,8.2c-2.2,0-3.9-0.4-5.2-1.6c-1.3-1-1.9-2.4-1.9-4s0.7-3.1,2.4-4.3c1.6-1.2,3.6-1.8,5.8-1.8 c1.8,0,3.4,0.4,5.2,1.2V9.2L16.8,16v25.1c0,5.5-3.1,8.3-9.3,8.3c-2.2,0-3.9-0.4-5.2-1.5c-1.2-1-1.9-2.4-1.9-4s0.7-3.1,2.2-4.3 s3.4-1.8,5.6-1.8c1.8,0,3.7,0.4,5.6,1V9.2l27.7-8.7L41.5,34.9L41.5,34.9z"/>\t\t</g>\t</g></svg>\t<div class="current-time">0:00</div>\t<div data-title class="title">Play</div>\t<div class="total-time">0:00</div></div><audio preload="metadata"></audio>',this.elements={container:e,play_pause:e.querySelector(".button"),play:e.querySelector(".play"),pause:e.querySelector(".pause"),current_time:e.querySelector(".current-time"),note:e.querySelector(".note-icon"),track_buffer:e.querySelector(".buffer"),progress:e.querySelector(".progress"),progress_ind:e.querySelector(".progress-indicator"),bar:e.querySelector(".bar"),track_length:e.querySelector(".total-time"),play_text:e.querySelector(".title")},this.audio_track=e.querySelector("audio"),this.onMouseInteraction=this.onMouseInteraction.bind(this),this.updatePlayerTime=this.updatePlayerTime.bind(this),this.onError=this.onError.bind(this),this.clearError=this.clearError.bind(this),this.togglePlay=this.togglePlay.bind(this),this.onProgress=this.onProgress.bind(this),this.onTrackEnd=this.onTrackEnd.bind(this),this.onSeekStart=this.onSeekStart.bind(this),this.onSeekEnd=this.onSeekEnd.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.destroy=this.destroy.bind(this),this.removeEl=this.removeEl.bind(this),this.bindEvents(),this.mouseFlow,this.paused,this.started,this.dragging,this.hasError=!1,this.mouseInteractionDisabled=!1,this.isAdminEdit=Cargo.Helper.IsAdminEdit(),this.elements.container.__cargo_audio_player_=this,this.setSrc(e.getAttribute("data-src")),this.setTitle(e.getAttribute("data-title"))):console.error("no element passed.")};e.prototype.setSrc=function(e){this.audio_track.getAttribute("src")!==e&&(this.setInitialState(),this.audio_track.src=e,this.elements.container.setAttribute("data-src",e))},e.prototype.setTitle=function(e){this.setInitialState(),e&&""!==e||(e="Play"),this.elements.play_text.innerText=e,this.elements.container.setAttribute("data-title",e)},e.prototype.bindEvents=function(){this.audio_track.addEventListener("progress",this.onProgress),this.audio_track.addEventListener("loadedmetadata",this.onProgress),this.audio_track.addEventListener("timeupdate",this.updatePlayerTime),this.audio_track.addEventListener("seeking",this.onSeekStart),this.audio_track.addEventListener("seeked",this.onSeekEnd),this.audio_track.addEventListener("ended",this.onTrackEnd),this.audio_track.addEventListener("error",this.onError),this.audio_track.addEventListener("canplay",this.clearError),this.elements.play_pause.addEventListener("click",this.togglePlay),this.elements.bar.addEventListener("mousedown",this.onMouseDown),this.elements.bar.addEventListener("touchstart",this.onMouseDown),this.elements.bar.addEventListener("touchend",this.onMouseUp),Cargo.Event.on("css_inspector_activated",this.disableMouseInteraction,this),Cargo.Event.on("css_inspector_deactivated",this.enableMouseInteraction,this),window.addEventListener("mouseup",this.onMouseUp)},e.prototype.destroy=function(){this.audio_track.removeEventListener("progress",this.onProgress),this.audio_track.removeEventListener("loadedmetadata",this.onProgress),this.audio_track.removeEventListener("timeupdate",this.updatePlayerTime),this.audio_track.removeEventListener("seeking",this.onSeekStart),this.audio_track.removeEventListener("seeked",this.onSeekEnd),this.audio_track.removeEventListener("ended",this.onTrackEnd),this.audio_track.removeEventListener("error",this.onError),this.audio_track.removeEventListener("canplay",this.clearError),this.elements.play_pause.removeEventListener("click",this.togglePlay),this.elements.bar.removeEventListener("mousedown",this.onMouseDown),this.elements.bar.removeEventListener("touchstart",this.onMouseDown),this.elements.bar.removeEventListener("touchend",this.onMouseUp),Cargo.Event.off("css_inspector_activated",this.disableMouseInteraction),Cargo.Event.off("css_inspector_deactivated",this.enableMouseInteraction),window.removeEventListener("mouseup",this.onMouseUp),this.audio_track.pause(),this.audio_track.src="",delete this.elements.container.__cargo_audio_player_},e.prototype.disableMouseInteraction=function(){this.mouseInteractionDisabled=!0},e.prototype.enableMouseInteraction=function(){this.mouseInteractionDisabled=!1},e.prototype.removeEl=function(){this.elements.container&&this.elements.container&&this.elements.container.parentNode.removeChild(this.elements.container)},e.prototype.setPlayState=function(){this.elements.play.style.display="none",this.elements.pause.style.display="",this.elements.play_text.style.display="none",this.elements.current_time.style.display="",this.elements.note.style.display="none",this.elements.progress.style.display="",this.elements.track_length.style.display="",this.elements.track_buffer.style.display="",this.paused=!1,this.started=!0,this.dragging=!0},e.prototype.setInitialState=function(){this.elements.play.style.display="",this.elements.play_text.style.display="",this.elements.pause.style.display="none",this.elements.note.style.display="",this.elements.progress.style.display="none",this.elements.current_time.style.display="none",this.elements.track_length.style.display="none",this.elements.track_buffer.style.display="none",this.elements.progress.style.width="0%",this.elements.track_buffer.style.left="0",this.elements.track_buffer.style.width="0",this.paused=!0,this.dragging=!1,this.started=!1,this.currentPlayerTimestamp=0},e.prototype.setPauseState=function(){this.paused=!0,this.elements.play.style.display="",this.elements.pause.style.display="none"},e.prototype.togglePlay=function(){if(!this.mouseInteractionDisabled)if(this.audio_track.paused){var e=this.audio_track.play();e?(this.elements.container.classList.add("seeking"),e.then(function(){this.setPlayState()}.bind(this)).catch(this.onError).finally(function(){requestAnimationFrame(function(){this.elements.container.classList.remove("seeking")}.bind(this))}.bind(this))):this.setPlayState()}else this.audio_track.pause(),this.setPauseState()},e.prototype.onError=function(e){if(this.isAdminEdit&&""===this.audio_track.getAttribute("src"))return!0;this.hasError=!0,this.setInitialState(),this.elements.play_text.innerText="Unable to load file",e instanceof DOMException&&console.error(e)},e.prototype.clearError=function(e){this.hasError&&(this.setTitle(this.elements.container.getAttribute("data-title")),this.hasError=!1)},e.prototype.onTrackEnd=function(){!0!==this.dragging&&(this.started=!1,this.setPauseState())},e.prototype.onProgress=function(e){e&&"loadedmetadata"===e.type&&(this.elements.track_length.innerText=this.timestampToHumanReadable(this.audio_track.duration)),this.updateBufferSize()},e.prototype.updatePlayerTime=function(){if(this.started&&this.audio_track.readyState!==this.audio_track.HAVE_NOTHING){this.currentPlayerTimestamp=this.audio_track.currentTime,this.elements.current_time.textContent=this.timestampToHumanReadable(this.currentPlayerTimestamp);var e=this.currentPlayerTimestamp/this.audio_track.duration*100,t=this.elements.bar.clientWidth,i=parseInt(window.getComputedStyle(this.elements.progress_ind).width);t*(e/100)<i?(e=i/t*(100-e),this.elements.progress.style.transition="none",this.elements.track_buffer.style.transition="none"):(this.elements.progress.style.transition="",this.elements.track_buffer.style.transition=""),this.elements.progress.style.width=e+"%",this.elements.track_buffer.style.left=e+"%",this.updateBufferSize()}},e.prototype.updateBufferSize=function(){for(var e=0,t=0;t<this.audio_track.buffered.length;t++)if(this.currentPlayerTimestamp>=this.audio_track.buffered.start(t)&&this.currentPlayerTimestamp<=this.audio_track.buffered.end(t)){e=Math.max(this.audio_track.buffered.end(t)-this.currentPlayerTimestamp,0)/this.audio_track.duration*100;break}e+=1,this.elements.track_buffer.style.width=e+"%"},e.prototype.timestampToHumanReadable=function(e){if(isNaN(e))return"0:00";var t=Math.floor(e%60),i=Math.floor(e/60),n=Math.floor(i/60);return t<10&&(t="0"+t),n>0?((i-=60*n)<10&&(i="0"+i),n+":"+i+":"+t):i+":"+t},e.prototype.onMouseInteraction=function(e){if(!this.mouseInteractionDisabled&&this.started&&this.audio_track.readyState!==this.audio_track.HAVE_NOTHING&&this.dragging){var t=this.elements.bar.getBoundingClientRect(),i=e.clientX||e.touches[0].clientX;i<t.left?this.audio_track.currentTime=0:i>t.right?this.audio_track.currentTime=this.audio_track.duration:this.audio_track.currentTime=this.audio_track.duration*((i-t.left)/this.elements.bar.clientWidth)}},e.prototype.onMouseDown=function(e){e.preventDefault(),this.mouseInteractionDisabled||2===e.button||(!1===this.paused&&this.audio_track.pause(),document.body.classList.add("audio-player-dragging"),this.elements.bar.addEventListener("mousemove",this.onMouseInteraction),window.addEventListener("mousemove",this.onMouseInteraction),this.elements.bar.addEventListener("touchmove",this.onMouseInteraction),this.elements.container.classList.add("seeking"),this.dragging=!0,this.onMouseInteraction(e))},e.prototype.onMouseUp=function(e){1==this.dragging&&(document.body.classList.remove("audio-player-dragging"),this.elements.bar.removeEventListener("mousemove",this.onMouseInteraction),this.elements.bar.removeEventListener("touchmove",this.onMouseInteraction),window.removeEventListener("mousemove",this.onMouseInteraction),this.dragging=!1,!1===this.paused&&!0===this.started&&(this.audio_track.currentTime>=this.audio_track.duration-.001?this.setPauseState():this.audio_track.play())),this.onSeekEnd()},e.prototype.onSeekStart=function(){this.elements.container.classList.add("seeking"),requestAnimationFrame(function(){this.updatePlayerTime()}.bind(this))},e.prototype.onSeekEnd=function(){this.updatePlayerTime(),this.dragging||requestAnimationFrame(function(){this.elements.container.classList.remove("seeking")}.bind(this))},Cargo.Core.AudioPlayer={instances:[],findPlayers:function(t){if(t){var i,n=[];return i=$(t).is("div.audio-player")?[t]:t.querySelectorAll("div.audio-player"),_.each(i,function(i){if(void 0===_.findWhere(this.instances,{el:i})){var o=new e(i);this.instances.push({parent:t,el:i,player:o}),n.push(o)}},this),n}},destroyPlayers:function(e){e&&_.each(this.instances,function(t){t.parent===e&&t.player.destroy()})}}}(),function(){function e(t,i){var n=t&&(i(t)?t:e(t.parentNode,i));return n||null}function t(e,t,i,n,o,a,r){var s=Math.acos,l=Math.atan,d=Math.sqrt,c=Math.PI,h={x:o,y:a},u=0,g={x:1,y:1},p={x:0,y:0},m=e*n-t*i;if(r)e?(p={x:l(i/e),y:l(t/e)},g={x:e,y:m/e}):t?(u=.5*c,g={x:t,y:m/t},p.x=l(n/t)):(g={x:i,y:n},p.x=.25*c);else if(e||t){var f=d(e*e+t*t);u=t>0?s(e/f):-s(e/f),g={x:f,y:m/f},p.x=l((e*i+t*n)/(f*f))}else if(i||n){var v=d(i*i+n*n);u=.5*c-(n>0?s(-i/v):-s(i/v)),g={x:m/v,y:v},p.y=l((e*i+t*n)/(v*v))}else g={x:0,y:0};return{scale:g,translate:h,rotation:u,skew:p}}Cargo.Core.Draggables={},Cargo.Core.Draggables.masterList={},Cargo.Core.Draggables.findShowLinks=function(){document.querySelectorAll('[rel*="show_draggable"]').length>0?Cargo.Core.Draggables.showLinkIsPresent=!0:Cargo.Core.Draggables.showLinkIsPresent=!1},Cargo.Core.Draggables.cleanup=function(e){e.model&&Cargo.Core.Draggables.masterList.hasOwnProperty(e.model.id)&&delete Cargo.Core.Draggables.masterList[e.model.id]},Cargo.Core.Draggables.DraggablesInstance=Backbone.View.extend({initialize:function(t){if(!Cargo.Helper.IsAdminEdit()&&t.pageView&&(this.pageView=t.pageView,this.insideGallery=this.pageView.el.classList.contains("image-gallery"),!this.insideGallery||!this.pageView.el.classList.contains("slick"))){if(this.pid=0,this.insideGallery){var i=e(this.pageView.el,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.hasAttribute("data-id")});if(!i)return;this.pid=parseInt(i.getAttribute("data-id"))}else this.pid=this.pageView.model.id;this.draggables=[],this.findDraggables(),this.bindShowHideLinks()}},findDraggables:function(){var t=this.pageView.el.querySelectorAll("[data-draggable]");if(t.length>0){var i=this.pageView.el.querySelectorAll("[grid-col], [image-gallery-col]");_.each(i,function(e){e.querySelectorAll("[data-draggable]").length>0&&(""!==e.style.position&&"static"!==e.style.position||(e.style.position="relative"))})}for(var n=0;n<t.length;n++){var o=t[n],a=o.classList.contains("gallery_card"),r=null;a||(r=e(o,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("marquee")}));var s=e(o.parentNode,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("data-draggable")});if(!(r||!o.parentNode||o.parentNode.classList.contains("image-gallery")&&!a||s||!this.insideGallery&&a)){var l={initial_state_set:!1};o.style.zIndex?l.zIndex=o.style.zIndex:l.zIndex=1;var d=_.uniqueId("draggable_");o.hasAttribute("data-draggable-id")&&(d=o.getAttribute("data-draggable-id")),l.id=d,l.el=o;var c=l.el.querySelector(".draggable_handle");if(l.handle=c,this.insideGallery&&a)l.interiorItem=l.el.querySelector("[data-gallery-item]");else if(this.insideGallery)continue;this.draggables.push(l),Cargo.Core.Draggables.masterList.hasOwnProperty(this.pid)||(Cargo.Core.Draggables.masterList[this.pid]={draggables:[]}),Cargo.Core.Draggables.masterList[this.pid].draggables.push(l)}}if(this.draggables.length>0&&!this.insideGallery){var h=this.pageView.el.querySelector("bodycopy");h&&h.classList.add("preserve-3d")}for(n=0;n<this.draggables.length;n++)this.bindDraggable(this.draggables[n])},bindShowHideLinks:function(){for(var e=this.pageView.el.querySelectorAll('[rel*="toggle_draggable"]'),t=0;t<e.length;t++){e[t].addEventListener("click",this.toggleDraggables)}var i=this.pageView.el.querySelectorAll('[rel*="hide_draggable"]');for(t=0;t<i.length;t++){i[t].addEventListener("click",this.hideDraggables)}var n=this.pageView.el.querySelectorAll('[rel*="show_draggable"]');for(t=0;t<n.length;t++){n[t].addEventListener("click",this.showDraggables)}Cargo.Core.Draggables.masterList[this.pid]||(Cargo.Core.Draggables.masterList[this.pid]={draggables:[]}),Cargo.Core.Draggables.showLinkIsPresent?_.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.initial_state_set||(e.el.classList.add("draggable_hidden"),e.initial_state_set=!0)})}):_.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.initial_state_set||e.el.classList.remove("draggable_hidden"),e.initial_state_set=!0})})},hideDraggables:function(e){if(e.preventDefault(),this.hasAttribute("data-draggable-id")){var t=this.getAttribute("data-draggable-id");_.each(Cargo.Core.Draggables.masterList,function(e){var i=_.filter(e.draggables,{id:t});_.each(i,function(e){e.el.classList.add("draggable_hidden")})})}else _.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.el.classList.add("draggable_hidden")})})},showDraggables:function(e){if(e.preventDefault(),this.hasAttribute("data-draggable-id")){var t=this.getAttribute("data-draggable-id");_.each(Cargo.Core.Draggables.masterList,function(e){var i=_.filter(e.draggables,{id:t});_.each(i,function(e){e.el.classList.remove("draggable_hidden")})})}else _.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.el.classList.remove("draggable_hidden")})})},toggleDraggables:function(e){if(e.preventDefault(),this.hasAttribute("data-draggable-id")){var t=this.getAttribute("data-draggable-id");_.each(Cargo.Core.Draggables.masterList,function(e){var i=_.filter(e.draggables,{id:t});_.each(i,function(e){e.el.classList.contains("draggable_hidden")?e.el.classList.remove("draggable_hidden"):e.el.classList.add("draggable_hidden")})})}else _.each(Cargo.Core.Draggables.masterList,function(e){_.each(e.draggables,function(e){e.el.classList.contains("draggable_hidden")?e.el.classList.remove("draggable_hidden"):e.el.classList.add("draggable_hidden")})})},bindDraggable:function(e){var i,n=0,o=0,a=0,r=0,s=0,l=0,d=0,c=0,h=0,u=null,g=null,p=!1,m=!1,f=null;if(e.interiorItem&&(e.interiorItem.style.cursor="move"),e.handle?e.handle.style.cursor="move":e.el.style.cursor="move",e.el.setAttribute("data-draggable-id",e.id),e.el.children.length>0){var v=e.el.querySelectorAll('[rel*="show_draggable"]'),b=e.el.querySelectorAll('[rel*="hide_draggable"]'),y=e.el.querySelectorAll('[rel*="toggle_draggable"]');_.each(v,function(t){t.setAttribute("data-draggable-id",e.id)}),_.each(b,function(t){t.setAttribute("data-draggable-id",e.id)}),_.each(y,function(t){t.setAttribute("data-draggable-id",e.id)})}var w=function(e){p?(e.preventDefault(),e.stopPropagation(),m=!1):m=!0,window.removeEventListener("click",w,!0)},C=_.bind(function(v){if(2!=v.button){u=u=e.el.querySelector(".image-zoom"),g=g=e.el.querySelector("a"),"INPUT"!==v.target.tagName&&"TEXTAREA"!==v.target.tagName&&"LABEL"!==v.target.tagName&&"CANVAS"!==v.target.tagName&&(v.preventDefault(),m=!1),f=e.el,p=!1;var b=v.clientX||v.touches&&v.touches[0].clientX,y=v.clientY||v.touches&&v.touches[0].clientY;this.pageView.el.classList.add("dragging-active");var C=e.el.style.transform;e.el.style.transform="",e.el.style.transitionDuration="initial",i=e.el.getBoundingClientRect(),e.el.style.transform=C,e.initial_state_set=!0;var x=window.getComputedStyle(e.el);if(!this.insideGallery){var E=x.getPropertyValue("background-color"),I=!0;if(E.indexOf("rgb(")>0)I=!1;else for(var T=E.replace("rgba(","").replace(")","").split(","),A=0;A<T.length;A++){parseFloat(T[A])>0&&(I=!1)}I&&(e.el.style.backgroundColor="rgba(0,0,0,0.004)")}var M=x.getPropertyValue("transform"),P=M.indexOf("matrix(")>-1,O=M.indexOf("matrix3d(")>-1;if(P){M=M.replace(")","").replace("matrix(","").split(",");for(A=0;A<M.length;A++)M[A]=parseFloat(M[A]);h=t(M[0],M[1],M[2],M[3],M[4],M[5],!1).rotation,r=M[M.length-1],a=M[M.length-2]}else if(O){M=M.replace(")","").replace("matrix3d(","").split(",");for(A=0;A<M.length;A++)M[A]=parseFloat(M[A]);h=t(M[0],M[1],M[4],M[5],M[12],M[13],!1).rotation,r=M[M.length-3],a=M[M.length-4]}else M=[1,0,0,1,0,0],h=0,a=0,r=0;a=Math.floor(100*a)/100,r=Math.floor(100*r)/100,(h=(Math.round(h*(180/Math.PI))+360)%360)>180&&(h-=360),n=b-a,o=y-r,d=i.left,c=i.top,s=b,l=y,window.addEventListener("click",w,!0);var L=0;for(A=0;A<this.draggables.length;A++)L=Math.max(this.draggables[A].zIndex,L);e.zIndex=L+1,e.el.style.zIndex=99,_.defer(function(){e.el.style.zIndex=L+1}),v.touches?(window.addEventListener("touchmove",S),window.addEventListener("touchend",k)):(window.addEventListener("mousemove",S),window.addEventListener("mouseup",k))}},this),S=function(e){var t=e.clientX||e.touches&&e.touches[0].clientX,h=e.clientY||e.touches&&e.touches[0].clientY,u=e.touches?4:2;a=t-n,r=h-o,(Math.abs(s-t)>u||Math.abs(l-h)>u)&&(p=!0),d+a>=baseUnit.cache.window.w-50?a=baseUnit.cache.window.w+-d+-50:d+a+i.width<=50&&(a=-d-i.width+50);c+r>=baseUnit.cache.window.h-50?r=baseUnit.cache.window.h+-c+-50:c+r+i.height<=50&&(r=-c-i.height+50),x()},k=_.bind(function(t){if(_.defer(function(){e.el.style.transitionDuration=""}),e.el.hasAttribute("data-draggable")&&(e.el.setAttribute("data-transform-z",e.zIndex),e.el.setAttribute("data-transform-x",100*a/i.width),e.el.setAttribute("data-transform-y",100*r/i.height)),this.pageView.el.classList.remove("dragging-active"),e.el.children.length>0&&!this.insideGallery){var n=e.el.querySelectorAll("img, video, iframe");_.each(n,function(e){e._scrollWatcher&&(e._scrollWatcher.recalculateLocation(),e._scrollWatcher.update(),e._scrollWatcher.triggerCallbacks()),e._scrollWatchEnterThreshold&&(e._scrollWatchEnterThreshold.recalculateLocation(),e._scrollWatchEnterThreshold.update(),e._scrollWatchEnterThreshold.triggerCallbacks()),e._referenceScrollWatch&&(e._referenceScrollWatch.recalculateLocation(),e._referenceScrollWatch.update(),e._referenceScrollWatch.triggerCallbacks())})}else this.insideGallery&&e.interiorItem?(e.interiorItem._scrollWatcher&&(e.interiorItem._scrollWatcher.recalculateLocation(),e.interiorItem._scrollWatcher.update(),e.interiorItem._scrollWatcher.triggerCallbacks()),e.interiorItem._scrollWatchEnterThreshold&&(e.interiorItem._scrollWatchEnterThreshold.recalculateLocation(),e.interiorItem._scrollWatchEnterThreshold.update(),e.interiorItem._scrollWatchEnterThreshold.triggerCallbacks()),e.interiorItem._referenceScrollWatch&&(e.interiorItem._referenceScrollWatch.recalculateLocation(),e.interiorItem._referenceScrollWatch.update(),e.interiorItem._referenceScrollWatch.triggerCallbacks())):(e.el._scrollWatcher&&(e.el._scrollWatcher.recalculateLocation(),e.el._scrollWatcher.update(),e.el._scrollWatcher.triggerCallbacks()),e.el._scrollWatchEnterThreshold&&(e.el._scrollWatchEnterThreshold.recalculateLocation(),e.el._scrollWatchEnterThreshold.update(),e.el._scrollWatchEnterThreshold.triggerCallbacks()),e.el._referenceScrollWatch&&(e.el._referenceScrollWatch.recalculateLocation(),e.el._referenceScrollWatch.update(),e.el._referenceScrollWatch.triggerCallbacks()));p||_.defer(function(){if(!m&&f){var e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});u?u.dispatchEvent(e):g?g.dispatchEvent(e):f.dispatchEvent(e)}}),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",k),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",k)},this),x=function(){e.el.style.transform="translate("+100*a/i.width+"%,"+100*r/i.height+"%) rotate("+h+"deg) translateZ("+e.zIndex+"px)"};e.handle?(e.handle.addEventListener("touchstart",C),e.handle.addEventListener("mousedown",C)):(e.el.addEventListener("touchstart",C),e.el.addEventListener("mousedown",C))},remove:function(){if(this.pageView){for(var e=this.pageView.el.querySelectorAll('[rel*="toggle_draggable"]'),t=0;t<e.length;t++){e[t].removeEventListener("click",this.toggleDraggables)}var i=this.pageView.el.querySelectorAll('[rel*="hide_draggable"]');for(t=0;t<i.length;t++){i[t].removeEventListener("click",this.hideDraggables)}var n=this.pageView.el.querySelectorAll('[rel*="show_draggable"]');for(t=0;t<n.length;t++){n[t].removeEventListener("click",this.showDraggables)}Cargo.Core.Draggables.cleanup(this.pageView)}Backbone.View.prototype.remove.apply(this,arguments)}}),Cargo.Event.on("image_gallery_rendered",function(e){e.draggableView?Cargo.Helper.IsAdminEdit()||(e.draggableView.draggables=[],e.draggableView.findDraggables(),e.draggableView.bindShowHideLinks()):e.draggableView=new Cargo.Core.Draggables.DraggablesInstance({pageView:e})})}(),function(){var e=Backbone.View.extend({defaults:{speed:-20,behavior:"scroll",direction:"horizontal",offset:0},initialize:function(e){if(e.parentView){if(this.parentView=e.parentView,Cargo.Event.trigger("marquee:before-init",this),this.model.attributes=_.defaults(this.model.attributes,this.defaults),this.getAttributes(),this.setAttributes(),this.contentNodes=[],this.waitingForDragEnd=!1,this.built=!1,this.editing=!1,this.marqueeContentRect=null,this.mRect=null,this.wrapper=null,this.inner=null,this.position=0,this.hasPadding=null,this.translateX=0,this.translateY=0,this.paused=!1,this.onlyContainsScalableItems=!1,this.updateContent(),this.buildOut(!0),this.updateSize(),this.dragEnter=_.bind(this.dragEnter,this),this.handleUndoRedoChanges=_.bind(this.handleUndoRedoChanges,this),Cargo.Helper.IsAdminEdit()&&(this.el.addEventListener("dragenter",this.dragEnter),"undefined"!=typeof CargoEditor&&CargoEditor.events)){var t={childList:!0,subtree:!0},i=new MutationObserver(this.handleUndoRedoChanges);CargoEditor.events.on("history-before-redo history-before-undo",function(){i.observe(this.el,t)},this),CargoEditor.events.on("history-redo history-undo",function(){this.handleUndoRedoChanges(i.takeRecords()),i.disconnect()},this),CargoEditor.events.on("editor-drop",function(){var e=this;_.defer(function(){e.built||!e.waitingForDragEnd||e.editing||(e.updateContent(),e.buildOut())})},this),CargoEditor.events.on("editor-dragend",function(){this.built||!this.waitingForDragEnd||this.editing||(this.updateContent(),this.buildOut())},this)}Cargo.Event.trigger("marquee:after-init",this)}},events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},onMouseEnter:function(e){this.built&&this.el.setAttribute("contenteditable",!1)},onMouseLeave:function(e){this.el.blur(),this.el.removeAttribute("contenteditable")},handleUndoRedoChanges:function(e){var t=!1;if(_.each(e,function(e){e.target.classList.contains("marquee")&&e.target.classList.contains("torn-down")&&(t=!0)}),e.length>0){var i=!1,n=this.el.querySelector(".marquee_contents");if(n){var o=n.querySelector(".marquee_inner");if(o){for(i=!0;o.childNodes.length>0;)this.el.appendChild(o.childNodes[0]);n.parentNode.removeChild(n)}}this.contentNodes=this.el.childNodes,i&&t?(this.built=!1,this.buildOut()):(this.built=!0,this.tearDown(),Cargo.Event.trigger("marquee:requires-modal",this))}},pause:function(){this.paused=!0},resume:function(){this.paused=!1},setAttributes:function(){this.el.setAttribute("direction",this.model.get("direction")),this.el.setAttribute("speed",this.model.get("speed")),this.el.setAttribute("behavior",this.model.get("behavior")),this.el.setAttribute("behavior",this.model.get("behavior")),this.el.setAttribute("offset",Math.floor(100*this.model.get("offset"))+"%")},dragEnter:function(e){this.waitingForDragEnd=!0,this.tearDown()},getAttributes:function(){this.el.hasAttribute("speed")&&this.model.set("speed",parseFloat(this.el.getAttribute("speed"))),this.el.hasAttribute("direction")&&this.model.set("direction",this.el.getAttribute("direction")),this.el.hasAttribute("behavior")&&this.model.set("behavior",this.el.getAttribute("behavior")),this.el.hasAttribute("offset")&&this.model.set("offset",.01*parseInt(this.el.getAttribute("offset")))},handleUpdate:function(e,t){"offset"===e&&(t*=.01);var i=this.model.get(e);this.model.set(e,t),this.setAttributes(),"behavior"===e&&i!==t?(this.setAttributes(),this.built?(this.tearDown(),this.buildOut()):this.buildOut()):i===t||this.built||this.buildOut()},removeMarqueeContent:function(){if(this.updateContent(),this.el.parentNode)for(;this.contentNodes.length>0;)this.el.parentNode.insertBefore(this.contentNodes[0],this.el);this.destroy()},updateSize:function(){if(this.el||this.destroy(),this.built){var e=this.wrapper.getBoundingClientRect(),t=this.el.getBoundingClientRect(),i=0,n=0,o=0,a=0;if(null===this.hasPadding||this.hasPadding){var r=window.getComputedStyle(this.el,null);o=parseFloat(r.paddingLeft),n=parseFloat(r.paddingTop),a=parseFloat(r.paddingBottom),i=parseFloat(r.paddingRight),null===this.hasPadding&&(this.hasPadding=o||n||a||i)}var s=t.left+-(e.left+-this.translateX);this.marqueeContentRect={width:e.width,height:e.height},this.mRect={overHangX:s,padTop:n,padLeft:o,padRight:i,padBottom:a,width:t.width,height:t.height}}},draw:function(){if(this.el&&this.el.parentNode||this.destroy(),this.built&&this.mRect&&this.marqueeContentRect){var e=this.paused?0:.001*this.model.get("speed")*60,t=1;if(this.onlyContainsScalableItems)t=baseUnit.cache.window.w/1e3;else{var i=((f=Math.min(1e3,Math.max(320,baseUnit.cache.window.w)))-320)/680;t=1*i+.72*(1-i)}e*=t;var n=this.model.get("offset"),o="vertical"===this.model.get("direction"),a="horizontal"===this.model.get("direction");if(e*=1.5,this.position=e+this.position,"bounce"===this.model.get("behavior")){var r=Math.abs(this.position),s=this.mRect.width-(this.mRect.padLeft+this.mRect.padRight),l=this.mRect.height-(this.mRect.padTop+this.mRect.padBottom),d=s-(f=this.marqueeContentRect.width),c=l-(v=.5*this.marqueeContentRect.height),h=0,u=0;f>=s&&(h=-(d=f-s)),v>=l&&(u=-(c=v-l));var g=a?d+n*d:n*d,p=o?c+n*c:n*c,m=c-Math.abs((r+p)%(2*c)-c)||0;b=((b=d-Math.abs((r+g)%(2*d)-d)||0)+d)%d+h,m=(m+c)%c+u,a?(this.wrapper.style.transform="translateX("+b+"px)",this.translateX=b,this.translateY=0):o?(this.wrapper.style.transform="translateY("+m+"px)",this.translateY=m,this.translateX=0):(this.wrapper.style.transform="translate("+b+"px, "+m+"px)",this.translateY=m,this.translateX=b),this.inner.style.transform=""}else{var f=Math.max(this.marqueeContentRect.width,this.mRect.width),v=Math.max(this.marqueeContentRect.height,this.mRect.height),b=(this.position+n*this.marqueeContentRect.width)%f||this.translateX;m=(this.position+n*this.marqueeContentRect.height)%v||this.translateX;b>0&&(b+=-f),b+=this.mRect.overHangX,m>0&&(m-=f),a?(this.translateY=0,this.translateX=b,this.inner.style.transform="translateX("+f+"px)",this.wrapper.style.transform="translateX("+b+"px)"):o&&(this.translateY=m,this.translateX=0,this.inner.style.transform="translateY("+v+"px)",this.wrapper.style.transform="translateX("+m+"px)")}}},startEditing:function(){this.editing?this.tearDown():(this.el.classList.add("editing"),this.editing=!0,CargoEditor&&CargoEditor.hasOwnProperty("rangy")&&setTimeout(_.bind(function(){var e=CargoEditor.rangy.createRange();e.selectNodeContents(this.el),e.collapse(!0),CargoEditor.helpers.setActiveRange(e)},this),50),this.tearDown())},stopEditing:function(){this.editing?(this.el.classList.remove("editing"),this.editing=!1,Cargo.Event.trigger("handleAdminUIChange"),this.buildOut()):this.buildOut()},updateContent:function(){this.built?this.contentNodes=this.inner.childNodes:this.contentNodes=this.el.childNodes,this.onlyContainsScalableItems=!0;for(var e=0;e<this.contentNodes.length;){var t=this.contentNodes[e];if(t.nodeType===Node.ELEMENT_NODE)if("IMG"===t.nodeName&&"VIDEO"===t.nodeName&&"IFRAME"===t.nodeName||(this.onlyContainsScalableItems=!1),t.classList.contains("marquee")||t.classList.contains("image-gallery")){if(t.hasAttribute("data-marquee-id"))this.parentView.marquee[t.getAttribute("data-marquee-id")].removeMarqueeContent();else for(;t.childNodes.length>0;)t.parentNode.insertBefore(t.childNodes[0],t);t.parentNode.removeChild(t)}else e++;else e++}},buildOut:function(e){if(!this.built)if(this.el.classList.remove("torn-down"),0!=this.contentNodes.length){var t=document.createElement("div");t.className="marquee_contents";var i=document.createElement("div");for(i.className="marquee_inner";this.contentNodes.length>0;)i.appendChild(this.contentNodes[0]);t.appendChild(i),this.inner=i;var n=i.cloneNode(!0);n.classList.add("cloned_marquee_inner"),this.innerClone=n,"scroll"!==this.model.get("behavior")&&"up"!==this.model.get("direction")&&"down"!==this.model.get("direction")&&"diagonal"!==this.model.get("direction")||t.appendChild(n);var o=i.querySelectorAll("img"),a=n.querySelectorAll("img");_.each(o,function(e,t){e.classList.contains("image-zoom")&&(a[t].classList.add("image-zoom"),$(a[t]).on("click.lightbox",function(){$(e).click()}))});var r=i.querySelectorAll("video"),s=n.querySelectorAll("video");_.each(r,function(e,t){!function(e,t,i){var n;t.addEventListener("play",function(){e.currentTime=t.currentTime,e.play()}),t.addEventListener("pause",function(){e.currentTime=t.currentTime,e.pause()}),e.addEventListener("play",function(){t.currentTime=e.currentTime,t.play(),n=setTimeout(o,500)}),e.addEventListener("pause",function(){t.currentTime=e.currentTime,t.pause(),clearTimeout(n)});var o=function(){t.currentTime=e.currentTime,n=setTimeout(o,500)}}(r[t],s[t])}),this.el.innerHTML="",this.el.setAttribute("data-marquee-id",this.id),this.el.appendChild(t),this.wrapper=t,Cargo.Event.trigger("handleAdminUIChange"),e||this.parentView.refresh(),this.built=!0,this.updateContent()}else this.destroy()},destroy:function(){this.parentView.removeView(this.id)},tearDown:function(){if(this.built){if(this.el.classList.add("torn-down"),this.contentNodes.length>0&&this.contentNodes[0].parentNode!==this.el)for(;this.contentNodes.length>0;)this.el.appendChild(this.contentNodes[0]);this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.el.removeAttribute("contenteditable");var e=this.el.querySelector(".marquee_contents");e&&e.parentNode.removeChild(e),this.wrapper=null,this.innerClone=null,this.inner=null,this.built=!1,this.updateContent(),this.parentView.refresh()}},remove:function(){Cargo.Event.trigger("marquee:before-remove",this),this.stopListening(),this.undelegateEvents(),Cargo.Helper.IsAdminEdit()&&this.el.removeEventListener("dragenter",this.dragEnter),this.built=!1,this.contentNodes=[],Backbone.View.prototype.remove.apply(this,arguments),Cargo.Event.trigger("marquee:after-remove",this)}});Cargo.Core.MarqueeInstance=Backbone.View.extend({initialize:function(e){e&&e.parentView&&(this.parentView=e.parentView,this.isAdmin=Cargo.Helper.IsAdminEdit(),this.marquees={},this.ticking=!1,this.idleWaiting=!1,this.hasRequestIdle="requestIdleCallback"in window,this.draw=_.bind(this.draw,this),this.requestTick=_.bind(this.requestTick,this),this.findMarquees=_.bind(this.findMarquees,this),this.listenTo(Cargo.Event,"elementresizer_update_complete",this.requestTick),"undefined"!=typeof CargoEditor&&CargoEditor.events&&this.listenTo(CargoEditor.events,"editor-content-change",this.requestTick))},findMarquees:function(){var e=this.parentView.el.querySelectorAll(".marquee");_.each(e,function(e){e.classList.length>4||this.addView(e)},this),cancelAnimationFrame(this.drawFrame),_.isEmpty(this.marquees)||this.draw()},draw:function(){this.ticking&&(this.hasRequestIdle&&!this.idleWaiting?(this.idleWaiting=!0,requestIdleCallback(_.bind(function(){this.updateSizes(),this.idleWaiting=!1},this),{timeout:500})):this.hasRequestIdle||this.updateSizes(),this.ticking=!1),_.each(this.marquees,function(e){e.draw()}),this.drawFrame=requestAnimationFrame(this.draw)},addView:function(t,i){if(!(t.classList.length>4)){var n=_.uniqueId("marquee_");if(t.hasAttribute("data-marquee-id")&&(n=t.getAttribute("data-marquee-id")),t.setAttribute("data-marquee-id",n),this.marquees[n])return this.marquees[n];var o=_.extend({},i),a=new e({el:t,id:n,parentView:this,model:new Backbone.Model(o)});return this.marquees[n]=a,cancelAnimationFrame(this.drawFrame),this.draw(),a}},requestTick:function(){this.ticking||(this.ticking=!0)},updateSizes:function(){_.each(this.marquees,function(e){e.updateSize()})},removeView:function(e){this.marquees[e]&&(this.marquees[e].remove(),delete this.marquees[e])},removeViews:function(){var e=this;_.each(this.marquees,function(t,i){t.remove(),delete e.marquees[i]})},refresh:_.debounce(function(){Cargo&&Cargo.Plugins&&Cargo.Plugins.elementResizer.requestRefreshTick()}.bind(this),100),remove:function(){cancelAnimationFrame(this.drawFrame),this.stopListening(),Backbone.View.prototype.remove.apply(this,arguments)}})}(),Cargo.Core=window.Cargo.Core||{},Cargo.Core.Handlebars={Render:function(e,t){var i=Handlebars.compile(e);return Handlebars.registerPartial("loading_animation",$("#loading_animation").html()),Handlebars.registerPartial("images",$('[type="text/x-handlebars-template"]#images').html()),Handlebars.registerPartial("page_master",this.ParseScriptTags($("#page_master").html())),Handlebars.registerPartial("page",this.ParseScriptTags($("#page").html())),Handlebars.registerPartial("pin",this.ParseScriptTags($("#pin").html())),Handlebars.registerPartial("content",this.ParseScriptTags($("#content").html())),Handlebars.registerPartial("sitemenu_item",this.ParseScriptTags($("#sitemenu_item").html())),this.RegisterHelper_Print(),this.RegisterHelper_IfAny(),this.RegisterHelper_IfAll(),this.RegisterHelper_IfEqual(),this.RegisterHelper_UnlessAny(),this.RegisterHelper_UnlessAll(),this.RegisterHelper_IfOption(),this.RegisterHelper_UnlessOption(),this.RegisterHelper_DisplayOptions(),this.RegisterHelper_Truncate(),this.RegisterHelper_Image(),this.RegisterHelper_Var(),this.RegisterHelper_Stringify(),this.RegisterHelper_IsAdmin(),this.RegisterHelper_FillDefaultThumbnailCrop(),i(t)},ParseScriptTags:function(e){if(e)return e.replace(/\[script/g,"<script").replace(/\[\/script/g,"</script")},RegisterHelper_Print:function(){Handlebars.registerHelper("print",function(e,t){var i=wrapper_tail="";"project.content"!=e&&"content"!=e||(i="<projectcontent>",wrapper_tail="</projectcontent>"),e=e.replace("project.","");var n="object"==typeof this.project?this.project:this;return new Handlebars.SafeString(i+n[e]+wrapper_tail)})},RegisterHelper_IfAny:function(){Handlebars.registerHelper("if_any",function(){for(var e=!1,t=arguments[arguments.length-1],i=arguments.length-2;i>=0;i--)if(arguments[i]){e=!0;break}return e?t.fn(this):t.inverse(this)})},RegisterHelper_IfAll:function(){Handlebars.registerHelper("if_all",function(){for(var e=!0,t=arguments[arguments.length-1],i=arguments.length-2;i>=0;i--)if(!arguments[i]){e=!1;break}return e?t.fn(this):t.inverse(this)})},RegisterHelper_IfEqual:function(){Handlebars.registerHelper("if_equal",function(e,t,i){return 3!=arguments.length?"":e==t?i.fn(this):i.inverse(this)})},RegisterHelper_UnlessAny:function(){Handlebars.registerHelper("unless_any",function(){for(var e=!1,t=arguments[arguments.length-1],i=arguments.length-2;i>=0;i--)if(!arguments[i]){e=!0;break}return e?t.fn(this):t.inverse(this)})},RegisterHelper_UnlessAll:function(){Handlebars.registerHelper("unless_all",function(){for(var e=!0,t=arguments[arguments.length-1],i=arguments.length-2;i>=0;i--)if(arguments[i]){e=!1;break}return e?t.fn(this):t.inverse(this)})},RegisterHelper_DisplayOptions:function(){Handlebars.registerHelper("displayoptions",function(e,t){var i=e.replace("display_options.","").split("."),n=i.length;return(1==n?Cargo.Model.DisplayOptions.get(i[0]):2==n?Cargo.Model.DisplayOptions.get(i[0])[i[1]]:3==n?Cargo.Model.DisplayOptions.get(i[0])[i[1]][i[2]]:Cargo.Model.DisplayOptions.get(i[0]))?t.fn(this):t.inverse(this)})},RegisterHelper_IfOption:function(){Handlebars.registerHelper("if_option",function(e,t){var i=e.replace("display_options.","").split("."),n=i.length;return(1==n?Cargo.Model.DisplayOptions.get(i[0]):2==n?Cargo.Model.DisplayOptions.get(i[0])[i[1]]:3==n?Cargo.Model.DisplayOptions.get(i[0])[i[1]][i[2]]:Cargo.Model.DisplayOptions.get(i[0]))?t.fn(this):t.inverse(this)})},RegisterHelper_UnlessOption:function(){Handlebars.registerHelper("unless_option",function(e,t){var i=e.replace("display_options.","").split("."),n=i.length;return(1==n?Cargo.Model.DisplayOptions.get(i[0]):2==n?Cargo.Model.DisplayOptions.get(i[0])[i[1]]:3==n?Cargo.Model.DisplayOptions.get(i[0])[i[1]][i[2]]:Cargo.Model.DisplayOptions.get(i[0]))?t.inverse(this):t.fn(this)})},RegisterHelper_Truncate:function(){Handlebars.registerHelper("truncate",function(e,t){if(e.length>t&&e.length>0){var i=e+" ";return i=e.substr(0,t),i=(i=e.substr(0,i.lastIndexOf(" "))).length>0?i:e.substr(0,t),new Handlebars.SafeString(i+"...")}return e})},RegisterHelper_Image:function(){Handlebars.registerHelper("image",function(e,t){return new Cargo.o.model.image(e).getImageByWidth(t)})},RegisterHelper_Var:function(){Handlebars.registerHelper("var",function(e,t){this[e]=t})},RegisterHelper_Stringify:function(){Handlebars.registerHelper("stringify",function(e){return JSON.stringify(e)})},RegisterHelper_IsAdmin:function(){Handlebars.registerHelper("is_admin",function(e){var t=arguments[arguments.length-1];return Cargo.Helper.IsAdminEdit()?t.fn(this):t.inverse(this)})},RegisterHelper_FillDefaultThumbnailCrop:function(){Handlebars.registerHelper("fill_default_thumbnail_crop",function(e,t){var i,n,o,a=t.split(/x/),r=a[0]/a[1],s=e.imageModel.width/e.imageModel.height;return s<=r?(i=100,n=0,o=(1/s-1/r)/2*-100):(i=s/r*100,n=50*(1-s/r),o=0),"width: "+i+"%; margin-left: "+n+"%; margin-top: "+o+"%; height: auto;"})}},Cargo=Cargo||{},Cargo.utils=Cargo.utils||{},Cargo.utils.CargoXHR=function(e){var t=this;if($.extend(this.options={},this.defaultOptions,e),void 0===this.options.context&&(this.options.context=this),void 0===this.options.url)throw'no URL given, define "url" in the contructor\'s options object';this.retries=0,this.xhr=new XMLHttpRequest,this.xhr.addEventListener("abort",function(){t.options.abort.apply(t.options.context,arguments)},!1),this.xhr.addEventListener("error",function(){t.options.error.apply(t.options.context,arguments)},!1),this.xhr.addEventListener("load",function(){t.options.success.apply(t.options.context,arguments)},!1),this.xhr.addEventListener("loadend",function(){t.options.always.apply(t.options.context,arguments)},!1),this.xhr.upload.addEventListener("progress",function(e){t.options.progress.apply(t.options.context,arguments)},!1),this.send()},Cargo.utils.CargoXHR.prototype.send=function(){for(var e in this.xhr.open(this.options.type,this.options.url,this.options.async),this.options.headers)this.xhr.setRequestHeader(e,this.options.headers[e]);this.xhr.responseType=this.options.dataType,this.options.beforeSend.call(this,this.xhr),this.xhr.send(this.options.data)},Cargo.utils.CargoXHR.prototype.retry=function(){if(!(this.retries++<this.options.maxRetries))return this.abort(),!1;Cargo.utils.CargoXHR.prototype.send.apply(this,arguments)},Cargo.utils.CargoXHR.prototype.abort=function(){"object"==typeof this.xhr&&this.xhr.abort()},Cargo.utils.CargoXHR.prototype.defaultOptions={async:!0,beforeSend:function(e){},always:function(e){},success:function(e){},progress:function(e){},error:function(e){},abort:function(e){},type:"GET",url:void 0,dataType:"text",headers:{},data:null,context:void 0,maxRetries:5},function(){var e=null;Cargo.Core.MarkerInstance=function(e){this.resizedSVGOffsetX=0,this.resizedSVGOffsetY=0,this.pageView=e,this.addSVGElementHoverOutline=_.bind(this.addSVGElementHoverOutline,this),this.removeSVGElementHoverOutline=_.bind(this.removeSVGElementHoverOutline,this),e.listenTo(e,"initial-setup",_.bind(this.setupPage,this)),e.listenTo(Cargo.Event,"elementresizer_update_complete",_.bind(this.positionTetheredNodes,this)),this.loadSVGWebfonts()},Cargo.Core.MarkerInstance.prototype.hoverStatesEnabled=!1,Cargo.Core.MarkerInstance.prototype.setupPage=function(){this.findTetherTargets(),this.positionTetheredNodes(),this.pageView.listenTo(Cargo.Event,"image_gallery_rendered",_.bind(function(){this.findTetherTargets(),this.positionTetheredNodes()},this)),this.pageView.listenTo(Cargo.Event,"image_gallery_init_complete",_.bind(function(){this.positionTetheredNodes()},this))},Cargo.Core.MarkerInstance.prototype.enableSVGHoverStates=function(){if(null===e){var t=document.createElement("div");e=document.createElement("div"),t.className="marker-outline-layer",e.className="marker-outline-box",t.appendChild(e),document.body.appendChild(t)}this.svg_overlay&&(this.svg_overlay.addEventListener("mouseover",this.addSVGElementHoverOutline),this.svg_overlay.addEventListener("mouseout",this.removeSVGElementHoverOutline)),this.hoverStatesEnabled=!0},Cargo.Core.MarkerInstance.prototype.disableSVGHoverStates=function(t){this.svg_overlay&&(this.svg_overlay.removeEventListener("mouseover",this.addSVGElementHoverOutline),this.svg_overlay.removeEventListener("mouseout",this.removeSVGElementHoverOutline)),t||(null!==e&&this.removeSVGElementHoverOutline(),this.hoverStatesEnabled=!1)},Cargo.Core.MarkerInstance.prototype.addSVGElementHoverOutline=function(t){var i=t.target;"a"===i.parentNode.nodeName&&(i=i.parentNode);var n=i.getAttribute("stroke-width"),o=1;"none"===i.getAttribute("stroke")||isNaN(n)||(o+=n/2);var a=i.getBoundingClientRect();e.style.left=a.left-o+"px",e.style.top=a.top-o+document.scrollingElement.scrollTop+"px",e.style.width=a.width+2*o+"px",e.style.height=a.height+2*o+"px",e.style.display="block"},Cargo.Core.MarkerInstance.prototype.resizeSVGToFitContent=function(e){if(this.svg_overlay&&this.svg_content_layer&&1!==this.svg_content_layer.children.length){var t=this.pageView.isAdminEdit?200:0,i=offsetY=0;try{var n=this.svg_content_layer.getBBox()}catch(e){return void console.warn("unable to retrieve bbox")}i=-1*(n.x-t),offsetY=-1*(n.y-t),this.svg_overlay.style.transform="translate("+-1*i+"px, "+-1*offsetY+"px)",this.svg_overlay.style.webkitTransform="translate("+-1*i+"px, "+-1*offsetY+"px)",this.svg_content_layer.setAttribute("transform","translate("+i+", "+offsetY+")"),this.svg_selector_layer&&this.svg_selector_layer.setAttribute("transform","translate("+i+", "+offsetY+")"),this.resizedSVGOffsetX=i,this.resizedSVGOffsetY=offsetY,this.svg_overlay.style.width=n.width+2*t,this.svg_overlay.style.height=n.height+2*t}},Cargo.Core.MarkerInstance.prototype.removeSVGElementHoverOutline=function(){e.style.display="none"},Cargo.Core.MarkerInstance.prototype.loadSVGWebfonts=function(){var e=_.clone(this.pageView.model.getPageOption("svg_fonts"));e&&(e.fontactive=_.bind(function(){this.positionTetheredNodes()},this),WebFont.load(e))},Cargo.Core.MarkerInstance.prototype.findTetherTargets=function(e){if(!e&&this.pageView.el.querySelector("#svgroot")&&(e=this.pageView.el.querySelector("#svgroot")),e||(e=this.pageView.el.querySelector(".marker-overlay")))return this.svg_overlay!==e&&(this.disableSVGHoverStates(!0),this.svg_overlay=e,this.svg_position_layer=this.svg_overlay,this.svg_overlay.querySelector(".marker-overlay")&&(this.svg_position_layer=this.svg_overlay.querySelector(".marker-overlay")),this.svg_content_layer=this.svg_overlay.querySelector("g.layer"),this.svg_selector_layer=this.svg_overlay.parentNode.querySelector("#selectorParentGroup"),this.resizeSVGToFitContent(),this.pageView.isAdminEdit?this.svg_overlay.addEventListener("click",function(e){Cargo.Event.trigger("marker-overlay-click",e)}):this.svg_overlay.addEventListener("click",function(e){e.preventDefault();var t=e.target;if("a"===t.parentNode.nodeName&&(t=t.parentNode),"a"===t.nodeName&&t.hasAttribute("href")&&!t.hasAttribute("rel"))if(t.hasAttribute("target"))window.open(t.getAttribute("href"),t.getAttribute("target"));else document.location.href=t.getAttribute("href")}),this.hoverStatesEnabled&&this.enableSVGHoverStates()),this.tetherPairs={},this.tetherPairs[-1]={el:document.body,svgs:[]},this.tetherPairs[0]={el:this.pageView.el.querySelector(".page_content"),svgs:[]},_.each(this.pageView.el.querySelectorAll(".page_content [data-marker-id]"),function(e){var t=parseInt(e.getAttribute("data-marker-id"));if(!isNaN(t)&&e instanceof HTMLElement&&null==this.tetherPairs[t]){this.tetherPairs[t]={el:e,svgs:[]};var i=$(e).closest(".image-gallery")[0];i&&("slideshow"!==i.getAttribute("image-gallery")&&(this.tetherPairs[t].el=this.tetherPairs[t].el.parentNode),i.classList.contains("initialized")||(this.tetherPairs[t].galleryInitInProgress=!0))}},this),_.each(e.querySelectorAll("*"),function(e){if(!0===e.hasAttribute("data-marker-id")){var t=parseInt(e.getAttribute("data-marker-id"));!isNaN(t)&&e instanceof SVGElement&&this.tetherPairs.hasOwnProperty(t)&&(e.style.willChange="transform",this.tetherPairs[t].galleryInitInProgress?e.style.visibility="hidden":e.style.visibility="",this.tetherPairs[t].svgs.push({el:e,positionData:JSON.parse(e.getAttribute("data-position"))}))}},this),this.tetherPairs},Cargo.Core.MarkerInstance.prototype.positionTetheredNodes=function(){if(this.svg_overlay){var e,t,i,n,o,a,r,s,l,d,c,h,u,g,p,m,f,v=getComputedStyle(this.svg_overlay),b=this.svg_overlay.getBoundingClientRect(),y=b.left+this.resizedSVGOffsetX+parseFloat(v.paddingLeft),w=b.top+this.resizedSVGOffsetY+parseFloat(v.paddingTop);_.each(this.tetherPairs,function(v,b){if(v.svgs.length>0&&v.el){var _,C=v.el.getBoundingClientRect();for(_=0;_<v.svgs.length;_++){e=v.svgs[_];try{t=e.el.getBBox()}catch(e){return void console.warn("unable to retrieve bbox")}if(i=0,n=t.x,o=t.y,a=n+y+this.resizedSVGOffsetX,r=o+w+this.resizedSVGOffsetY,s=e.positionData.left*C.width,l=e.positionData.top*C.height,d=e.positionData.width*C.width,c=e.positionData.height*C.height,h=d/t.width,u=c/t.height,h<0&&(s-=d),u<0&&(l-=c),g=C.left+s,p=C.top+l,m=g-a,f=p-r,!isNaN(h)&&isFinite(h)&&0!==h||(h=1),!isNaN(u)&&isFinite(u)&&0!==u||(u=1),0!=b&&-1!=b||"text"!==e.el.nodeName&&(u=h),e.el.hasAttribute("data-rotation")&&(i=parseFloat(e.el.getAttribute("data-rotation")),isNaN(i)&&(i=0)),!isNaN(m)&&!isNaN(f)){e.el.setAttribute("transform","translate("+(n+m)+", "+(o+f)+") scale("+h+", "+u+") translate("+-1*n+", "+-1*o+")"),e.el.__marker_scale__=h;var S=e.el.getCTM(),k="";if(S&&(0!==i&&(k="rotate("+i+" "+(n+m+t.width*h/2+this.resizedSVGOffsetX)+" "+(o+f+t.height*u/2+this.resizedSVGOffsetY)+") "),k+="matrix("+S.a+", "+S.b+", "+S.c+", "+S.d+", "+S.e+", "+S.f+")",e.el.setAttribute("transform",k)),"object"==typeof svgedit){var x=svgedit.transformlist.getTransformList(e.el);x&&x.reload&&x.reload()}}}}},this),this.resizeSVGToFitContent(),this.pageView.trigger("marker-tether-position-update",this)}},Cargo.Event.on("pageview-initialized",function(e){e.markerInstance=new Cargo.Core.MarkerInstance(e)})}(),window.partial=function(e,t){return _.template(e)(t)},String.prototype.toCamel=function(e){var t=this.replace(/((\_|\-)[a-z])/g,function(e){return e.toUpperCase().replace(/(\_|\-)/g,"")});return e?t.substr(0,1).toUpperCase()+t.substr(1):t};var lastT=0,timer=null;function doscroll(e,t,i){var n=e-t;return i+=(i+n/36)/n,newY=1==i?t+n:t+n*(1-Math.pow(2,-20*i/1)),i&&window.scrollTo(0,newY),i>=1||lastT==i||!i?clearTimeout(timer):timer=setTimeout("doscroll("+e+","+t+","+i+")",1),lastT=i,!1}function number_format(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var o=isFinite(+e)?+e:0,a=isFinite(+t)?Math.abs(t):0,r=void 0===n?",":n,s=void 0===i?".":i,l="";return(l=(a?function(e,t){var i=Math.pow(10,t);return""+(Math.round(e*i)/i).toFixed(t)}(o,a):""+Math.round(o)).split("."))[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(l[1]||"").length<a&&(l[1]=l[1]||"",l[1]+=new Array(a-l[1].length+1).join("0")),l.join(s)}function getQueryStringParam(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}$.fn.toggleInputError=function(e){return this.parent().toggleClass("error",e),this},window.loading_animation=function(e){return _.template($("#loading_animation").html())({extra_class:e}).replace("{{ extra_class }}","")},Cargo.o.model.css=Backbone.Model.extend({initialize:function(){},url:function(){var e=Cargo.API.Config;return e.api_path+"/"+e.Version+"/css/"+e.cargo_url}}),Cargo.o.model.set=Backbone.Model.extend({constructor:function(){Backbone.Model.prototype.constructor.apply(this,arguments)},name:"Set",url:function(){return Cargo.API.GetSingleContentPath(this.id)},initialize:function(){if(this.type="set",this.attributes.pages){this.attributes.pages=new Cargo.o.collection.content(this.attributes.pages),this.attributes.pages.server_page_count=this.get("page_count"),this.attributes.pages.each(function e(t){t&&t.attributes.pages&&!t.attributes.pages instanceof Backbone.Collection&&(t.attributes.pages=new Cargo.o.collection.content(t.attributes.pages),t.attributes.pages.server_page_count=t.get("page_count"),t.attributes.pages.each(e))})}},getModelAtIndex:function(e){return _.filter(this.get("pages").filter(Cargo.Helper.IsIndexableModel),function(t){return t.get("index")==e})[0]},recursivelyFindMissingIndexesInSet:function(e,t){var i={};if(!e||isNaN(e))return i;return t||(t={}),function n(o,a){for(var r=o.get("pages"),s=r.getMissingIndexes().reverse(),l=[],d=0;d<r.models.length;d++)if("set"===r.models[d].type){if(t.limit&&t.limit.set===o.get("id")&&r.models[d].get("index")>t.limit.index)break;for(var c=r.models[d].get("index"),h=s.length-1;h>=0&&s[h]<c&&e>0;h--)l.push(s[h]),s.splice(h,1),e--;if(!1===n.call(this,r.models[d],a+1)){if(a>0)return!1;e=0;break}}if(e>0){var u=s.reverse().slice(0,e);t.limit&&t.limit.set===o.get("id")&&(u=u.filter(function(e){return e<=t.limit.index})),e-=u.length,l=l.concat(u)}if(l.length>0&&(i[o.get("id")]={indexes:l,model:o}),t.limit&&t.limit.set===o.get("id"))return!1}.call(this,this,0),i},paginate:function(e){if(e||(e={}),!this.paginating){if(_.extend(e,{render_changes:!0}),this.get("__tag__"))return this.paginating=!0,void Cargo.View.Content.activeContentModel.get("pages").fetch({render_changes:!0,remove:!1,from_pagination:!0,success:_.bind(function(e,t,i){this.paginating=!1,Cargo.Event.trigger("tag_pagination_complete",e,t,i),this.trigger("tag_pagination_complete",e,t,i)},this)});var t=this.recursivelyFindMissingIndexesInSet(!isNaN(parseInt(e.pagination_count))&&e.pagination_count>=0?parseInt(e.pagination_count):5);this.paginateWithMissingIndexObject(t,e)}},paginateWithMissingIndexObject:function(e,t){t||(t={}),_.extend(t,{from_pagination:!0});var i=0,n=[];this.paginating=!0,_.each(e,function(e){var o=e.model.loadIndexes(e.indexes,t);o&&(i++,o.always(_.bind(function(e){n=n.concat(e),0===--i&&(this.paginating=!1,t.done&&t.done(n),$('[data-loading="page"]').hide(),Cargo.Event.trigger("pagination_complete",this,n,t))},this)))},this),0===i?this.paginating=!1:($('[data-loading="page"]').show(),Cargo.Event.trigger("pagination_start"))},loadIndexes:function(e,t){if(t||(t={}),_.extend(t,{remove:!1,merge:!1}),e.length>0){var i=!1;if(Cargo.Helper.IsAdminProjectListSorting()&&top&&top.Cargo&&top.Cargo.Collection.AdminList){i=!0;var n,o=[];if(_.each(e,function(e){(n=top.Cargo.Collection.AdminList.filter(function(t){return Cargo.Helper.IsIndexableModel(t)&&t.get("index")===e&&t.get("set_id")===this.get("id")},this)[0])&&o.push(n.get("id"))},this),o.length>0){var a=$.ajax({method:"GET",url:Cargo.API.GetPagesPath()+"?pid_list="+o.join(","),dataType:"json"});return a.done(function(e){_.each(e,function(e){(n=top.Cargo.Collection.AdminList.findWhere({id:e.id}))&&(e.sort=n.get("sort"),e.index=n.get("index"),e.set_id=n.get("set_id"),e.display=n.get("display"),e.reverse_index=n.get("reverse_index")),Cargo.Collection.Scaffolding.insertModel(e,this,t)})}),a}}if(!i)return this.get("pages").url=Cargo.API.GetContentCollectionPath()+"?set_id="+this.get("id")+"&index="+e.join(","),this.get("pages").fetch(t)}},fetchModelAtIndex:function(e,t){if(!0===isNaN(e=parseInt(e)))return!1;if(t||(t={}),!0!==t.ignore_cache){var i=this.getModelAtIndex(e);if(i)return void(t.done&&t.done(i,t))}return _.extend(t,{remove:!1,merge:!1,success:_.bind(function(e,t,i){if(t&&t[0]&&t[0].id){var n=e.get(t[0].id);n&&(Cargo.Collection.Scaffolding.insertModel(n,e,i),i.done&&i.done(n,i))}else i.error&&i.error()},this)}),this.get("pages").url=Cargo.API.GetContentCollectionPath()+"?set_id="+this.get("id")+"&index="+e,this.get("pages").fetch(t)},toJSON:function(e){var t=_.clone(this.attributes);return function e(t){t.pages&&(void 0!==t.pages.models&&(t.pages=t.pages.toJSON()),_.each(t.pages,e))}(t),t}}),Cargo.o.model.page=Backbone.Model.extend({constructor:function(){Backbone.Model.prototype.constructor.apply(this,arguments)},initialize:function(){this.type="page",this.busySendingValues=!1,this.saveValueQueue=[],null!=this.get("page_options")&&"object"==typeof this.get("page_options")||(this.attributes.page_options={}),this.on("change:images",this.addImagesToGlobalCollection,this),this.addImagesToGlobalCollection(),this.on("change:title",function(){void 0!==Cargo.contentWindow&&Cargo.contentWindow.Cargo.Event.trigger("page_model_change:title",this.get("id"),this.get("title"))})},addImagesToGlobalCollection:function(){if(Cargo.Collection.Images&&this.get("images")){var e=Cargo.Collection.Images.add(this.get("images"));this.attributes.images=e}},toJSON:function(e){var t=_.clone(this.attributes);return function e(t){t.pages&&(void 0!==t.pages.models&&(t.pages=t.pages.toJSON()),_.each(t.pages,e))}(t),t},url:function(){return Cargo.API.GetSinglePagePath(this.id)},saveValue:function(e,t,i){if(!0!==i&&this.set(e),this.busySendingValues){console.info("saveValue, still handling previous request. Queuing.",e);var n=_.where(this.saveValueQueue,{keys:_.keys(e).join(",")})[0];return n?(n.data=e,n.callback=t,!1):(this.saveValueQueue.push({data:e,callback:t,keys:_.keys(e).join(",")}),!0)}return this.busySendingValues=!0,this.save(e,{patch:!0,success:_.bind(function(){t&&t.call(),this.busySendingValues=!1,this.saveValueQueue.length>0&&(this.saveValue(this.saveValueQueue[0].data,this.saveValueQueue[0].callback,!0),this.saveValueQueue.shift()),e.hasOwnProperty("title")&&this.fetch()},this)}),!0},GetThumbnailCropData:function(){var e=this.get("thumb_meta");return e?e.thumbnail_crop:null},SetThumbnailCropData:function(e){var t=this.get("thumb_meta")||{};t.thumbnail_crop=e,this.set("thumb_meta",t)},GetId:function(){return this.get("id")},GetProjectUrl:function(){return this.get("project_url")},GetType:function(){return!(!this.get("type")||0==this.get("id"))&&this.get("type")},GetBgColor:function(){return!!this.get("bgcolor")&&"#"+this.get("bgcolor")},setPageOption:function(e,t,i){return null!=this.get("page_options")&&"object"==typeof this.get("page_options")||(this.attributes.page_options={}),this.get("page_options")[e]=t,this.set("page_options",this.get("page_options"),i)},getPageOption:function(e){if(null!=this.get("page_options")&&"object"==typeof this.get("page_options"))return this.get("page_options")[e]},setPinOptions:function(e,t){var i;(i=this.getPageOption("pin_options"))||(i={}),i[e]=t,this.setPageOption("pin_options",i),(i=this.get("pin_options"))||(i={}),i[e]=t,this.set("pin_options",i),this.set("pin_changed",!0),this.trigger("pin_option_change",e,t)},getPinOption:function(e){if(null!=this.get("pin_options")&&"object"==typeof this.get("pin_options"))return this.get("pin_options")[e]},getLayoutOption:function(e){var t=this.getPageOption("local_layout_options");return t&&e in t?t[e]:t},setLayoutOption:function(e,t,i){var n=this.getPageOption("local_layout_options");return n||(n={}),n[e]=t,this.setPageOption("local_layout_options",n,i)},getThumbnailOption:function(e){var t=this.getPageOption("thumbnail_options");if(t&&e in t)return t[e]},setThumbnailOption:function(e,t){var i=this.getPageOption("thumbnail_options");if(i||(i={}),i[e]!==t){i[e]=t,this.setPageOption("thumbnail_options",i);var n={changing:e,value:t,mobile:!1};this.trigger("change",this,n)}},isFullyPopulated:function(){return this.attributes.hasOwnProperty("thumb")}}),Cargo.o.model.pin=Backbone.Model.extend({constructor:function(){Backbone.Model.prototype.constructor.apply(this,arguments)},initialize:function(){var e=this.get("pageView").model,t=this.getDepth(e),i=e.get("pin_options").fixed;this.set({pageModel:e,depth:i?0:t,sort:e.get("sort"),page_padding:0}),this.addEventListeners()},getPinOptions:function(){return this.get("pageModel").get("pin_options")},getDepth:function(e){var t=0;if(e&&e.get("set_id"))for(;e&&0!=e.get("set_id");)e=Cargo.Collection.Scaffolding.getModel({id:e.get("set_id")}),t++;return t},addEventListeners:function(){var e=this.get("pageView"),t=this.get("pageModel"),i=this.collection;e.listenTo(t,"change:pin",function(){!1===this.model.get("pin")&&this.remove()}),e.listenTo(t,"pin_option_change",_.bind(function(n,o,a){var r=t.getPageOption("pin_options");if(e.$el.removeClass("overlay accommodate fixed exclude_mobile"),r){r.overlay&&e.$el.addClass("overlay"),r.accommodate&&e.$el.addClass("accommodate"),r.exclude_mobile&&e.$el.addClass("exclude_mobile"),r.fixed&&e.$el.addClass("fixed");var s=this.getDepth(t),l=this.getPinOptions().fixed;this.set("depth",l?0:s)}i.trigger("update"),this.trigger("formatting_update_required")},this)),e.listenTo(e,"remove",function(){!0!==this.__prevent_model_removal__&&i.remove(this.model.get("id"),{from_pageview_removal:!0})}),this.on("remove",function(e,t,i){i&&!0!==i.from_pageview_removal&&(e.get("pageView").__prevent_model_removal__=!0,e.get("pageView").remove(),delete e.get("pageView").__prevent_model_removal__)}),e.listenTo(t,"change:set_id",_.bind(function(){var e=this.getDepth(t),i=this.getPinOptions().fixed;this.set("depth",i?0:e)},this)),e.listenTo(t,"change:sort",_.bind(function(e,t,i){this.set("sort",t)},this))}}),Cargo.o.model.display_options=Backbone.Model.extend({fetch:function(e){$("script[data-set='DisplayOptions']").html()?this.set($.parseJSON($("script[data-set='DisplayOptions']").html()),e):Backbone.Model.prototype.fetch.apply(this,arguments)},url:function(){return Cargo.API.GetDisplayOptionsPath()},GetPaginationCount:function(){return this.get("pagination_count")},GetDisableProjectScroll:function(){return this.get("disable_project_scroll")},GetImageWidth:function(){return this.get("image_width")},GetIndexRouteUrl:function(){return this.get("index_route_url")},GetIndexRouteName:function(){return this.get("index_route_name")}}),Cargo.o.model.site=Backbone.Model.extend({fetch:function(e){!0!==(e=e||{}).force_admin_fetch&&$("script[data-set='Site']").html()?this.set($.parseJSON($("script[data-set='Site']").html()),e):Backbone.Model.prototype.fetch.apply(this,arguments)},parse:function(e){return Cargo.Helper.IsAdminEdit()||(e.is_editor=Cargo.Helper.GetIsEditor()),e},url:function(){var e=Cargo.API.GetSitePath();return""!=Cargo.API.Config.filter&&(e+="?filter="+encodeURIComponent(Cargo.API.Config.filter)),e},GetId:function(){return this.get("id")},GetPresetPreviewLink:function(e){return"//"+this.get("site_url")+"."+Cargo.Helper.GetBaseCargoDomain()+"/presetpreview/"+e},GetWebsiteTitle:function(){return this.get("website_title")},GetHomepageId:function(){return this.get("homepage_id")},GetIsEditor:function(){return this.get("is_editor")},GetUseHiRes:function(){var e=this.get("use_hi_res");return null==e&&(e=window.devicePixelRatio>1),e}}),Cargo.o.model.image=Backbone.Model.extend({initialize:function(){_.bindAll(this,"getImageByWidth")},urlRoot:function(){return"/_api/v0/image"},getImageByWidth:function(e){var t={};return e>this.get("width")&&(e=this.get("width")),t.w=e,this.getImageWithOptions(t).url},getImageByWidth2x:function(e){return this.getImageByWidth(2*e)},getImageWithOptions:function(e){var t={retina:!!window.devicePixelRatio&&window.devicePixelRatio>=1.2,square:!1,url:"",webgl:e.hasOwnProperty("t")&&"webgl"==e.t};if(_.extend(t,e),"original"===t.t&&(t.retina=!1),!0!==t.retina||t.webgl||(null==t.q&&(t.q=67),t.hasOwnProperty("w")&&(t.w=Math.min(2*t.w,this.get("width"))),t.hasOwnProperty("h")&&(t.h=Math.min(2*t.h,this.get("height")))),t.w&&t.w>this.get("width")&&(t.webgl?t.w=this.getValidWebGLSize(t.w):t.w=this.get("width")),t.h&&t.h>this.get("height")&&(t.h=this.get("height")),!0===t.square){var i=this.getSquareCrop();t.c={x:i.x,y:i.y,w:i.w,h:i.h}}var n=["t","w","h","q","c"],o=[],a=!1,r=!1;_.each(t,function(e,t){-1!==n.indexOf(t)&&""!==e&&("c"===t?o.push("c/"+e.x+"/"+e.y+"/"+e.w+"/"+e.h):o.push(t+"/"+e),a="w"==t?e:"c"==t&&e.w?e.w:a,r="h"==t?e:"c"==t&&e.h?e.h:r)},this);var s=this.getScaleSize(a,r);return t.w=s.w,t.h=s.h,void 0!==this.get("hash")&&void 0!==this.get("name")?t.url="//freight.cargo.site/"+o.join("/")+"/i/"+this.get("hash")+"/"+this.get("name"):t.url="",t},getSquareCrop:function(){var e=y=w=h=diff=0;return this.get("height")>this.get("width")?(w=h=this.get("width"),diff=this.get("height")-this.get("width"),y=Math.floor(diff/2),e=0):this.get("width")>this.get("height")?(w=h=this.get("height"),diff=this.get("width")-this.get("height"),e=Math.floor(diff/2),y=0):(w=this.get("width"),h=this.get("height"),e=y=0),{w:w,h:h,x:e,y:y}},getOriginalImage:function(){return this.getImageWithOptions({t:"original",retina:!1})},urlBelongsToImage:function(e){return"string"==typeof e&&-1!==e.indexOf(this.get("hash")+"/"+this.get("name"))},getValidWebGLSize:function(e){return e>this.get("width")&&_.each([128,256,512,1024,2048,4096],function(t){t<1e3&&(e=t)}),e},getScaleSize:function(e,t){var i=e,n=t;if(og_w=parseInt(this.get("width")),og_h=parseInt(this.get("height")),e&&t);else if(og_w==og_h)n=i=e||(t||og_w);else if(e){var o=og_w/e;n=Math.floor(og_h/o),i=e}else if(t)o=og_h/t,i=Math.floor(og_w/o),n=t;return{w:i,h:n}},getFitSize:function(e,t,i,n){if(e=parseInt(e),(t=parseInt(t))>e)var o=e/i,a=Math.floor(t/o),r=i;else if(e>t)o=t/n,r=Math.floor(e/o),a=n;else r=e,a=t;return[r,a]}}),Cargo.o.model.localImage=Cargo.o.model.image.extend({blob_references:{},canvas:null,initialize:function(){this.blob_references={},this.canvas=document.createElement("canvas"),_.bindAll(this,"getImageByWidth")},urlRoot:function(){return""},getImageWithOptions:function(e){var t=Cargo.o.model.image.prototype.getImageWithOptions.apply(this,arguments),i=["t","w","h","q","c"],n=[],o=!1,a=!1;_.each(t,function(e,t){-1!==i.indexOf(t)&&""!==e&&("c"===t?n.push("c_"+e.x+"_"+e.y+"_"+e.w+"_"+e.h):n.push(t+"_"+e),o="w"==t?e:"c"==t&&e.w?e.w:o,a="h"==t?e:"c"==t&&e.h?e.h:a)},this);var r=n.join("_");if(this.blob_references.hasOwnProperty(r))t.url=this.blob_references[r];else{if("original"==t.t)this.canvas.setAttribute("width",this.get("width")),this.canvas.setAttribute("height",this.get("height")),this.canvas.getContext("2d").drawImage(this.get("img"),0,0,this.get("width"),this.get("height"));else if(t.hasOwnProperty("c")){var s=Math.max(Math.min(t.c.w,this.get("width")-t.c.x),0),l=Math.max(Math.min(t.c.w,this.get("height")-t.c.y),0);this.canvas.setAttribute("width",s),this.canvas.setAttribute("height",l),this.canvas.getContext("2d").drawImage(this.get("img"),-t.c.x,-t.c.y,this.get("width"),this.get("height"))}else t.webgl?(this.canvas.setAttribute("width",t.webgl),this.canvas.setAttribute("height",t.webgl),this.canvas.getContext("2d").drawImage(this.get("img"),0,0,t.webgl,t.webgl),this.canvas.setAttribute("width",t.w),this.canvas.setAttribute("height",t.h),this.canvas.getContext("2d").drawImage(this.get("img"),0,0,t.w,t.h)):(this.canvas.setAttribute("width",t.w),this.canvas.setAttribute("height",t.h),this.canvas.getContext("2d").drawImage(this.get("img"),0,0,t.w,t.h));this.canvas.toBlob(_.bind(function(e){this.blob_references[r]=URL.createObjectURL(e)},this)),t.url=this.canvas.toDataURL()}return t},urlBelongsToImage:function(e){if("string"!=typeof e)return!1;var t=!1;return _.each(this.blob_references,function(i,n){i!=e||(t=!0)},this),t}}),Cargo.o.model.tag=Backbone.Model.extend({initialize:function(){this.responseCache={},this.isAdmin=Cargo.Helper.IsAdminEdit()},tag_url:"",url:function(){return Cargo.API.GetSitePath()+"/tags/"+this.tag_url},fetch:function(e){e=e||{},_.defaults(e,{});var t=this.url();if(this.responseCache.hasOwnProperty(t))return this.set(this.responseCache[t]),this.trigger("sync"),void("function"==typeof e.success&&e.success.call(e.context,this,this.responseCache[t],e));e.success=_.wrap(e.success,_.bind(function(i,n,o){!0!==this.isAdmin&&(this.responseCache[t]=o);var a=Array.prototype.slice.call(arguments);a.shift(),i&&i.apply(e.context,a)},this)),Backbone.Model.prototype.fetch.apply(this,arguments)}}),Cargo.o.model.thumbnailsettings=Backbone.Model.extend({page_id:null,mode_id:null,iterator:null,initialize:function(e){this.page_id=e&&e.page_id?e.page_id:this.page_id,this.mode_id=e&&e.mode_id?e.mode_id:this.mode_id,this.iterator=e&&e.iterator?e.iterator:this.iterator},fetch:function(e){$("script[data-set='ThumbnailSettings']").html()?(this.set($.parseJSON($("script[data-set='ThumbnailSettings']").html()),e),$("script[data-set='ThumbnailSettings']").remove()):Backbone.Model.prototype.fetch.apply(this,arguments)},url:function(){return Cargo.API.GetActiveThumbnailSettingsPath(this.page_id,this.mode_id,this.iterator,this.id)},getTemplatePath:function(e){return"/_jsapps/thumbnails/"+(e=e||this.get("path"))+"/thumbnail.handlebars"},setThumbMeta:function(e,t){window.parent.Cargo.Event.trigger("thumbnail:add_meta_data",e,t)}}),Cargo.o.collection.content=Backbone.Collection.extend({name:"Content",constructor:function(){this.server_page_count=0,this.on("add",function(e,t,i){i.from_admin_sort&&Cargo.Helper.IsIndexableModel(e)&&this.server_page_count++},this),this.on("remove",function(e,t,i){i.from_admin_sort&&Cargo.Helper.IsIndexableModel(e)&&this.server_page_count--},this),Backbone.Collection.prototype.constructor.apply(this,arguments)},initialize:function(){},comparator:"sort",model:function(e,t){return new Cargo.o.model[e.pages?"set":"page"](e,t)},isGlobal:!0,CollectionData:{},url:function(){return Cargo.API.GetPagesPath()},LoadCollection:function(e){if(!1!==Cargo.Helper.isFeed()&&(!0!==this.isGlobal||"global"!=e))if(e&&this.CollectionData[e])this.set(this.CollectionData[e]),!1===this.isGlobal&&"global"!=e?(this.trigger("sync"),this.isGlobal=!0):!0===this.isGlobal&&"global"!=e&&(this.trigger("sync"),this.isGlobal=!1);else if(e)this.tags=e,this.fetch(),this.tags=null,this.isGlobal=!1;else{if(!0===this.isGlobal)return;this.set(this.CollectionData.global),this.trigger("sync"),this.isGlobal=!0}},getLoadedIndexes:function(){return _.without(this.map(function(e){if(Cargo.Helper.IsIndexableModel(e))return e.get("index")},this),void 0)},getMissingIndexes:function(e){for(var t=this.getLoadedIndexes(),i=[],n=0;n<this.server_page_count;){if(e&&n>e)return i;-1==t.indexOf(n)&&i.push(n),n++}return i},missingNumInSequence:function(e,t,i){if(void 0!==e&&void 0!==e.length){if(void 0===t&&(t=0),void 0===i&&(i=e.length),t>=i)return t;var n=Math.floor((t+i)/2);return e[n]===n?this.missingNumInSequence(e,n+1,i):this.missingNumInSequence(e,t,n)}},getFirstIndexGap:function(){var e=_.uniq(this.getLoadedIndexes(),!0);return this.missingNumInSequence(e)},each:function(e,t,i){if(!i)return Backbone.Collection.prototype.find.apply(this,arguments);(function i(n){n.each(e,t);for(var o=0;o<n.models.length;o++)"set"===n.models[o].type&&i(n.models[o].get("pages"))})(this)},getContentOrPageModelByPid:function(e,t){var i=this.getModel({id:e});return i&&t&&i.parent_model&&i.parent_model.get("stack")&&(i=i.parent_model),i},getContentOrPageModelByPurl:function(e,t){var i=this.getModel({project_url:e});if(!i){var n=this.getModel({project_url:e});n&&t&&n.parent_model&&n.parent_model.get("stack")&&(i=n.parent_model)}return i},getModel:function(e){return this.findWhere(e,!0)},getHomePageModel:function(){return this.getContentOrPageModelByPid(Cargo.Helper.GetHomepageId())},getAllContentPageIds:function(){var e=this.reject(function(e){if(e.get("pin")||0==e.get("pages").length)return e});return _.pluck(e,"id")},fetchPageModel:function(e){var t=this;return new Cargo.o.model.set({id:e}).fetch({error:function(i,n){try{if("no pid found"===$.parseJSON(n.responseText).message.toLowerCase()){var o=Cargo.Collection.Tags.findTagByUrl(e);o?(t.LoadCollection(o.get("url")),Cargo.Event.trigger("thumbnails:load_tag",o.get("url")),Cargo.View.Content.hideActiveView()):(Cargo.Modal.Alert({message:"Page Not Found",confirm:function(){window.history.back()}}),Cargo.Helper.HideLoadingAnimation())}}catch(e){console.error("unable to fetch",i)}},success:function(e,i,n){"set"===e.type&&void 0===e.get("pages")&&(e=new Cargo.o.model.page(e.toJSON())),t.insertModel(e,i,n)}})},insertModel:function(e,t,i){if(e.get("set_id")){var n=this.getModel({id:e.get("set_id")});if(n)return n.get("pages").add(e),n.get("pages").sort(),this.trigger("add",e,t,i),void this.trigger("offline_model_loaded",e)}this.add(e),this.trigger("offline_model_loaded",e)},removeNonVisiblePages:function(){var e=_.filter(this.getAllPages(),function(e){return!1===e.get("display")&&!1===e.get("pin")});_.each(_.pluck(e,"id"),_.bind(function(e){var t=this.findWhere({id:e});if(t&&!t.get("is_set"))this.remove(t,{silent:!0});else{var i=this.findWhere({id:e},!0);i&&(1==i.parent_model.get("pages").length?this.remove(i.parent_model,{silent:!0}):i.parent_model.get("pages").remove(i,{silent:!0}))}},this))},findWhere:function(e,t){return t=t||!1,this.where(e,!0,t)},where:function(e,t,i){return(i=i||!1)?this[t?"find":"filter"](e,i):Backbone.Collection.prototype.where.call(this,e,t)},find:function(e,t){if(t=t||!1){var i,n;return function t(o){if(i=o.findWhere(e))(n=i).parent_model=o;else for(var a=0;a<o.models.length;a++)if("set"===o.models[a].type){if(i=o.models[a].get("pages").findWhere(e)){(n=i).parent_model=o.models[a];break}"set"===o.models[a].type&&t(o.models[a].get("pages"))}}(this),n}return Backbone.Collection.prototype.find.call(this,e)},getAllPages:function(e){var t=[];return function i(n){for(var o=0;o<n.models.length;o++)"page"!==n.models[o].type?n.models[o].get("pages")&&n.models[o].get("pages").models&&(e&&"set"===n.models[o].type&&t.push(n.models[o]),i(n.models[o].get("pages"))):t.push(n.models[o])}(this),t},filter:function(e,t){if(t=t||!1){var i=[];return function t(n){i=_.union(i,n.filter(e));for(var o=0;o<n.models.length;o++)"set"===n.models[o].type&&t(n.models[o].get("pages"))}(this),i}return Backbone.Collection.prototype.filter.call(this,e)}}),Cargo.o.collection.scaffolding=Backbone.Collection.extend({name:"Scaffolding",constructor:function(){Backbone.Collection.prototype.constructor.apply(this,arguments)},comparator:"sort",model:function(e,t){return new Cargo.o.model[e.pages?"set":"page"](e,t)},url:function(){return Cargo.API.GetPagesPath()},initialize:function(){this.fetchPageModelCache={},this.isAdmin=Cargo.Helper.IsAdminEdit()},applyAdminlistChangeMap:function(e,t){var i,n={};this.each(function(t){void 0!==e[t.get("id")]&&(void 0!==(i=e[t.get("id")]).sort&&t.set("sort",i.sort,{from_admin_sort:!0}),void 0!==i.index&&t.set("index",i.index,{from_admin_sort:!0}),void 0!==i.reparented&&(n[t.get("id")]={new_set:i.reparented.to,model:t}),delete e[t.get("id")])},this,!0),_.each(n,function(e,t){var i=e.model,n=this.getModel({id:i.get("set_id")}),o=this.getModel({id:e.new_set});void 0!==n&&void 0!==o&&(n.get("pages").remove(i,{from_admin_sort:!0}),i.set("set_id",o.get("id")),this.insertModel(i,this,{from_admin_sort:!0,render_changes:!0}))},this),_.each(e,function(e){if(void 0!==e.reparented&&e.reparented.indexable){var t=this.getModel({id:e.reparented.from}),i=this.getModel({id:e.reparented.to});t&&t.get("pages").server_page_count--,i&&i.get("pages").server_page_count++}},this),Cargo.View.Content.currentSet&&(_.each(_.union([Cargo.View.Content.currentSet],Cargo.View.Content.currentSet.getAllSetViews()),function(e){e.sortPagesAndUpdateDOM()}),_.each(Cargo.View.Content.currentSet.getAllPageViews(),function(e){e.addBackdrop()}),"display_state"!==t&&Cargo.View.Content.fillGapsInCurrentSet()),Cargo.Event.trigger("refresh_pins")},fetch:function(e){if($("[data-set='ScaffoldingData']").length>0){var t=JSON.parse($("[data-set='ScaffoldingData']").html());this.set(t),$("[data-set='ScaffoldingData']").remove()}else Backbone.Collection.prototype.fetch.apply(this,arguments)},parse:function(e,t){return _.each(e,function(e){var i=this._prepareModel(e,t);i&&this.insertModel(i,this,t)},this),[]},LoadTagCollection:function(e){var t=new Cargo.o.model.set({id:e.get("url"),pages:[],project_url:e.get("url"),__tag__:e.get("url"),title:e.get("tag")});!1===Cargo.Helper.isFeed()?(t.get("pages").url="",t.get("pages").fetch=function(){console.info("no paginate for non-feed tags")},Cargo.View.Content.render(t),Cargo.Event.trigger("thumbnails:load_tag",e.get("url")),Cargo.View.Main.SetWindowTitle()):(t.__offset=0,t.__increment=5,t.get("pages").url=function(){var e=Cargo.API.GetPagesPath(t.get("__tag__"),t.__offset,t.__increment);return t.__offset+=t.__increment,e},t.get("pages").on("add",function(e){this.insertModel(e,this,{render_changes:!1})},this),t.attributes.pages.fetch({success:function(e){Cargo.View.Content.render(t),Cargo.View.Main.SetWindowTitle()}}))},getSetOrPageModel:function(e,t){var i=this.getModel(e);return i&&t&&i.parent_model&&i.parent_model.get("stack")&&(i=i.parent_model),i},getContentOrPageModelByPid:function(e,t){var i=this.getModel({id:e});return i&&t&&i.parent_model&&i.parent_model.get("stack")&&(i=i.parent_model),i},getModelByPurl:function(e,t){if(void 0!==e){var i=this.filter(function(t){return"string"==typeof t.get("project_url")&&t.get("project_url").toLowerCase()===(e+"").toLowerCase()},!0)[0];return i&&t&&i.parent_model&&i.parent_model.get("stack")&&(i=i.parent_model),i}},getModel:function(e){return this.findWhere(e,!0)},getHomePageModel:function(){return this.getContentOrPageModelByPid(Cargo.Helper.GetHomepageId())},getAllContentPageIds:function(){var e=this.reject(function(e){if(e.get("pin")||0==e.get("pages").length)return e});return _.pluck(e,"id")},getPinsByPositionSetId:function(e,t){if(Number(t)){var i=[];if(!(n=this.getModel({id:t})))return;if("page"===n.type){if(0===n.get("set_id"))return;if(!(n=this.getModel({id:n.get("set_id")})))return}for(i=i.concat(n.get("pages").models);n&&0!=n.get("set_id")&&0!=n.get("id");)(n=this.getModel({id:n.get("set_id")}))&&n.get("pages")&&(i=i.concat(n.get("pages").models));return _.filter(i,function(t){return t.get("pin")&&t.get("pin_options")&&t.get("pin_options").position==e})}if(!1===t){var n;i=[];return(n=this.getModel({id:0})).get("pages").filter(function(t){return t.get("pin")&&t.get("pin_options")&&t.get("pin_options").position==e})}},fetchPageModel:function(e,t){console.info("loading async",e);var i=this.fetchPageModelCache[e];if(i)return console.info("located in cache",e),this.insertModel(i,this,t),void(t.done&&t.done(i,t));var n,o=this;return n=new Cargo.o.model.set({id:e}),t||(t={}),_.extend(t,{error:function(t,i){try{if(404==i.status){var n=Cargo.View.Content.getActiveContentModel();n&&n.get("is_set")&&n.get("id");var a=Cargo.Collection.Tags.findTagByUrl(e);a?o.LoadTagCollection(a):(Cargo.Modal.Alert({message:"Page Not Found",confirm:function(){window.event&&27===window.event.keyCode||window.history.back()}}),Cargo.Helper.HideLoadingAnimation())}else 401==i.status&&window.location.replace(window.location.href)}catch(e){console.error(e),console.warn("unable to fetch",t)}},success:function(t,i,n){if(Cargo.Helper.IsAdminProjectListSorting()&&top&&top.Cargo&&top.Cargo.Collection.AdminList){var a=top.Cargo.Collection.AdminList.findWhere({id:t.get("id")});a&&(t.attributes.sort=a.get("sort"),t.attributes.index=a.get("index"),t.attributes.set_id=a.get("set_id"),t.attributes.display=a.get("display"))}"set"===t.type&&void 0===t.get("pages")&&(t=new Cargo.o.model.page(t.toJSON()),o.isAdmin||(o.fetchPageModelCache[e]=t)),o.insertModel(t,o,n),n.done&&n.done(t,n)}}),n.fetch(t)},insertModel:function(e,t,i){var n=e;if("function"==typeof e.get&&(n=e.attributes),void 0!==n.set_id){var o=this.getModel({id:n.set_id});if(o){var a=o.get("pages");if(a.get(e))return;return a.add(e,i),a.sort(),e.collection=a,void this.trigger("add",e,a,i)}}this.add(e)},removeNonVisiblePages:function(){non_visible=_.filter(this.getAllPages(),function(e){return!1===e.get("display")&&!1===e.get("pin")&&!1===e.get("is_homepage")}),_.each(non_visible,function(e){this.getModel({id:e.get("set_id")}).get("pages").remove(e)},this)},changeDisplayStateForPID:function(e,t){var i=this.getModel({id:e});i?(i.set("display",t),!1===t&&this.getModel({id:i.get("set_id")}).get("pages").remove(i)):this.fetchPageModel(e,{render_changes:!0})},findWhere:function(e,t){return t=t||!1,this.where(e,!0,t)},where:function(e,t,i){return(i=i||!1)?this[t?"find":"filter"](e,i):Backbone.Collection.prototype.where.call(this,e,t)},logIndexStructure:function(){console.log("\n----\n\n"),function e(t,i){t.getMissingIndexes;for(var n=0;n<t.models.length;n++)Cargo.Helper.IsIndexableModel(t.models[n])&&(console.log("---".repeat(i)+"index:",t.models[n].get("index"),"sort:",t.models[n].get("sort"),"-",t.models[n].type+":",t.models[n].get("title").substring(0,70)),"set"===t.models[n].type&&e(t.models[n].get("pages"),i+1))}(this,0)},getSetStructure:function(e){var t={tree:void 0,_byId:{}},i=function(n,o){for(var a=0;a<n.length;a++)n[a].pages&&(e&&!0!==e(n[a])||(t._byId[n[a].id]=n[a]),n[a].depth=o,n[a].pages=_.where(n[a].pages,{is_set:!0}),i(n[a].pages,o+1))};return i(this.toJSON(),0),t.tree=t._byId[0],t},each:function(e,t,i){if(!i)return Backbone.Collection.prototype.find.apply(this,arguments);(function i(n){n.each(e,t);for(var o=0;o<n.models.length;o++)"set"===n.models[o].type&&i(n.models[o].get("pages"))})(this)},find:function(e,t){if(t=t||!1){var i,n;return function t(o){if(i=o.findWhere(e))(n=i).parent_model=o;else for(var a=0;a<o.models.length;a++)if("set"===o.models[a].type){if(i=o.models[a].get("pages").findWhere(e)){(n=i).parent_model=o.models[a];break}"set"===o.models[a].type&&t(o.models[a].get("pages"))}}(this),n}return Backbone.Collection.prototype.find.call(this,e)},getAllPages:function(e){var t=[];return function i(n){for(var o=0;o<n.models.length;o++)"page"!==n.models[o].type?n.models[o].get("pages")&&n.models[o].get("pages").models&&(e&&"set"===n.models[o].type&&t.push(n.models[o]),i(n.models[o].get("pages"))):t.push(n.models[o])}(this),t},filter:function(e,t){if(t=t||!1){var i=[];return function t(n){i=_.union(i,n.filter(e));for(var o=0;o<n.models.length;o++)"set"===n.models[o].type&&t(n.models[o].get("pages"))}(this),i}return Backbone.Collection.prototype.filter.call(this,e)}}),Cargo.o.collection.images=Backbone.Collection.extend({model:function(e,t){return e&&"local"===e.type?new Cargo.o.model.localImage(e,t):new Cargo.o.model.image(e,t)},responseCache:{},initialize:function(){},url:function(){var e=!!this.options&&this.options.sort;return Cargo.API.GetImagesPath(e,!0,!0)},fetchNextPage:function(e){var t=this.url+"-"+this.length;this.fetch({remove:!1,data:{offset:this.length},success:_.bind(function(i,n,o){this.responseCache[t]=n,"function"==typeof e&&e(i,n,o)},this)})},fetch:function(e){var t=e&&e.data&&e.data.offset?e.data.offset:0,i=this.url+"-"+t;return this.responseCache.hasOwnProperty(i)?(0==t?this.set(this.responseCache[i]):this.add(this.responseCache[i]),"function"==typeof e.success&&e.success.call(e.context,this,this.responseCache[i],e),void this.trigger("sync",this,this.responseCache[i])):Backbone.Collection.prototype.fetch.apply(this,arguments)},getImagesWithoutDuplications:function(){var e=[];return this.filter(function(t){return-1===e.indexOf(t.get("hash"))&&(e.push(t.get("hash")),!0)})},fetchImage:function(e,t){var i=this.findWhere({id:parseInt(e)});if(i)return i.getImageWithOptions({w:t})},fetchWebGLImage:function(e,t){var i=this.findWhere({id:parseInt(e)});if(i)return i.getImageWithOptions({t:"webgl",w:t})},fetchOriginalImage:function(e){var t=this.findWhere({id:parseInt(e)});if(t)return t.getOriginalImage()}}),Cargo.o.collection.pins=Backbone.Collection.extend({model:Cargo.o.model.pin,comparator:function(e,t){var i=e.getPinOptions(),n=t.getPinOptions(),o=e.get("pageModel").get("sort"),a=t.get("pageModel").get("sort");if(e.get("depth")!==t.get("depth"))if("bottom"===this.position){if(e.get("depth")>t.get("depth"))return-1;if(e.get("depth")<t.get("depth"))return 1}else{if(e.get("depth")>t.get("depth"))return 1;if(e.get("depth")<t.get("depth"))return-1}else if(o!==a){if(i.overlay&&(this.position===this.reversedSide?o+=9e5:o-=9e5),n.overlay&&(this.position===this.reversedSide?a+=9e5:a-=9e5),o>a)return 1;if(o<a)return-1}return 0},initialize:function(e,t){this.position=t.position,this.reversedSide="bottom",this.pid_list=[],this.debouncedSort=_.debounce(this.sort,0),this.on("reset",this.onReset),this.on("add",this.onAdd),this.on("remove",this.onRemove),this.on("update reset change:sort change:depth",this.onChange)},sort:function(){Backbone.Collection.prototype.sort.apply(this,arguments)},onReset:function(e,t){_.each(t.previousModels,function(e){e.trigger("remove")})},onChange:function(e,t){this.sort(),this.pid_list=this.pluck("id"),this.levels={},this.deepestLevel=0,this.each(function(e){void 0===this.levels[e.get("depth")]&&(this.levels[e.get("depth")]={models:[]}),e.get("depth")>this.deepestLevel&&(this.deepestLevel=e.get("depth")),this.levels[e.get("depth")].models.push(e)},this)},onAdd:function(e,t,i){e.get("pageView").listenTo(e.get("pageModel"),"change:sort",_.bind(this.debouncedSort,this))},onRemove:function(e,t,i){}}),Cargo.o.collection.tags=Backbone.Collection.extend({initialize:function(){},url:function(){return Cargo.API.GetSitePath()+"/tags"},findTagByUrl:function(e){if("string"!=typeof e||""==e||0===e.indexOf("search/"))return!1;if(/(\s|,|\+|\~)/.test(e))return Cargo.Model.Tag.set("url",e),Cargo.Model.Tag;var t=!1;return Cargo.Model.Tag.tag_url=e,Cargo.Model.Tag.fetch({async:!1,success:function(e,i){t=0!==_.keys(i).length&&e}}),t},fetch:function(){if($("[data-set='TagsCollection']").length>0){var e=JSON.parse($("[data-set='TagsCollection']").html());this.set(e),$("[data-set='TagsCollection']").remove()}else Backbone.Collection.prototype.fetch.apply(this,arguments)}}),Cargo.o.collection.sitemenu=Backbone.Collection.extend({initialize:function(){Cargo.Event.on("page_model_change:title",_.bind(function(e,t){this.updatePageTitle(e,t)},this))},url:function(){var e=Cargo.Helper.IsAdminEdit()?"/inadmin":"";return Cargo.API.GetSitePath()+"/sitemenu"+e},fetch:function(e){if(!$("script[data-set='SiteMenu']").html())return Backbone.Collection.prototype.fetch.apply(this,arguments);this.set($.parseJSON($("script[data-set='SiteMenu']").html()),e),$("script[data-set='SiteMenu']").remove()},getAllPages:function(){var e=[];return void 0!==this.models[0]&&function t(i){_.each(i,function(i){i.hasOwnProperty("pages")?(e.push(i),t(i.pages)):e.push(i)})}(this.models[0].get("pages")),e},updatePageTitle:function(e,t){var i=_.filter(this.getAllPages(),function(t){return t.id==e});void 0!==i[0]&&(i[0].project_url=t,i[0].title=t)}}),Cargo.o.collection.thumbnailmodes=Backbone.Collection.extend({initialize:function(){},url:function(){return Cargo.API.GetThumbnailModesPath()},fetch:function(e){$("script[data-set='ThumbnailModes']").html()?this.set($.parseJSON($("script[data-set='ThumbnailModes']").html()),e):Backbone.Collection.prototype.fetch.apply(this,arguments)}}),Cargo.o.collection.thumbnails=Backbone.Collection.extend({initialize:function(e){this.paginating=!1,this.responseCache={},this.currentParams={},this.paginationIncrement=50,this.paginationComplete=!1,Cargo.Event.on("admin_page_update",_.bind(function(e,t){var i=this.findWhere({id:e});i&&i.set(JSON.parse(JSON.stringify(t)))},this)),Cargo.Event.on("thumbnails:clear_cache",function(){this.url=void 0,this.responseCache={}},this);var t=$("[data-set='FirstloadThumbnails']");if(t.length>0){var i=JSON.parse(t.html()),n={page_id:t.attr("data-page_id"),force_all:"all"===t.attr("data-filter_type")||void 0,tags:t.attr("data-tags"),set_id:t.attr("data-set_id"),random_limit:t.attr("data-random_limit"),offset:0,limit:this.paginationIncrement};void 0!==n.random_limit&&isNaN(parseInt(n.random_limit))&&(n.random_limit=10),i&&i.length?(this.url=Cargo.API.GetThumbnailsPath(n.page_id,n.force_all,n.tags,n.set_id,void 0,void 0,n.random_limit),this.responseCache[this.url]={data:i,offset:i.length,paginationComplete:i.length<this.paginationIncrement},this.currentParams=n):console.warn("Initial thumb data is invalid, not setting."),t.remove()}},paginate:function(){this.paginating||this.paginationComplete||void 0===this.currentParams.random_limit&&(this.paginating=!0,this.currentParams.offset+=this.paginationIncrement,$('[data-loading="page"]').show(),this.fetch({params:this.currentParams,remove:!1,from_pagination:!0,success:_.bind(function(e,t,i){$('[data-loading="page"]').hide(),this.paginating=!1,Cargo.Event.trigger("thumbnail_pagination_complete",e,t,i)},this),error:_.bind(function(){$('[data-loading="page"]').hide()},this)}))},applyAdminlistChangeMap:function(e,t,i){this.currentParams&&(this.currentParams&&void 0!==this.currentParams.random_limit||(void 0!==this.currentParams.set_id&&_.each(e,function(e,t){t=parseInt(t);var i=parseInt(this.currentParams.set_id);if(e.hasOwnProperty("reparented"))if(e.reparented.from==i)this.remove(t);else if(e.reparented.to==i&&top&&top.Cargo&&top.Cargo.Collection.AdminList){var n=top.Cargo.Collection.AdminList.findWhere({id:t});!0===n.get("display")&&!0===n.get("thumb_is_visible")&&this.add(n.toJSON())}},this),this.models.sort(function(e,t){return i.indexOf(e.id)-i.indexOf(t.id)}),Cargo.View.Thumbnail&&Cargo.View.Thumbnail.Subview&&Cargo.View.Thumbnail.Subview.render()))},fetch:function(e){e=e||{},_.defaults(e,{params:{}}),this.currentParams=e.params;var t,i=Cargo.API.GetThumbnailsPath(e.params.page_id,e.params.force_all,e.params.tags,e.params.set_id,void 0,void 0,e.params.random_limit);if(this.responseCache.hasOwnProperty(i)){if((t=this.responseCache[i]).paginationComplete||!0!==e.from_pagination)return this.paginationComplete=t.paginationComplete,this.set(this.responseCache[i].data),this.trigger("sync",this,this.responseCache[i].data,e),void("function"==typeof e.success&&e.success.call(e.context,this,this.responseCache[i].data,e));this.url=Cargo.API.GetThumbnailsPath(e.params.page_id,e.params.force_all,e.params.tags,e.params.set_id,t.offset,this.paginationIncrement)}if(this.url!==i)return t||(this.url=i),e.success=_.wrap(e.success,_.bind(function(n,o,a){void 0!==e.params.random_limit?this.paginationComplete=!0:this.paginationComplete=a.length<this.paginationIncrement,t?(t.data=_.union(t.data,a),t.paginationComplete=this.paginationComplete,t.offset+=a.length,this.set(t.data)):this.responseCache[i]={data:a,offset:0,paginationComplete:this.paginationComplete};var r=Array.prototype.slice.call(arguments);r.shift(),n&&n.apply(e.context,r)},this)),Backbone.Collection.prototype.fetch.apply(this,arguments)}}),Cargo.o.collection.thumbnailsettings=Backbone.Collection.extend({pid:null,model:Cargo.o.model.thumbnailsettings,initialize:function(e){e&&e.pid&&(this.pid=e.pid)},url:function(){return Cargo.API.GetAllThumbnailSettingsPath(this.pid)},fetch:function(e){$("script[data-set='AllThumbnailSettings']").html()?this.set($.parseJSON($("script[data-set='AllThumbnailSettings']").html()),e):Backbone.Collection.prototype.fetch.apply(this,arguments)}}),Cargo.o.view.Main=Backbone.View.extend({el:"body",initialize:function(){this.resolveFontTest=_.bind(this.resolveFontTest,this),this.drawTextCanvas=_.bind(this.drawTextCanvas,this),this.testIconFont(),this.loadingRandomPage=!1,this.collection.bind("change",this.render,this),"html"==Cargo.API.Config.preview?this.WriteCustomHtmlPreview():"css"==Cargo.API.Config.preview&&this.WriteCustomCSSPreview();var e=document.querySelector(".main_container");if(e&&e.addEventListener("scroll",function(){this.scrollTop=0},{passive:!0}),window.matchMedia){var t=Cargo.Helper.GetMobileWindowBreakPoint(),i=window.matchMedia("(min-width: "+t+"px)");i.addListener(function(e){setTimeout(function(){Cargo.Event.trigger("mobile_breakpoint_triggered",i.matches)})})}Cargo.Helper.IsAdminEdit()&&this.$el.attr("data-adminview","true")},events:{"click [rel='history']":"HistoryPush","click [rel='load_admin']":"loadAdmin","click [rel='home_page']":"ShowHome","click [rel='next_page']":"NextPage","click [rel='prev_page']":"PrevPage","click [rel='add_to_cart']":"AddToCart","click [rel='show_cart']":"ShowCart","click [rel='random_page']":"RandomPage","click [rel='site_menu']":"ShowSiteMenu","click a":"preventExtLinks"},render:function(){this.collection},loadAdmin:function(e){e.preventDefault(),Cargo.Helper.IsOnHomepage()?Cargo.Helper.GoToUrl("admin"):Cargo.Core.loadAdminForActivePage()},AddToCart:function(e){e.preventDefault(),Cargo.Helper.IsAdminEdit()&&"click"==e.type||Cargo.View.Following.triggerEventInFrame("add-sku-to-cart",{sku:e.currentTarget.getAttribute("data-sku"),product:e.currentTarget.getAttribute("data-product")})},ShowCart:function(e){e.preventDefault(),Cargo.Helper.IsAdminEdit()&&"click"==e.type&&!$(e.currentTarget).is("#shop_button")||Cargo.Event.trigger("add_history","cart")},isClickInEditor:function(e){if("undefined"==typeof CargoEditor||void 0===CargoEditor.events)return!1;if(void 0===e)return!1;if(e&&"dblclick"===e.type)try{if(!1===top.editor.editorInstance.inspectorOverlay.disabled)return!1}catch(e){}for(var t=e.target;null!==(t=t.parentNode);)if(t.nodeType===Node.ELEMENT_NODE){if("true"===t.contentEditable)return!0;if(t.hasAttribute("data-ce-model-id")&&t.getAttribute("data-ce-model-id")!=Backbone.history.fragment)return!0;if("svg"===t.nodeName&&"marker-overlay"===t.className.baseVal)return!0}return!1},preventExtLinks:function(e){this.isClickInEditor(e)&&e.preventDefault()},testIconFont:function(){this.el.classList.add("iconfont-loading");var e=document.createElement("canvas");e.width=150,e.height=150,this.textCtx=e.getContext("2d"),this.textCtx.font="150px Icons, Verdana",this.textCtx.textAlign="center",this.textCtx.fillStyle="black",this.drawTextCanvas(),this.fontTimer=setTimeout(this.resolveFontTest,3e3)},drawTextCanvas:function(){this.textCtx.fillStyle="white",this.textCtx.fillRect(0,0,150,150),this.textCtx.fillStyle="black",this.textCtx.fillText("î€¿ï¸Ž",75,120);for(var e=[[10,10],[120,10],[120,120],[10,120],[95,75],[55,75],[75,75]],t=this.textCtx.getImageData(0,0,150,150),i=!1,n=0;n<e.length;n++){var o=e[n],a=600*o[1]+4*o[0];if(i=255==t.data[a])break}if(t=null,i){this.drawFrameID=window.requestAnimationFrame(this.drawTextCanvas)}else this.resolveFontTest()},resolveFontTest:function(){window.cancelAnimationFrame(this.drawFrameID),clearTimeout(this.fontTimer),this.textCanvas=null,this.textCtx=null,this.el.classList.remove("iconfont-loading")},HistoryPush:function(e,t){if(!this.isClickInEditor(e)){e&&(e.preventDefault(),t=e.currentTarget);var i=$(t).attr("href")?$(t).attr("href"):$(t).data("href"),n=$(t).attr("data-id")?$(t).attr("data-id"):$(t).data("id"),o=!(!$(t).attr("target")||"_blank"!=$(t).attr("target"));e.metaKey||o?window.open(i):Cargo.Event.trigger("add_history",i,n)}},ShowHome:function(e,t){this.isClickInEditor(e)||(e&&e.preventDefault(),Cargo.Event.trigger("add_history",""))},NextPage:function(e){if(!this.isClickInEditor(e)){e&&e.preventDefault();var t=Cargo.View.Content.getActiveContentModel();if(t&&(!t.get("is_set")||t.get("stack")))if(!1!==t.get("display")){var i=Cargo.Collection.Scaffolding.getModel({id:t.get("set_id")});if(i&&void 0!==i.get("page_count")&&!(i.get("page_count")<=1)){var n,o,a=_.without(i.get("pages").map(function(e){return e.get("is_set")&&!e.get("stack")||0==e.get("page_count")?e.get("index"):void 0}),void 0),r=i.get("page_count"),s=t.get("index");for(o=0;o<r&&(++s>=r&&(s=0),-1!==a.indexOf(s));o++);(n=i.getModelAtIndex(s))?Cargo.Event.trigger("add_history",n.get("project_url"),n.get("id")):i.fetchModelAtIndex(s,{done:function(e){Cargo.Event.trigger("add_history",e.get("project_url"),e.get("id"))}})}}else $.get(Cargo.API.GetBasePath()+"/page/next/"+t.get("id"),function(e){if(e){var t=Cargo.Collection.Scaffolding.model(e);Cargo.Collection.Scaffolding.insertModel(t,Cargo.Collection.Scaffolding,{}),Cargo.Event.trigger("add_history",t.get("project_url"),t.get("id"))}},"json")}},PrevPage:function(e){if(!this.isClickInEditor(e)){e&&e.preventDefault();var t=Cargo.View.Content.getActiveContentModel();if(t&&(!t.get("is_set")||t.get("stack")))if(!1!==t.get("display")){var i=Cargo.Collection.Scaffolding.getModel({id:t.get("set_id")});if(i&&void 0!==i.get("page_count")&&!(i.get("page_count")<=1)){var n,o,a=_.without(i.get("pages").map(function(e){return e.get("is_set")&&!e.get("stack")||0==e.get("page_count")?e.get("index"):void 0}),void 0),r=i.get("page_count"),s=t.get("index");for(o=0;o<r&&(--s<0&&(s=r-1),-1!==a.indexOf(s));o++);(n=i.getModelAtIndex(s))?Cargo.Event.trigger("add_history",n.get("project_url"),n.get("id")):i.fetchModelAtIndex(s,{done:function(e){Cargo.Event.trigger("add_history",e.get("project_url"),e.get("id"))}})}}else $.get(Cargo.API.GetBasePath()+"/page/prev/"+t.get("id"),function(e){if(e){var t=Cargo.Collection.Scaffolding.model(e);Cargo.Collection.Scaffolding.insertModel(t,Cargo.Collection.Scaffolding,{}),Cargo.Event.trigger("add_history",t.get("project_url"),t.get("id"))}},"json")}},RandomPage:function(e){if(!this.isClickInEditor(e)&&(e&&e.preventDefault(),!0!==this.loadingRandomPage)){this.loadingRandomPage=!0;var t,i,n,o,a=[];if(Cargo.View.Content.activeContentModel&&(t=Cargo.View.Content.activeContentModel.get("id")),Cargo.Collection.Scaffolding.each(function(e){if("set"===e.type)if(e.get("stack"))e.get("page_count")>0&&t!==e.get("id")&&a.push([e.get("id")]);else if((i=e.get("page_count"))&&!isNaN(i))for(o=0;o<i;o++)(!(n=e.getModelAtIndex(o))||"set"!==n.type&&n.get("id")!==t)&&a.push([e.get("id"),o])},void 0,!0),0!==a.length){var r=a[Math.floor(Math.random()*a.length)],s=Cargo.Collection.Scaffolding.getModel({id:r[0]});2===r.length?s.fetchModelAtIndex(r[1],{done:_.bind(function(e){Cargo.Event.trigger("add_history",e.get("project_url"),e.get("id")),this.loadingRandomPage=!1},this),error:_.bind(function(){this.loadingRandomPage=!1},this)}):1===r.length?(Cargo.Event.trigger("add_history",s.get("project_url"),s.get("id")),this.loadingRandomPage=!1):this.loadingRandomPage=!1}else this.loadingRandomPage=!1}},ShowSiteMenu:function(e){Cargo.View.SiteMenu.show(e)},WriteCustomHtmlPreview:function(){if(void 0!==parent.editframe){var e=parent.editframe.document.getElementById("syntax_highlight").value;$("customhtml").html(e)}else if(void 0!==parent.Cargo&&parent.Cargo.hasOwnProperty("Editor")&&void 0!==parent.Cargo.Editor.previewCustomHTML){e=parent.Cargo.Editor.previewCustomHTML;$("customhtml").html(e)}},WriteCustomCSSPreview:function(){var e=parent.editframe.document.getElementById("syntax_highlight").value;$("body").append("<style>"+e+"</style>"),$("head link[rel='stylesheet']").remove()},SetWindowTitle:function(e){if(e||Cargo.Helper.IsOnHomepage())document.title=Cargo.Model.Site.GetWebsiteTitle();else{var t=Cargo.View.Content.getActiveContentModel(),i=t&&"all"!==t?t.get("title"):"";i?document.title=i+" - "+Cargo.Model.Site.GetWebsiteTitle():""===i&&(document.title=Cargo.Model.Site.GetWebsiteTitle())}},SetHomepageClass:function(){(Cargo.Model.Site.get("homepage_id")||0==Cargo.Model.Site.get("homepage_id"))&&this.$el.addClass("homepage")},SetFeedClass:function(){Cargo.Helper.isFeed()&&this.$el.addClass("feed")},RemoveHomepageClass:function(){this.$el.removeClass("homepage")},RemoveFeedClass:function(){this.$el.removeClass("feed")},SetPageId:function(e){this.$el.attr("data-page-id",e)}}),Cargo.o.view.Backdrop=Backbone.View.extend({template:"",has_webgl:null,pages:[],plugins:[],Subviews:{},ticking:!1,initialize:function(){return this.measuringStick=null,this.fullScreenHeight=null,this.addEventListeners(),this.requestTick(),this},addEventListeners:function(){this.requestTickCallback=this.requestTick.bind(this),this.updateScrollMonitorsCallback=this.updateScrollMonitors.bind(this),this.throttledRequestTick=_.throttle(this.requestTickCallback,150),this.resetIOSChromeCache=_.bind(this.resetIOSChromeCache,this),this.resetIOSChromeCache=_.debounce(this.resetIOSChromeCache,150),this.checkSplitResponsive=_.bind(this.checkSplitResponsive,this),this.checkSplitResponsive=_.debounce(this.checkSplitResponsive,30),this.listenTo(Cargo.Event,"design:ready backbone-route",this.setup),this.listenTo(Cargo.Event,"handleAdminUIChange",this.requestTickCallback),this.listenTo(Cargo.Event,"pin_format_complete",this.updateScrollMonitorsCallback),window.addEventListener("scroll",this.requestTickCallback,{passive:!0}),window.addEventListener("resize",this.requestTickCallback,{passive:!0}),window.addEventListener("gestureend",this.resetIOSChromeCache),window.addEventListener("pointerup",this.resetIOSChromeCache),window.addEventListener("onpointercancel",this.resetIOSChromeCache),window.addEventListener("onpointerout",this.resetIOSChromeCache),window.addEventListener("onpointerleave",this.resetIOSChromeCache),this.listenTo(Cargo.Event,"handleAdminUIChange",this.checkSplitResponsive),Cargo.Event.on("projectlist_sort",function(){_.each(this.Subviews,function(e){e._pageScrollMonitor&&(e._pageScrollMonitor.recalculateLocation(),e._pageScrollMonitor.update(),e._pageScrollMonitor.triggerCallbacks())})},this),CargoEditor&&CargoEditor.hasOwnProperty("events")&&CargoEditor.events.on("editor-content-change",this.requestTickCallback);try{parent.document,parent.hasOwnProperty("Cargo")&&parent.Cargo.hasOwnProperty("Event")&&(parent.Cargo.Event.on("applied-presets",this.requestTickCallback),parent.Cargo.Event.on("mobile-preview",_.debounce(_.bind(this.requestTickCallback,this),50)),parent.Cargo.Event.on("image_upload_complete",_.bind(this.addImage,this)),parent.Cargo.Event.on("image_delete_complete",_.bind(this.removeImage,this)))}catch(e){}return this},checkSplitResponsive:function(e,t){var i=!1;"split_layout"!==e&&"pagerender"!==e&&"split_responsive"!==e||(_.each(this.Subviews,function(e){var t=e.el;if(t){var n=closest(t,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("page_container")});if(n){var o=n.hasAttribute("split-responsive");e._split_responsive!==o&&(i=!0),e._split_responsive=o;var a=n.hasAttribute("data-padding-top");e._has_accommodation!==a&&(i=!0),e._has_accommodation=a}}}),i&&this.updateBackdropScrollPosition(!0))},resetIOSChromeCache:function(){this.cacheChromeHeight=0,this.requestTick()},setup:function(){var e=$(".backdrop");if(!e.length&&_.isEmpty(this.pages))return this;var t=e.siblings(".page").map(function(){return $(this).data("id")});t=_.map(t,function(e){return parseInt(e,10)});var i=_.difference(this.pages,t),n=_.difference(t,this.pages);return _.each(n,function(e){this.add(e)},this),_.each(i,function(e){this.remove(e)},this),this},reset:function(){_.each(this.Subviews,function(e,t){this.remove(t,!0)},this),this.pages=[]},remove:function(e,t){if(!(e in this.Subviews))return this.pages=_.without(this.pages,e),this;var i=this.Subviews[e],n=_.clone(i.model);return i.prevent_removal?void 0:("function"==typeof i.destroy&&i.destroy(),"object"==typeof i._pageScrollMonitor&&i._pageScrollMonitor.destroy(),i.undelegateEvents(),i.$el.removeData().unbind(),!0===t&&void 0!==i.model.get("originalDataElement")&&null!==i.model.get("originalDataElement")&&null!==i.el.parentNode&&i.el.parentNode.appendChild(i.model.get("originalDataElement")),i.remove(),this.Subviews[e]=void 0,delete this.Subviews[e],this.pages=_.without(this.pages,e),this.markPluginInactive(n),this)},removeImage:function(e){if(e)for(var t in this.Subviews)this.Subviews.hasOwnProperty(t)&&"function"==typeof this.Subviews[t].Update&&this.Subviews[t].Update("image_delete",e)},addImage:function(e){if(e)for(var t in this.Subviews)this.Subviews.hasOwnProperty(t)&&"function"==typeof this.Subviews[t].Update&&this.Subviews[t].Update("image_upload",e)},add:function(e,t,i,n){var o=this.getRenderTargetForPID(e),a=null==o?null:o.parentNode.querySelector('[data-set="backdrop_data"]');if(void 0===n&&null!==a&&(n=a.innerHTML),this.pages.push(e),this.pages=_.uniq(this.pages),o||this.createBackdropEl(e),!n)return(r=new Backdrop.o.model.Settings({page_id:e,backdrop_id:t,backdrop_path:i})).fetch({success:$.proxy(this.loadBackdrop,this)}),this;var r=new Backdrop.o.model.Settings;return"string"==typeof n?r.set(JSON.parse(n)):r.set(n),r.set("originalDataElement",a),this.loadBackdrop(r),this},change:function(e,t,i){return this.remove(e).add(e,t,i)},get:function(e){if(void 0!==this.Subviews[e])return this.Subviews[e]},enableOrDisableBackdropForPID:function(e,t){if(e=parseInt(e),isNaN(e))console.warn("enableOrDisableBackdropForPID: no valid PID given.");else if(!1!==t&&(t=!0),t){var i=Cargo.Collection.Scaffolding.getModel({id:e});if(void 0!==i){var n=i.get("backdrop");n&&(n=n||{},n=_.defaults(n,{backdrop_id:void 0,backdrop_path:void 0}),this.add(e,n.backdrop_id,n.backdrop_path)),this.requestTick()}else console.warn("enableOrDisableBackdropForPID: Unable to enable backdrop. No page model found.")}else this.remove(e)},createBackdropEl:function(e){var t=$('.page[data-id="'+e+'"]').closest(".page_container");return $("<div />").addClass("backdrop").attr("data-view","Backdrop").appendTo(t),this},loadBackdrop:function(e){return e.get("requires_webgl")&&!this.testWebGl()?(this.makeFallback(e),this):Backdrop.Data.require_loaded?(require.config({baseUrl:"/_jsapps/backdrop",urlArgs:__cargo_js_ver__}),void 0!==this.getRenderTargetForPID(e.get("page_id"))?("undefined"!=typeof __cargo_context__&&"live"===__cargo_context__?require(["_dist/"+e.get("backdrop_path")],_.bind(function(t){require([e.get("backdrop_path")+"/main"],_.bind(function(t){this.markPluginActive(e),this.loadSubview(e,t),this.requestTick()},this))},this)):require([e.get("backdrop_path")+"/main"],_.bind(function(t){this.markPluginActive(e),this.loadSubview(e,t),this.requestTick()},this)),this):void console.error("no render target for backdrop")):(setTimeout($.proxy(function(){this.loadBackdrop(e)},this),150),this)},getRenderTargetForPID:function(e){return $('.page[data-id="'+e+'"]').siblings(".backdrop")[0]},loadSubview:function(e,t){var i=e.get("page_id");if(void 0!==this.Subviews[i])return this;var n=this.getRenderTargetForPID(i);if(n){var o=new t({model:e});o.deferredLoadEventName&&(o.deferredLoadEventName+="_"+_.uniqueId()),n.setAttribute("data-backdrop",e.get("backdrop_path")),n.innerHTML="",n.appendChild(o.el),o.render(),"function"==typeof o.Init&&o.Init();var a=$(n).closest(".page_container").get(0),r=$(n).closest('[data-view="pinned_bottom"] .fixed, [data-view="pinned_top"] .fixed');return a&&0==r.length?(a.hasAttribute("split-responsive")?(o._split_responsive=!0,a.hasAttribute("data-padding-top")?o._has_accommodation=!0:o._has_accommodation=!1):o._split_responsive=!1,o._scroll_tracking=!0,o._positionChangeTracker=scrollMonitor.create(a,screen.height),o._positionChangeTracker.enterViewport(function(){o._trackable=!0}),o._positionChangeTracker.exitViewport(function(){o._trackable=!1}),o._pageScrollMonitor=scrollMonitor.create(a),o._pageScrollMonitor.enterViewport(function(){o.in_viewport=!0,o.Resume&&o.paused&&o.Resume()}),o._pageScrollMonitor.exitViewport(function(){o.in_viewport=!1,o.Pause&&!o.paused&&o.Pause()}),void 0!==o._containerMonitor&&o._containerMonitor.update()):o.in_viewport=!0,o._cached_size={left:0,top:0,width:0,height:0},this.Subviews[i]=o,Cargo.Event.trigger("plugin_render",o),setTimeout(function(){o._pageScrollMonitor&&(o._pageScrollMonitor.recalculateLocation(),o._pageScrollMonitor.update(),o._pageScrollMonitor.triggerCallbacks())},100),this}console.error("no render target for backdrop")},markPluginActive:function(e){var t=e.get("backdrop_id"),i=e.get("backdrop_path"),n=_.findWhere(this.plugins,{path:i});return n||(n={count:0,id:t,path:i},this.plugins.push(n)),n.count++,this},markPluginInactive:function(e){e.get("backdrop_id");var t=e.get("backdrop_path"),i=_.findWhere(this.plugins,{path:t});return i&&i.count--,0===i.count&&(this.plugins=_.without(this.plugins,i)),this},is_ios:null,testIOS:function(){return null!==this.is_ios?this.is_ios:(this.is_ios=Cargo.Helper.isIOS(),this.is_ios)},cacheChromeHeight:0,cache_window_data:{height:0,width:0,scrollY:0,scrollX:0},updateScrollMonitors:function(){for(var e in this.Subviews)if(this.Subviews.hasOwnProperty(e)){var t=this.Subviews[e];t.hasOwnProperty("_pageScrollMonitor")&&(t._pageScrollMonitor.recalculateLocation(),t._pageScrollMonitor.update())}this.requestTick()},updateBackdropScrollPosition:function(e){var t=this.testIOS(),i=window.scrollY,n=window.innerHeight,o=document.documentElement.clientWidth,a=window.scrollX,r=!1;if(n!=this.cache_window_data.height||o!=this.cache_window_data.width||e||(r=!0),t&&(!this.fullScreenHeight||!r)){if(!this.measuringStick){var s=document.createElement("div");s.style.position="fixed",s.style.height="100vh",s.style.width="1px",s.style.zIndex="-10",s.style.pointerEvents="none",this.measuringStick=s,document.body.appendChild(this.measuringStick)}this.fullScreenHeight=this.measuringStick.offsetHeight}this.cache_window_data={width:o,height:n,scrollY:i,scrollX:a};var l=Cargo.Helper.IsMobileWindowSize(o);for(var d in this.Subviews)if(this.Subviews.hasOwnProperty(d)){var c=this.Subviews[d];if(c)if((c._trackable||c._scroll_tracking)&&c.hasOwnProperty("_positionChangeTracker")){E=c.el.parentElement.getBoundingClientRect();var h=c.el.parentElement.parentElement.getBoundingClientRect();if(E.left!=c._cached_size.left||E.top!=c._cached_size.top||E.width!=c._cached_size.width||E.height!=c._cached_size.height||!r){c._cached_size=E;var u=c._split_responsive&&l;if(h.height<=n||u){var g=0;if(c._scroll_tracking){var p;if(c._has_accommodation){var m=Cargo.View.PinnedTop.pinCollection.findWhere({content_accommodate_page:!0});g=m?m.get("page_height"):0,u?(k="calc(50vh + "+g+"px)",p="translate(0, "+-g+"px)"):(k="calc(100% + "+g+"px)",p="translate(0, "+-g+"px)"),c._scroll_tracking=!0}else k="",p="",c._scroll_tracking=!1;c.el.style.transform=p,c.el.style.height=k,c.el.style.width="",c.el.style.position="",c.hasOwnProperty("auxiliary_container")&&(c.auxiliary_container._el.style.transform="",c.auxiliary_container._el.style.height=k,c.auxiliary_container._el.style.width="",c.auxiliary_container._el.style.position=""),c.el.style.willChange="initial"}c.hasOwnProperty("SetSizeFromMainView")&&(t&&u?c.SetSizeFromMainView(E.width,.5*this.fullScreenHeight+g):u?c.SetSizeFromMainView(E.width,.5*n+g):c.SetSizeFromMainView(E.width,E.height+g))}else{c._scroll_tracking&&!c._trackable?c._scroll_tracking=!1:c._scroll_tracking=!0;var f=h.bottom>=0&&h.top<0,v=h.top<=n&&h.bottom>n,b=h.top>n,y=h.bottom<0,_=h.top<=0&&h.bottom>=n,w=0,C=0,S="absolute",k="",x=Math.ceil(E.width);v&&!_||b?(k=n+"px",S="absolute",C=0,w=0):f&&!_||y?(k=n+"px",w=h.height+-n,S="absolute",C=0):(k=n+"px",w=0,S="fixed",C=Math.round(E.left)),c.el.style.position=S,c.el.style.willChange="transform, width, height, position",c.el.style.width=x+"px",c.el.style.height=k,C+=-h.left,c.el.style.transform=0==C&&0==w&&0==i?"":"translate("+C+"px, "+w+"px)",c.hasOwnProperty("auxiliary_container")&&(c.auxiliary_container._el.style.height=k,c.auxiliary_container._el.style.width=x+"px",c.auxiliary_container._el.style.position=S,c.auxiliary_container._el.style.transform=0==C&&0==w&&0==i?"":"translate("+C+"px, "+w+"px)"),c.hasOwnProperty("SetSizeFromMainView")&&(E.height,c.SetSizeFromMainView(E.width,n))}}}else if(c._scroll_tracking=!1,c.el.style.willChange="initial",c.hasOwnProperty("SetSizeFromMainView")){var E=c.el.parentElement.getBoundingClientRect();c.SetSizeFromMainView(E.width,E.height)}}},requestTick:function(e){if(!this.ticking){var t=this;requestAnimationFrame(function(){t.updateBackdropScrollPosition(),Cargo.Event.trigger("backdrop_position_update"),t.ticking=!1})}this.ticking=!0},makeFallback:function(e){var t=e.get("page_id"),i=$('[data-id="'+t+'"]').css("color"),n=i.split(","),o=[],a=0;/rgb\(/.test(i)?(n[0]=n[0].replace("rgb(",""),o[0]=parseInt(n[0]),o[1]=parseInt(n[1]),o[2]=parseInt(n[2]),a=(299*o[0]+587*o[1]+114*o[2])/1e3):/rgba\(/.test(i)?(n[0]=n[0].replace("rgb(",""),o[0]=parseInt(n[0]),o[1]=parseInt(n[1]),o[2]=parseInt(n[2]),a=(299*o[0]+587*o[1]+114*o[2])/1e3):/#/.test(i)?(o[0]=parseInt(n[0],16),o[1]=parseInt(n[1],16),o[2]=parseInt(n[2],16),a=(299*o[0]+587*o[1]+114*o[2])/1e3):a=255;var r=a>125?"#333":"#fff";return $('.page[data-id="'+t+'"]').siblings(".backdrop").css("background-color",r),this},testWebGl:function(){if(null!==this.has_webgl)return this.has_webgl;var e,t,i;if(this.has_webgl=!1,window.WebGLRenderingContext){e=document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],i=!1;for(var n=0;n<4;n++)try{if((i=e.getContext(t[n]))&&"function"==typeof i.getParameter)return e=void 0,this.has_webgl=!0,this.has_webgl}catch(e){}return e=void 0,this.has_webgl=!1,this.has_webgl}return this.has_webgl=!1,this.has_webgl},initAndRenderPlugin:$.noop,initPlugin:$.noop,loadActivePlugin:$.noop,render:$.noop,unloadMainPlugin:$.noop}),Cargo.o.view.Content=Backbone.View.extend({template:$('[type="text/x-handlebars-template"]#content').html(),initialize:function(){this.currentSet=null,this.activeContentModel=null,$(_.bind(function(){var e=2*screen.height;Cargo.Helper.isMobile()&&(e=.75*screen.height);var t=scrollMonitor.create($("[data-autopaginate]")[0],e);t.enterViewport(_.bind(function(){this.requestPagination({prevent_pagination_recheck:!0,pagination_attempts:0})},this)),t.isInViewport&&this.requestPagination({prevent_pagination_recheck:!0,pagination_attempts:0}),Cargo.Event.on("set_render_complete",function(e,i){i.from_pagination||(scrollMonitor.update(),!0!==i.prevent_pagination_recheck&&t.isInViewport&&this.requestPagination({prevent_pagination_recheck:!0,pagination_attempts:0}))},this),Cargo.Event.on("set_load_complete",function(){scrollMonitor.update(),t.isInViewport&&this.requestPagination({prevent_pagination_recheck:!0,pagination_attempts:0})},this),Cargo.Event.on("pagination_complete",function(e,i,n){setTimeout(_.bind(function(){scrollMonitor.update();var e=n.pagination_attempts;if(isNaN(e)&&(e=!1),!(e&&e>3)&&i.length>0&&t.isInViewport){var o={};isNaN(e)||(o.pagination_attempts=++e),this.requestPagination(o)}},this),100)},this)},this)),this.activeLinks=[],Cargo.Event.on("content_load_complete",this.checkActiveLinks,this),Cargo.Event.once("init_complete",function(){this.initializePreRenderedSet()},this)},requestPagination:function(e){this.currentSet&&this.activeContentModel&&"set"===this.activeContentModel.type&&this.activeContentModel.paginate(e)},fillGapsInCurrentSet:function(){if(this.currentSet&&this.activeContentModel&&"set"===this.activeContentModel.type){var e,t,i=_.union([this.currentSet],this.currentSet.getAllSetViews()),n=[],o=[];if(i.sort(function(e,t){return e.model.get("sort")-t.model.get("sort")}),_.each(i,function(i){o.push(i),i.pageViews.length>0&&(e=i,t=i.pageViews[i.pageViews.length-1],n=_.union(n,o),o=[])}),!e||!t)return;var a=0,r=this.activeContentModel.recursivelyFindMissingIndexesInSet(16,{limit:{set:e.model.get("id"),index:t.model.get("index")}});if(_.isEmpty(r))return;if(_.each(r,function(e){a+=e.indexes.length}),a>15){var s=this.activeContentModel.recursivelyFindMissingIndexesInSet(15,{limit:{set:e.model.get("id"),index:t.model.get("index")}});this.activeContentModel.paginateWithMissingIndexObject(s,{render_changes:!0,done:_.bind(function(e){var t=e[e.length-1];_.each(Cargo.Collection.Scaffolding.getAllPages(!0),function(e){if("set"===e.type){var i=[];e.get("pages").each(function(e){"page"===e.type&&Cargo.Helper.IsIndexableModel(e)&&e.get("sort")>t.sort&&i.push(e)}),e.get("pages").remove(i)}})},this)})}else this.activeContentModel.paginateWithMissingIndexObject(r,{render_changes:!0})}},checkActiveLinks:function(e){var t=Cargo.Helper.GetHomepageId(),i=Cargo.Collection.Scaffolding.getModel({id:e}),n="";i?n=i.get("project_url")+"":this.activeContentModel&&void 0!==this.activeContentModel.get("__tag__")&&(n=this.activeContentModel.get("__tag__"));var o,a=_.filter(document.querySelectorAll(".page_container a, #site_menu > a"),function(i){return e!=t&&("string"==typeof i.getAttribute("href")&&i.getAttribute("href").replace(/\//g,"").toLowerCase()==n.replace(/\//g,"").toLowerCase()||void(i.classList.contains("active")&&-1===this.activeLinks.indexOf(i)&&this.activeLinks.push(i)))},this),r=_.difference(this.activeLinks,a),s=_.difference(a,this.activeLinks);if(0!==s.length||0!==r.length){for(o=0;o<s.length;o++)s[o].classList.add("active"),this.activeLinks.push(s[o]);for(o=0;o<r.length;o++)r[o].classList.remove("active"),0===r[o].classList.length&&r[o].removeAttribute("class");this.activeLinks=_.difference(this.activeLinks,r),this.activeLinkPID=e}else this.activeLinkPID=e},retrieveActivePageViewForPID:function(e,t){var i=Cargo.Helper.GetPageViewById(e);if(i&&i.model.get("pin"));else if(Cargo.Helper.isFeed()||void 0===i)return void this.RenderPidOrPurl(e,!0,{complete:_.bind(function(){if(i=Cargo.Helper.GetPageViewById(e),unableToLoad=!1,void 0!==i)t&&t(i);else{unableToLoad=!0;var n=Cargo.Collection.Scaffolding.getModel({id:e});if(n){var o=Cargo.Collection.Scaffolding.getModel({id:n.get("set_id")});if(o&&o.get("stack")){var a=_.filter(o.get("pages").getMissingIndexes(),function(e){return e<=n.get("index")}),r=o.loadIndexes(a,{render_changes:!0});r&&(unableToLoad=!1,r.always(_.bind(function(){void 0!==(i=Cargo.Helper.GetPageViewById(e))?t&&t(i):Cargo.Modal.Alert({message:"Unable to load Page"})},this)))}}}unableToLoad&&Cargo.Modal.Alert({message:"Unable to load Page"})},this)});i&&t&&t(i)},render:function(e,t){if(t=t||{},_.defaults(t,{silent:!1,initial_render:!0,complete:function(){}}),this.removeCurrentView(),"set"===e.type)!0!==e.get("stack")||Cargo.Helper.IsAdminEdit()||this.collection.removeNonVisiblePages(),this.currentSet=Cargo.Core.SetViewFactory.constructSetView({model:e}),this.activeContentModel=e,this.currentSet.el.setAttribute("data-container","set"),this.currentSet.el.setAttribute("data-id",e.get("id")),this.el.appendChild(this.currentSet.el),this.currentSet.render(void 0,t),t.silent?this.checkActiveLinks(e.get("id")):(Cargo.Event.trigger("set_load_complete",e.get("id")),Cargo.Event.trigger("content_load_complete",e.get("id"))),e.get("__tag__")&&(Cargo.Event.trigger("tag_load_complete",e.get("__tag__")),Cargo.View.Main&&Cargo.View.Main.SetFeedClass()),Cargo.API.Config.is_direct_link&&(Cargo.API.Config.is_direct_link=!1),t.complete(e,t);else if("page"===e.type){var i=this.collection.getModel({id:e.get("set_id")}),n=e;this.activeContentModel=n,e=new Cargo.o.model.set({id:i.get("id"),pages:[n],stack:!1,is_set:!0,page_count:1}),this.currentSet=Cargo.Core.SetViewFactory.constructSetView({model:e}),this.currentSet.el.setAttribute("data-container","set"),this.currentSet.el.setAttribute("data-id",i.get("id")),this.el.appendChild(this.currentSet.el),this.currentSet.render(void 0,t),t.silent?this.checkActiveLinks(n.get("id")):(Cargo.Event.trigger("page_load_complete",n.get("id")),Cargo.Event.trigger("content_load_complete",n.get("id"))),Cargo.API.Config.is_direct_link&&(Cargo.API.Config.is_direct_link=!1),t.complete(n,t)}},RenderHomepage:function(e,t){if(t=t||{},_.defaults(t,{silent:!1,complete:function(){},force_single:!0}),this.activeContentModel&&this.activeContentModel.get("id")===Cargo.Helper.GetHomepageId()&&!0===Cargo.Router.is_first_route&&!e)return t.complete(this.activeContentModel,t),void Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId());Cargo.Helper.isFeed()?(!0!==Cargo.Router.is_first_route||e)&&(this.RenderFeed(!0,t),!0!==t.silent&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId())):(this.collection.removeNonVisiblePages(),0===Cargo.Helper.GetHomepageId()?(this.removeCurrentView(),this.activeContentModel=this.collection.getModel({id:0}),!0!==t.silent&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId()),t.complete(this.activeContentModel,t)):(t.complete=_.wrap(t.complete,_.bind(function(e){!0!==t.silent&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId());var i=Array.prototype.slice.call(arguments);i.shift(),e&&e.apply(t.context,i)},this)),this.RenderPidOrPurl(Cargo.Helper.GetHomepageId(),e,t)))},RenderFeed:function(e,t){t=t||{},_.defaults(t,{silent:!1}),this.collection.removeNonVisiblePages(),this.RenderPidOrPurl(0,e,t)},RenderPidOrPurl:function(e,t,i){if(i=i||{},_.defaults(i,{silent:!1,force_single:!1,force_set_render:!1,complete:function(){}}),!0!==Cargo.Router.is_first_route||t){var n;if(isNaN(Number(e))||"string"==typeof e&&0===Number(e)||(n=this.collection.getSetOrPageModel({id:Number(e)},Cargo.Helper.IsAdminEdit()&&!i.force_single)),n||(n=this.collection.getModelByPurl(e,Cargo.Helper.IsAdminEdit()&&!i.force_single)),n)return i.force_set_render||Cargo.Helper.isFeed()||!0!==n.get("is_set")||!1!==n.get("stack")?void this.render(n,i):(this.hideActiveView(i),this.activeContentModel=n,i.silent||(Cargo.Event.trigger("content_load_complete",n.get("id")),Cargo.Event.trigger("set_load_complete",n.get("id"))),void i.complete(n,i));i.from_async?(Cargo.Modal.Alert({message:"Page Not Found"}),Cargo.Helper.HideLoadingAnimation()):this.loadSinglePage(e,_.bind(function(n){i.from_async=!0,this.RenderPidOrPurl.call(this,e,t,i)},this))}else Cargo.Router.is_first_route=!1},loadSinglePage:function(e,t){this.collection.fetchPageModel(e,{done:_.bind(function(i){i.get("id")!=e&&(i.get("project_url")+"").toLowerCase()!=(e+"").toLowerCase()||t&&t(i)},this)})},ToggleFeed:function(e){e?this.RenderFeed(!0,{force_set_render:!0}):0===Cargo.Helper.GetHomepageId()?this.removeCurrentView():this.RenderPidOrPurl(Cargo.Helper.GetHomepageId(),!0)},removeCurrentView:function(){if(this.currentSet){this.activeContentModel=null;var e=this.currentSet;this.currentSet=null,e.remove(),this.checkActiveLinks(),Cargo.View.Main.SetWindowTitle(),Cargo.Event.trigger("content_view_removed")}this.el.innerHTML=""},hideActiveView:function(e){e=e||{},_.defaults(e,{silent:!1}),this.removeCurrentView(),Cargo.Helper.HideLoadingAnimation(),e.silent||Cargo.Event.trigger("content_view_closed")},initializePreRenderedSet:function(){var e=Cargo.Collection.Tags.findTagByUrl(Cargo.Helper.GetCurrentRoute().replace(window.location.search,""));if(_.each(this.el.children,function(t){var i=parseInt(t.getAttribute("data-id"),10),n=this.collection.getSetOrPageModel({id:Number(i)});if(""===t.getAttribute("data-id")&&null!==t.parentNode){var o=t.querySelector("projectcontent");o&&""===o.textContent&&t.parentNode.removeChild(t)}if(!isNaN(i))if("set"===t.getAttribute("data-container")){var a=!!n&&n.get("stack");e&&!1===a?Cargo.Collection.Scaffolding.LoadTagCollection(e):n&&(this.activeContentModel=n,this.currentSet=Cargo.Core.SetViewFactory.constructSetView({el:t,model:n}),this.currentSet.render(!0),Cargo.Event.trigger("set_load_complete",n.get("id")),Cargo.Event.trigger("content_load_complete",n.get("id")),n.get("id")===Cargo.Helper.GetHomepageId()&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId()),Cargo.Helper.isFeed()&&e&&Cargo.Event.trigger("thumbnails:load_tag",e.get("url"))),Cargo.API.Config.is_direct_link&&(Cargo.API.Config.is_direct_link=!1)}else if("page"===t.getAttribute("data-container")){if(!n)return void this.loadSinglePage(i,_.bind(function(e){this.initializePreRenderedSet()},this));var r=this.collection.getModel({id:n.get("set_id")}),s=n;n=new Cargo.o.model.set({id:r.get("id"),pages:[s],stack:!1,is_set:!0,page_count:1}),this.activeContentModel=s,this.currentSet=Cargo.Core.SetViewFactory.constructSetView({model:n}),this.currentSet.el.setAttribute("data-container","set"),this.currentSet.el.setAttribute("data-id",r.get("id")),t.parentNode.insertBefore(this.currentSet.el,t),this.currentSet.el.appendChild(t),this.currentSet.findAndInitializePrerenderedContent(),Cargo.Event.trigger("page_load_complete",s.get("id")),Cargo.Event.trigger("content_load_complete",s.get("id")),s.get("id")===Cargo.Helper.GetHomepageId()&&Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId()),Cargo.API.Config.is_direct_link&&(Cargo.API.Config.is_direct_link=!1)}},this),null===this.activeContentModel)if(Cargo.API.Config.direct_link_pid){var t=this.collection.getModel({id:Cargo.API.Config.direct_link_pid});t&&"set"===t.type&&(this.activeContentModel=t,Cargo.Event.trigger("content_load_complete",t.get("id")),Cargo.Event.trigger("set_load_complete",t.get("id")))}else e?Cargo.Collection.Scaffolding.LoadTagCollection(e):Cargo.Event.trigger("homepage_loaded",Cargo.Helper.GetHomepageId());Cargo.API.Config.direct_link_pid=void 0},getPageViewById:function(e){if(this.currentSet)return _.filter(this.currentSet.getAllPageViews(),function(t){return t.model.get("id")==e})[0]},getFirstPageView:function(){if(this.currentSet)return _.filter(this.currentSet.getAllPageViews(),function(e){return!e.model.get("pin")})[0]},getLastPageView:function(){if(this.currentSet){var e=_.filter(this.currentSet.getAllPageViews(),function(e){return!e.model.get("pin")});return e[e.length-1]}},getActiveContentModel:function(){return this.activeContentModel},getActivePageViews:function(){return this.currentSet?this.currentSet.getAllPageViews():[]}}),Cargo.o.view.Page=Backbone.View.extend({parentView:null,template:$('[type="text/x-handlebars-template"]#page').html(),constructor:function(){Backbone.View.prototype.constructor.apply(this,arguments)},initialize:function(e){e&&e.parentView&&(this.parentView=e.parentView),e&&e.template&&(this.template=e.template),this.isAdminEdit=Cargo.Helper.IsAdminEdit(),this.finishGallerySetup=_.bind(this.finishGallerySetup,this),void 0!==this.model?(this.listenTo(this,"remove",function(){this.removeBackdrop(),Cargo.Event.trigger("pageview_removed",this),this.draggableView&&this.draggableView.remove()}),this.listenTo(this.model,"change:backdrop_enabled",function(){this.model.get("backdrop_enabled")?this.addBackdrop():this.removeBackdrop(!1)}),Cargo.Event.trigger("pageview-initialized",this),Cargo.Event.on("image_gallery_rendered",this.finishGallerySetup),this.initialSetup()):console.warn("no model for page")},events:{dragstart:"dragstart"},dragstart:function(e){if(Cargo.API.Config.cookie_url&&e.target.nodeType===Node.ELEMENT_NODE&&"IMG"===e.target.nodeName&&e.target.hasAttribute("data-mid")){var t=_.findWhere(this.model.get("images"),{id:parseInt(e.target.getAttribute("data-mid"))});if(t&&0==/(.*?)\.(svg)$/g.test(t.getOriginalImage().url)){var i={drag_image_src:e.target.getAttribute("src"),image_url:t.getOriginalImage().url,source_url:this.model.get("direct_link"),source_title:this.model.get("title")+" - "+Cargo.Model.Site.GetWebsiteTitle(),tags:""===this.model.get("tags")?[]:this.model.get("tags").split(", "),excerpt:this.model.get("excerpt")};e.dataTransfer.setData("cargo/imageselection",JSON.stringify(i))}}},removeBackdrop:function(e){!1!==e&&(e=!0),Backdrop.View.Backdrop.remove(this.model.get("id"),e)},addBackdrop:function(){this.model.get("backdrop")&&this.model.get("backdrop_enabled")&&Backdrop.View.Backdrop.add(this.model.get("id"),this.model.get("backdrop").backdrop_id,this.model.get("backdrop").backdrop_path)},initialSetup:function(){this.markNodesAsOriginal(),this.removeEmptyPagePadding(),Cargo.Core.Embeds.findEmbedsIn(this.el),Cargo.Core.Ecommerce.findWidgets(this.el),Cargo.Core.AudioPlayer.findPlayers(this.el),Cargo.Core.Ecommerce.updateInlineCartCounters(),Cargo.Core.Draggables.findShowLinks(),this.draggableView=new Cargo.Core.Draggables.DraggablesInstance({pageView:this}),Cargo.Core.ImageGallery.InitImageGallery({targetElement:this.el,forceReCollectionOfItems:!0}),Cargo.Model.DisplayOptions.get("layout_options")&&Cargo.Model.DisplayOptions.get("layout_options").image_zoom&&this.setupPageLightbox(),this.marqueeInstance||(this.marqueeInstance=new Cargo.Core.MarqueeInstance({parentView:this})),this.marqueeInstance.findMarquees(),this.trigger("initial-setup")},render:function(){if(this.preventRender)console.info("Prevented rendering of page",this.model.id);else{if(void 0!==this.model){var e=Cargo.Core.Handlebars.ParseScriptTags(this.template),t=Cargo.API.GetDataPackage();_.extend(t,this.model.toJSON());var i,n=Cargo.Core.Handlebars.Render(e,t),o=document.createRange(),a=[];for(o.selectNode(document.body),i=o.createContextualFragment(n),_.each(i.querySelectorAll("script"),function(e){a.push({node:e,parentNode:e.parentNode,nextSibling:e.nextSibling}),e.parentNode.removeChild(e)}),this.el.innerHTML="";i.childNodes.length>0;)this.el.appendChild(i.childNodes[0]);var r=!1,s=function(e){r=!0};if(window.addEventListener("error",s,!1),_.each(a,function(e){r=!1;var t=$;$(e.node).on("load",function(){if($!==t){Cargo.Modal.Alert({message:"<em>External versions of jQuery are not supported. Please use the built-in version of jQuery</em>"});var e=this.ownerDocument.createComment(this.outerHTML);e.setSaveable(!0),this.parentNode.insertBefore(e,this),this.parentNode.removeChild(this),jQuery.noConflict(!0)}}),e.nextSibling&&e.nextSibling.parentNode===e.parentNode?e.parentNode.insertBefore(e.node,e.nextSibling):e.parentNode.appendChild(e.node),r&&(r=!1,e.node.parentNode.insertBefore(document.createComment(e.node.outerHTML),e.node),e.node.parentNode.removeChild(e.node),this.isAdminEdit&&Cargo.Modal.Alert({message:"<em>One or more scripts on this page are broken and were disabled.</em>"}))}),window.removeEventListener("error",s),1===this.el.children.length)if(null!==this.el.parentNode){var l=this.el.children[0];this.el.parentNode.insertBefore(l,this.el),this.el.parentNode.removeChild(this.el),this.setElement(l)}else this.setElement(this.el.children[0]);return this.$el.closest("[local-style]").attr("local-style",this.model.get("id")),this.initialSetup(),this.addBackdrop(),Cargo.Event.trigger("page_render_complete",this),this}console.warn("no model for page")}},finishGallerySetup:function(e){var t=!1,i=!1,n=closest(e.el,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("page")});n?(parseInt(n.getAttribute("data-id"))==this.model.get("id")&&(!this.isAdminEdit&&Cargo.Model.DisplayOptions.get("layout_options").image_zoom&&(t=!0),i=!0),t&&this.setupGalleryLightbox(e),i&&this.autoplayVideos()):Cargo.Event.off("image_gallery_rendered",this.finishGallerySetup)},setupGalleryLightbox:function(e){var t=e.el.querySelectorAll("img");if("montessori"!=e.galleryOptions.path||e.mobile_active)t=_.sortBy(t,function(e){return parseInt(e.getAttribute("data-gallery-item-index"))});else{var i=e.serialize();t=_.sortBy(t,function(e){var t=0;if(e.hasAttribute("data-gallery-item-id"))t=parseInt(e.getAttribute("data-gallery-item-id"));else{var n=closest(e,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("data-gallery-item-id")});n&&(t=parseInt(n.getAttribute("data-gallery-item-id")))}return _.findWhere(i,{index:t}).meta.montessori.y})}this.bindLightboxArray(t)},setupPageLightbox:function(e){var t=this;if(!this.isAdminEdit){for(var i=[],n=$("img",this.el),o=[],a=0;a<n.length;a++){var r=n[a].hasAttribute("data-gallery-item-index")||n[a].parentNode.classList.contains("image-gallery");r&&o.length>0?(i.push(o),o=[]):r||o.push(n[a])}o.length>0&&i.push(o),_.each(i,function(e){t.bindLightboxArray(e)})}},bindLightboxArray:function(e){var t=this.model.get("images"),i=[],n=/Mobi/i.test(navigator.userAgent),o=Cargo.Model.DisplayOptions.get("layout_options")&&!Cargo.Model.DisplayOptions.get("layout_options").image_full_zoom;_.each(e,function(e){if(e.hasAttribute("data-src")&&null===closest(e,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("slick-cloned")||e.classList.contains("cloned_marquee_inner")||"A"===e.tagName})&&!e.hasAttribute("data-no-zoom")&&!e.hasAttribute("no-zoom")){if(n){var a,r=_.findWhere(t,{id:parseInt(e.getAttribute("data-mid"))});if(r){a=Math.floor(Math.min(250*Math.ceil(2*screen.width/250),r.get("width")));var s=r.getImageWithOptions({w:a,q:94});e._lightboxSrc=s.url,e._lightboxWidth=s.w,e._lightboxHeight=s.h}}i.push(e),e.classList.add("image-zoom"),e.addEventListener("click",function(t){var n=closest(e,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("marquee_inner")});lightbox.openImageArray(i,e,{disableZoom:o,preventAnimation:null!==n})})}})},autoplayVideos:function(){var e=this.$el.find(".page_content").get(0);if(void 0!==e&&!Cargo.Helper.IsAdminEdit()){var t=Cargo.Helper.isMobile();_.each(e.querySelectorAll("video[autoplay]"),function(e){if(!e._bound_by_pageView){e.hasAttribute("muted")&&(e.muted=!0),t&&!e.hasAttribute("playsinline")&&e.setAttribute("playsinline","");var i=e.hasAttribute("controls"),n=function(){i||e.removeAttribute("controls"),e.removeEventListener("play",n)};e.addEventListener("play",n);var o=e.play();void 0!==o&&o.then(function(){}).catch(function(t){e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2||e.play().catch(function(t){e.muted=!0,e.setAttribute("muted",""),e.play().catch(function(t){e.setAttribute("controls","")})})}),e._bound_by_pageView=!0}})}},getModel:function(){return this.model},markNodesAsOriginal:function(){var e=this.$el.find("projectcontent")[0];if(void 0!==e){Node.prototype.hasOwnProperty("setSaveable")&&this.getAllDescendants(e,function(e){e.setSaveable(!0)});var t=e.parentNode;for(t.setAttribute("data-ce-host","true"),t.setAttribute("data-ce-model-id",this.model.get("id"));e.childNodes.length>0;)t.insertBefore(e.childNodes[0],e);t.removeChild(e),0==t.querySelectorAll(".image-gallery").length&&this.autoplayVideos()}},getAllDescendants:function(e,t){for(var i=0;i<e.childNodes.length;i++){var n=e.childNodes[i],o=t(n);if(!1===o)return!1;"continue"!==o&&this.getAllDescendants(n,t)}},removeEmptyPagePadding:function(){if((!Cargo.Helper.IsAdminEdit()||top.Backbone.history.fragment!=this.model.get("id"))&&$(".page_content",this.$el).length>0){var e=""==$(".page_content",this.$el).html().trim(),t=this.$el.find("[data-backdrop]").length>0;e&&!t&&$("bodycopy",this.$el).removeClass("content_padding")}},getLocalCSSElement:function(){return this.el.querySelector(".local-css")},remove:function(){if(!this.preventRemove){var e=$(".page_content",this.$el)[0];e&&Cargo.Helper.isMobile()&&_.each(e.querySelectorAll("video"),function(e){e.pause(),e.src="",e.innerHTML="",e.load()}),Cargo.Core.AudioPlayer.destroyPlayers(this.el),void 0!==Cargo.Helper.throttledScrollMonitorUpdate&&Cargo.Helper.throttledScrollMonitorUpdate(),Backbone.View.prototype.remove.apply(this,arguments)}}}),Cargo.o.view.Set=Backbone.View.extend({constructor:function(){Backbone.View.prototype.constructor.apply(this,arguments)},initialize:function(e){this.parentSetView=e.parentSetView?e.parentSetView:null,null!==this.parentSetView&&this.listenTo(this.parentSetView,"remove",this.remove),this.listenTo(this,"remove",this.removeAllPages),this.listenTo(Cargo.Event,"pageview_removed",function(e){-1!==this.pageViews.indexOf(e)&&(this.pageViews=_.without(this.pageViews,e))});var t=!1;this.listenTo(this.model.get("pages"),"add",function(e,i,n){1==n.from_pagination?t=!0:!1!==n.render_changes&&this.render(!0,n)}),this.listenTo(this.model.get("pages"),"remove",function(e,t,i){var n=_.union(this.pageViews,this.setViews),o=_.findWhere(n,{model:e});o&&(o.remove(),this.pageViews=_.without(this.pageViews,o),this.setViews=_.without(this.setViews,o)),!0===i.render_changes&&this.render(!0,i),Cargo.Helper.throttledScrollMonitorUpdate()}),this.listenTo(Cargo.Event,"pagination_complete",function(e,i,n){t&&this.render(!0,n),t=!1}),this.listenTo(this.model,"tag_pagination_complete",function(e,i,n){t&&this.render(!0,n),t=!1}),this.listenTo(this.model,"destroy",function(){this.remove()}),this.pageViews=[],this.setViews=[],this.findAndInitializePrerenderedContent()},sortPagesAndUpdateDOM:function(){if(!(this.model.get("pages").length<=1)){this.model.get("pages").sort();var e=_.union(this.pageViews,this.setViews);e.sort(function(e,t){return e.model.get("sort")-t.model.get("sort")}),_.each(e,function(e){this.el.appendChild(e.el)},this)}},sortSetViews:function(){this.setViews.sort(function(e,t){return e.model.get("sort")-t.model.get("sort")})},sortPageViews:function(){this.pageViews.sort(function(e,t){return e.model.get("sort")-t.model.get("sort")})},removeAllPages:function(){_.each(this.pageViews,function(e){e.remove()}),this.pageViews=[]},removeAllSets:function(){_.each(this.setViews,function(e){e.remove()}),this.setViews=[]},render:function(e,t){t=t||{},_.defaults(t,{}),!0!==e&&(e=!1,this.removeAllPages(),this.removeAllSets());var i=!1,n=this.model.get("pages").getFirstIndexGap();this.model.get("pages").each(function(o,a,r){if("page"!==o.type||o.get("pin")){if("set"===o.type){if(e&&(void 0!==_.findWhere(this.setViews,{model:o})||void 0!==this.$el.children('[data-container="set"][data-id="'+o.get("id")+'"]')[0]))return;var s=Cargo.Core.SetViewFactory.constructSetView({parentSetView:this,model:o});s.el.setAttribute("data-container","set"),s.el.setAttribute("data-id",o.get("id")),this.el.appendChild(s.el),s.render(void 0,t),this.setViews.push(s),i=!0}}else{if(this.model.get("page_count")>1&&o.get("index")>n)return void console.warn("Pageview not rendered because set has gap before it.",o);if(e&&(void 0!==_.findWhere(this.pageViews,{model:o})||void 0!==this.$el.children('[data-container="page"][data-id="'+o.get("id")+'"]')[0]))return;var l;if(l="undefined"!=typeof __pin_preview_pageview__&&__pin_preview_pageview__.model===o?__pin_preview_pageview__:Cargo.Core.PageviewFactory.constructPageView({parentView:this,model:o}),e)if(a>0){var d=this.$el.children('[data-container][data-id="'+r[a-1].get("id")+'"]')[0];d?d.parentNode.insertBefore(l.el,d.nextSibling):0===o.get("index")&&Cargo.Helper.IsIndexableModel(o)?this.el.insertBefore(l.el,this.el.firstChild):this.el.appendChild(l.el)}else this.el.insertBefore(l.el,this.el.firstChild);else this.el.appendChild(l.el);l.render(),this.pageViews.push(l),i=!0}},this),i&&(this.sortPageViews(),this.sortSetViews(),Cargo.Event.trigger("set_render_complete",this,t))},findAndInitializePrerenderedContent:function(e){_.each(this.el.children,function(t){var i=t.getAttribute("data-container"),n=parseInt(t.getAttribute("data-id"),10),o=this.model.get("pages").findWhere({id:n});if(isNaN(Number(e))||n===e)if(o){if("set"===i){if(void 0===_.findWhere(this.setViews,{model:o})){var a=Cargo.Core.SetViewFactory.constructSetView({parentSetView:this,model:o,el:t});this.setViews.push(a)}}else if("page"===i&&void 0===_.findWhere(this.pageViews,{model:o})){var r=Cargo.Core.PageviewFactory.constructPageView({parentView:this,model:o,el:t});this.pageViews.push(r)}this.sortPageViews(),this.sortSetViews()}else Cargo.Collection.Scaffolding.fetchPageModel(n,{done:_.bind(function(e){e.get("id")===n&&(console.info("fetching",n,"success"),void 0!==this.model.get("pages").findWhere({id:n})?this.findAndInitializePrerenderedContent(n):console.info("can't locate newly added model."))},this)})},this)},getAllPageViews:function(){var e=[];return function t(i){e=_.union(e,i.pageViews),_.each(i.setViews,t)}(this),e},getAllSetViews:function(){var e=[];return function t(i){e=_.union(e,i.setViews),_.each(i.setViews,t)}(this),e},remove:function(){this.preventRemove||(Cargo.Helper.throttledScrollMonitorUpdate(),Backbone.View.prototype.remove.apply(this,arguments))}}),Cargo.o.view.Pin=Backbone.View.extend({no_render:!1,Data:{tallest_height:null},initialize:function(e){this.count=0,this.debouncedSortElements=_.debounce(this.sortElements,10),this.position=this.$el.data("view").replace("pinned_",""),this.template=$('[type="text/x-handlebars-template"]#pinned_'+this.position).html(),this.reversedSide="bottom",this.pinCollection=new Cargo.o.collection.pins(null,{position:this.position}),this.pinCollection.on("sort",this.debouncedSortElements,this),this.pinCollection.on("formatting_update_required",function(e,t){this.pinCollection.sort(),this.requestFormatTick()},this),this.initializePreRenderedPins(),this.requestFormatTick=_.bind(this.requestFormatTick,this),this.listenTo(Cargo.Event,"BaseUnit:refresh thumbnails_render_complete thumbnails_hide thumbnails_show pagination_complete inline-editor-load-complete set_render_complete elementresizer_refresh_complete",this.requestFormatTick,this),this.listenTo(Cargo.Event,"homepage_loaded content_load_complete refresh_pins mobile_breakpoint_triggered",function(){this.render(Cargo.Helper.GetCurrentProjectId(),!0)}),this.requestFormatTick(),"bottom"===this.position&&(this.pinCollection.each(function(e){var t=e.get("pageView").$el.find(".image-gallery").length>0;e.set({has_image_gallery:t})}),Cargo.Event.on("image_gallery_init_complete",_.bind(function(e){_.each(e,_.bind(function(e,t){var i=_.findWhere(this.pinCollection.models,{id:e});i&&i.set({image_gallery_init_completed:!0})},this))},this)))},initializePreRenderedPins:function(e){var t=[];this.$el.find('[data-container="content"]').each(_.bind(function(e,i){var n=parseInt($(i).data("id")),o=Cargo.Collection.Scaffolding.getModel({id:n});if(o){var a=new Cargo.o.view.Page({template:$('[type="text/x-handlebars-template"]#pin').html(),parentView:this,model:o,el:i.parentNode});t.push({id:n,pageView:a})}},this)),this.pinCollection.add(t);var i=this.filterExcludedPins(this.pinCollection.models);this.pinCollection.remove(_.pluck(i,"id"))},render:function(e,t){t=!0===t;var i,n,o,a=_.union(this.collection.getPinsByPositionSetId(this.position,!1),this.collection.getPinsByPositionSetId(this.position,e)),r=this.pinCollection.pluck("pageModel");o=this.filterExcludedPins(a,!0),t||(this.pinCollection.reset(),o=this.filterExcludedPins(this.pinCollection.models)),a=_.filter(a,function(e){return-1==o.indexOf(e)}),i=_.difference(r,a),i=_.union(i,o),n=_.difference(a,r),_.difference(r,i,n);var s,l=[];_.each(n,function(e){"undefined"!=typeof __pin_preview_pageview__&&__pin_preview_pageview__.model===e?(s=__pin_preview_pageview__).stopListening(e):s=new Cargo.o.view.Page({template:$('[type="text/x-handlebars-template"]#pin').html(),parentView:this,model:e}),this.el.appendChild(s.el),s.render(),l.push({id:e.get("id"),pageView:s})},this),this.pinCollection.remove(_.pluck(i,"id")),this.pinCollection.add(l),(i.length>0||n.length>0)&&this.sortElements(),void 0!==Cargo.View.Content.activeLinkPID&&Cargo.View.Content.checkActiveLinks(Cargo.View.Content.activeLinkPID),(i.length>0||n.length>0)&&Cargo.Event.trigger("pin_load_complete")},filterExcludedPins:function(e,t){var i=document.documentElement.clientWidth,n=Cargo.Helper.IsMobileWindowSize(i),o=void 0!==Cargo.Helper.GetCurrentRoute()?Cargo.Helper.GetCurrentRoute():window.location.pathname.replace(/\//g,"");return _this=this,_.filter(e,function(e){if(Cargo.__admin_pid_required__===e.get("id"))return!1;var i=t?e:e.get("pageModel"),a=i.get("project_url"),r=i.getPinOption("exclude_mobile");if(o==a)var s=!0;return n&&r&&!s})},sortElements:function(){this.pinCollection.each(function(e){this.el.appendChild(e.get("pageView").el)},this),this.requestFormatTick()},getPageViewById:function(e){var t=this.pinCollection.findWhere({id:e});if(void 0!==t)return t.get("pageView")},requestFormatTick:function(){var e=this;this.ticking||(this.ticking=!0,requestAnimationFrame(function(t){e.formatOverlayPages(),e.ticking=!1}))},formatOverlayPages:function(){this.formatting||(this.formatting=!0,this.levelKeys=_.keys(this.pinCollection.levels),this.pinCollection.each(function(e){var t=window.getComputedStyle(e.get("pageView").el,null),i=parseFloat(t.height)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom);e.set({page_height:i}),_.delay(_.bind(function(){this.setPagePointerEvents(e.get("pageModel"),e.get("pageView").$el)},this),250)},this),this.accommodatePages(),this.setHeightPerLevel(),this.positionPages(),this.setContainerHeight(),this.setContentContainerHeightforBottomPins(),Cargo.Event.trigger("pin_format_complete",this.position),this.formatting=!1,this.allowFixedSiteMenuToScroll(),"bottom"==this.position&&setTimeout(_.bind(function(){this.showAllBottomHiddenPins()},this),800))},allowFixedSiteMenuToScroll:function(){Cargo.View.SiteMenu&&Cargo.Helper.isMobile()&&Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth)&&(1==this.pinCollection.length&&1==Cargo.View.SiteMenu.collection.length&&this.pinCollection.models[0].get("id")==Cargo.View.SiteMenu.collection.models[0].get("id")&&Cargo.Router._lastFrag==Cargo.View.SiteMenu.collection.models[0].get("project_url")&&(this.pinCollection.models[0].get("pageView").$el.removeClass("overlay fixed"),this.$el.css("height","")))},setContainerHeight:function(){var e=0;_.each(this.pinCollection.levels,function(t,i){e+=parseFloat(t.overall_height)}),this.$el.css("height",e)},setContentContainerHeightforBottomPins:function(){var e=$(".content_container"),t=!1;Cargo.Helper.IsAdminEdit()&&void 0!==parent&&void 0!==parent.Cargo&&void 0!==parent.Cargo.Editor&&void 0!==parent.Cargo.Editor.View&&void 0!==parent.Cargo.Editor.View.ContentView&&"editproject"===parent.Cargo.Editor.View.ContentView.id&&void 0!==Cargo.View.Content?(_.each(Cargo.View.Content.getActivePageViews(),function(e){e.model.id==Cargo.Helper.GetHomepageId()&&(t=!0)}),void 0===_.findWhere(this.pinCollection.models,{id:parent.Cargo.Editor.View.ContentView.pid})||"bottom"!=this.pinCollection.position||t?e.removeClass("full_height"):e.addClass("full_height")):e.removeClass("full_height")},setHeightPerLevel:function(){var e=this;_.each(this.pinCollection.levels,function(t,i){i=parseInt(i,10);if(0!==t.models.length){var n=0;self_accommodating=void 0!==t.tallest&&t.tallest.get("accommodate_same_set"),height_pages=_.filter(t.models,function(e){var i=e.getPinOptions(),n=!i.overlay&&!i.fixed,o=self_accommodating&&e==t.tallest;return n||o}),_.each(height_pages,function(e){n+=e.get("page_height")});var o=_.filter(t.models,function(t){if(void 0!==t.get("accommodated_by_pid"))return e.getPageDepthByPid(t.get("accommodated_by_pid"))!==i})[0];void 0!==o&&(n+=o.get("page_padding")),t.overall_height=n}})},positionPages:function(){var e=this,t=this.position;opposite_position="bottom"==this.position?"top":"bottom",this.pinCollection.each(function(i){var n=0,o=i.getPinOptions(),a=(i.get("id"),!o.fixed&&!o.overlay),r=!1,s=i.get("depth"),l=(i.get("sort"),e.levelKeys[e.levelKeys.indexOf(s+"")+1]),d=e.levelKeys[e.levelKeys.indexOf(s+"")-1],c=(e.pinCollection.levels[l],e.pinCollection.levels[d]),h=e.pinCollection.levels[s];if("bottom"==t){for(var u=0;u<=s;u++){var g=e.pinCollection.levels[u-1];void 0!==g&&(void 0===g.tallest||g.tallest.get("accommodated_next_set")?null==g.tallest&&(n+=g.overall_height):n+=g.overall_height)}a?c&&null==c.tallest?n-=c.overall_height:c&&void 0!==c.tallest&&c.tallest.get("accommodate_same_set")?n-=c.overall_height:0==s&&h&&h.tallest&&h.tallest.get("accommodate_same_set")&&(n-=h.tallest.get("page_height")):r=!0}else{for(u=0;u<=s;u++)void 0!==e.pinCollection.levels[u-1]&&(n+=e.pinCollection.levels[u-1].overall_height);a?c&&null==c.tallest?n-=c.overall_height:c&&void 0!==c.tallest&&c.tallest.get("accommodate_same_set")?n-=c.overall_height:void 0!==h.tallest&&h.tallest.get("accommodate_same_set")&&void 0!==c&&void 0!==c.tallest&&c.tallest.get("id")!==i.get("accommodated_by_pid")&&(n+=c.tallest.get("page_height")):r=!0}r&&s>0&&void 0!==d&&void 0!==c&&void 0!==c.tallest&&c.tallest.get("id")!==i.get("accommodated_by_pid")&&1==h.accommodated_by_previous_set&&(n+=c.tallest.get("page_height"));var p=i.get("pageView").$el[0];if(p.style[t]=n+"px",p.style[opposite_position]="",o.overlay){var m=0;if(void 0!==h)m=h.models.slice().reverse().indexOf(i);p.style.zIndex=e.pinCollection.deepestLevel+-s+4+m}})},removeModelFlags:function(){_.each(this.pinCollection.models,function(e){e.unset("accommodated_by_pid")})},removeLevelFlags:function(){_.each(this.pinCollection.levels,function(e,t){void 0!==e.accommodated_by_previous_set&&(e.accommodated_by_previous_set=!1),void 0!==e.accommodated_by_same_set&&(e.accommodated_by_same_set=!1)})},accommodatePages:function(){this.removeAccommodatePadding(),this.removeModelFlags(),this.removeLevelFlags();var e=this.position,t=this;_.each(this.pinCollection.levels,function(i,n){if(0!==i.models.length&&(n=parseInt(n,10),next_depth=t.levelKeys[t.levelKeys.indexOf(n+"")+1],prev_depth=t.levelKeys[t.levelKeys.indexOf(n+"")-1],i.tallest&&(i.tallest.unset("accommodate_same_set"),i.tallest.unset("accommodated_next_set"),i.tallest.unset("accommodated_pin"),i.tallest.unset("accommodated_pid"),i.tallest.unset("content_accommodate_page")),i.tallest=void 0,_.each(i.models,function(e){var t=e.getPinOptions();t.overlay&&t.accommodate&&(!i.tallest||e.get("page_height")>i.tallest.get("page_height"))&&(i.tallest=e)}),_.each(i.models,_.bind(function(e){e!==i.tallest&&this.showBottomHiddenPin(e)},this)),null!=i.tallest)){var o=this.reversedSide,a=_.filter(i.models,function(e){var t=e.getPinOptions();return!t.overlay&&!t.fixed}).sort(function(t,i){return e==o?i.get("sort")-t.get("sort"):t.get("sort")-i.get("sort")})[0];if(a)return this.accommodateSinglePage(a,i.tallest),i.tallest.set({accommodate_same_set:!0,accommodated_pin:!0,accommodated_pid:a.get("id")}),void(i.accommodated_by_same_set=!0);var r=this.pinCollection.levels[next_depth];if(r){var s=_.filter(r.models,function(e){return e.getPinOptions().overlay}).sort(function(t,i){return e==o?i.get("sort")-t.get("sort"):t.get("sort")-i.get("sort")})[0];if(null==s&&(s=_.filter(r.models,function(e){return!e.getPinOptions().overlay}).sort(function(t,i){return e==o?i.get("sort")-t.get("sort"):t.get("sort")-i.get("sort")})[0]),s)return this.accommodateSinglePage(s,i.tallest),r.accommodated_by_previous_set=!0,void i.tallest.set({accommodated_pin:!0,accommodated_pid:s.get("id"),accommodated_next_set:!0})}n===this.pinCollection.deepestLevel&&(this.accommodateSinglePagebyElement($(this.getContentContainerElementToAccommodate()),i.tallest),i.tallest.set("content_accommodate_page",!0))}},this)},removeAccommodatePadding:function(){var e="padding-"+this.position;this.pinCollection.each(function(t){t.get("page_padding")>0&&(t.get("pageView").$el.css({"padding-top":"","padding-bottom":"",top:"",bottom:""}).removeAttr("data-"+e),t.set("page_padding",0))}),$("[data-"+e+"]").css(e,"").removeAttr("data-"+e),$("[data-content-accommodated]").css(e,"").removeAttr("data-content-accommodated")},accommodateSinglePage:function(e,t){var i=t.get("page_height"),n="padding-"+this.position;e.get("pageView").$el.css(n,i).attr("data-"+n,!0),e.set({page_padding:i,accommodated_by_pid:t.get("id")}),this.showBottomHiddenPin(t)},showAllBottomHiddenPins:function(){_.each(this.pinCollection.models,_.bind(function(e){e.get("pageView").$el.removeClass("bottom_pin_invisibility")},this))},showBottomHiddenPin:function(e){!0===e.get("has_image_gallery")?e.get("image_gallery_init_completed")&&e.get("pageView").$el.removeClass("bottom_pin_invisibility"):!1===e.get("has_image_gallery")&&e.get("pageView").$el.removeClass("bottom_pin_invisibility")},getContentContainerElementToAccommodate:function(){var e,t,i=$('.content_container [data-container="page"]');i.length>0&&(e=i.get(0),t=i.get(i.length-1));var n=!1,o=Cargo.View.Thumbnail;return o&&(n=Cargo.View.Thumbnail.show_thumbs),"top"==this.position?e||(n?o.el:void 0):"bottom"==this.position?n&&o?o.el:t||void 0:void 0},accommodateSinglePagebyElement:function(e,t){var i=t.get("page_height"),n="padding-"+this.position;if($(e).css(n,i).attr("data-"+n,!0).attr("data-content-accommodated",!0),void 0!==$(e).attr("data-id")){var o=_.findWhere(this.current_page_models,{id:$(e).attr("data-id")});void 0!==o&&o.set("page_padding",i)}this.showBottomHiddenPin(t)},setPagePointerEvents:function(e,t){if(e.get("pin_options").overlay){var i=t.find(".bodycopy")[0],n=this.hasNoBackgroundColor(t.find(".page_background")[0]),o=this.hasNoBackgroundColor(t.find(".page")[0]),a=void 0!==i&&parseFloat(window.getComputedStyle(t.find(".bodycopy")[0]).height)>baseUnit.cache.window.h;if(!t.find(".page_background")[0])return;0==e.get("backdrop_enabled")&&(n?t.addClass("pointer-events-none"):t.removeClass("pointer-events-none"),o&&!a||!e.get("pin_options").fixed?t.find(".page").removeClass("pointer-events-auto"):t.find(".page").addClass("pointer-events-auto")),a&&e.get("pin_options").fixed?(t.find(".page").addClass("allow-scroll"),Cargo.Helper.isMobile()&&"bottom"==e.get("pin_options").position&&setTimeout(function(){t.css({bottom:"",top:0})},10)):t.find(".page").removeClass("allow-scroll")}},hasNoBackgroundColor:function(e){if(null==e)return!1;var t=window.getComputedStyle(e,null).getPropertyValue("background-color"),i=t.match("rgba")?alpha=t.replace(/^.*,(.+)\)/,"$1"):null;return null==t||"transparent"==t||"initial"==t||0==i},getPageDepthByPid:function(e){return this.pinCollection.findWhere({id:parseInt(e)}).get("depth")}}),Cargo.o.view.SiteMenu=Backbone.View.extend({template:$('[type="text/x-handlebars-template"]#sitemenu').html(),events:{'click [rel="history"]':"navigate",'click [rel="home_page"]':"navigateHome",click:"close",touchstart:"close","click .close":"hide"},enabled:null,initialize:function(e){Cargo.Event.on("content_load_complete",_.bind(this.hide,this)),Cargo.Event.on("homepage_loaded",_.bind(this.hide,this)),this.collection.fetch()},generateSiteMenuTree:function(){var e=Cargo.Collection.Scaffolding.getSetStructure(),t=this.collection.toJSON();for(_.each(e._byId,function(e){e.in_nav=void 0!==_.findWhere(t,{id:e.id}),e.has_children=!1}),i=0;i<t.length;i++)menuItem=t[i],"set"===menuItem.type?i>0&&(e._byId[menuItem.id].previous_type=t[i-1].is_set?"set":"page"):e._byId[menuItem.set_id]&&(e._byId[menuItem.set_id].has_children=!0,e._byId[menuItem.set_id].pages.push(menuItem));_.each(e._byId,function(e){e.pages.sort(function(e,t){return e.sort-t.sort})}),this.SiteMenuTree=e.tree,e=null},render:function(e){this.SiteMenuTree||this.generateSiteMenuTree(),this.site_menu_options=Cargo.Model.DisplayOptions.get("site_menu_options");var t=this.site_menu_options.display_type;if("page"!=t){var i=Cargo.API.GetDataPackage("site_menu_tree",this.SiteMenuTree);i=_.extend(i,{is_page:t});var n=Cargo.Core.Handlebars.Render(this.template,i);return $("#site_menu_panel_container",this.el).empty().show().html(n),$("html").addClass("no-scroll"),this.delegateEvents(),this.setActivePage(),this}},isActive:function(){return this.enabled},renderSinglePageView:function(e){var t=$("#site_menu_panel_container")[0];if(t){var i=Cargo.Core.PageviewFactory.constructPageView({model:e});t.innerHTML="",t.appendChild(i.el),t.style.display="",i.render(),i.$el.on("click",function(i){0==$(i.target).closest('[data-container="content"]').length&&0==e.get("backdrop_enabled")&&(t.style.display="none")})}},setActivePage:function(e){Cargo.Helper.IsOnHomepage()&&$('[rel="home_page"]',this.el).addClass("active");var t=Cargo.Helper.GetCurrentProjectUrl();$('[href="'+t+'"]',this.el).addClass("active")},show:function(e,t){var i;void 0!==e?(e.preventDefault(),i=$(e.currentTarget)):void 0!==t&&(i=t);var n=Cargo.Model.DisplayOptions.get("site_menu_options");if(void 0!==i&&i.is("#site_menu_button")&&i[0].hasAttribute("href"))"/"!==i.attr("href")?(Cargo.Event.trigger("add_history",i.attr("href")),this.enabled=!0):Cargo.Modal.Alert({message:"Page Not Found"});else{if("page"==n.display_type)return Cargo.Event.trigger("add_history",n.single_page_id),void(this.enabled=!0);$("#site_menu_button",this.el)[0].style.display="none",this.render(e),$("body")[0].style.overflow="hidden",this.enabled=!0}},hide:function(){var e=Cargo.Model.DisplayOptions.get("site_menu_options");$("#site_menu_panel_container",this.el)[0].style.display="none","page"===e.display_type&&e.single_page_id==parseInt(Cargo.Helper.GetCurrentProjectId())?setTimeout(_.bind(function(){this.enabled=!0,$("#site_menu_button",this.el)[0].style.display="none"},this),1):(this.enabled=!1,$("#site_menu_button",this.el)[0].style.display=""),$("body")[0].style.overflow=""},close:function(e){"site_menu_panel"==$(e.target).attr("id")&&this.hide()},navigate:function(e){Cargo.View.Main.HistoryPush(e),this.isActive()&&this.hide()},navigateHome:function(e){Cargo.View.Main.ShowHome(e),this.hide()},updateTitle:function(e,t){"page"==Cargo.Model.DisplayOptions.get("site_menu_options").display_type&&$("#site_menu_button",this.el).attr("href",t)},changeDisplayType:function(e,t,i){$("[data-type]",this.el).attr("data-type",e),this.$el.attr("data-type",e),"cargo_menu"==e?$("#site_menu_button",this.el).removeAttr("href"):this.UpdateSinglePageLink(t)},UpdateSinglePageLink:function(e){var t=Cargo.Collection.Scaffolding.getSetOrPageModel({id:Number(e)},!1);if(t)$("#site_menu_button",this.el).attr("href",t.get("project_url"));else{var i=this;Cargo.Collection.Scaffolding.fetchPageModel(e,{done:function(e,t){$("#site_menu_button",i.el).attr("href",e.get("project_url"))}})}}}),Cargo.o.view.Following=Backbone.View.extend({className:"persona-following-root",fauxFixedElements:[],animationDuration:600,animationInProgress:!1,followingWidth:"400px",enabled:!1,iframeLoadInitialized:!1,iframeLoaded:!1,section:!1,slideData:{delta:1,offset:0,lastOffset:0,closing:!0},initialize:function(){this.isInAdminOrPreviewMode=Cargo.Helper.IsAdminPath()||Cargo.Helper.IsAdminEdit()||Cargo.Helper.IsPresetPreview(),this.messageQueue=[],this.contentFrame=document.createElement("iframe"),this.contentFrame.id="following-frame",this.contentFrame.style.display="none",this.contentFrame.style.border="none",this.contentFrame.name="following-frame",this.followingOverlay=document.createElement("div"),this.followingOverlay.id="following-overlay",this.followingOverlay.style.display="none",this.followingOverlay.style.cursor="pointer",this.followingOverlay.style.position="fixed",this.followingOverlay.style.top=0,this.followingOverlay.style.left=0,this.followingOverlay.style.right=0,this.followingOverlay.style.bottom=0,this.followingOverlay.style.zIndex=2147483637,this.followingOverlay.addEventListener("click",_.bind(this.close,this)),document.body.appendChild(this.followingOverlay),document.documentElement.appendChild(this.render().el);var e=document.createElement("div");e.id="following-container",this.el.parentNode.insertBefore(e,this.el),e.appendChild(this.el),this.container=$(e),this.contentFrame=$(this.contentFrame),/^\/?follow/.test(document.location.pathname)||/^\/?contact-form/.test(document.location.pathname)||/^\/?cart/.test(document.location.pathname)||!1===Cargo.Helper.isMobile()&&$(window).load(_.bind(function(){setTimeout(_.bind(function(){this.iframeLoadInitialized||this.loadFrameSection()},this),5e3)},this))},render:function(){return this.setElement(this.contentFrame),this},triggerEventInFrame:function(e,t){if(this.messageQueue)return this.iframeLoaded&&this.el.contentWindow&&this.el.contentWindow.Following?void this.el.contentWindow.Following.Events.trigger(e,t):(this.iframeLoadInitialized||this.loadFrameSection(),void this.messageQueue.push(arguments))},Toggle:function(){if(!0!==this.animationInProgress)if(this.enabled)(null==Cargo.Router.previousSiteRoute||Cargo.Router.previousSiteRoute.match(/following/g)||Cargo.Router.previousSiteRoute.match(/followers/g)||Cargo.Router.previousSiteRoute.match(/contact-form/g)||Cargo.Router.previousSiteRoute.match(/cart/g))&&(Cargo.Router.previousSiteRoute="/"),Cargo.Router.navigate(Cargo.Router.previousSiteRoute,{trigger:!1}),this.disable();else{Cargo.Event.trigger("add_history","following");var e=parent.document.getElementById("login_frame");null!==e&&e.parentNode.removeChild(e)}},loadSection:function(e,t){this.enabled||this.enable(t),this.loadFrameSection(e,t)},loadFrameSection:function(e,t){this.isInAdminOrPreviewMode&&!0!==t||(!0!==this.iframeLoadInitialized?($(this.contentFrame).on("load",_.bind(function(){this.iframeLoaded=!0,this.messageQueue.length>0&&this.el.contentWindow.Following.Events.on("init-complete",function(){_.each(this.messageQueue,function(e){this.triggerEventInFrame.apply(this,e)},this),this.messageQueue=[]},this)},this)),this.contentFrame.attr("src","/followingframe/"+Cargo.Helper.GetUrl()+("string"==typeof e?"/"+e:"")+"?"+__cargo_js_ver__),this.iframeLoadInitialized=!0):this.el.contentWindow&&void 0!==this.el.contentWindow.Following&&void 0!==this.el.contentWindow.Following.View&&void 0!==this.el.contentWindow.Following.View.Main?(null==e&&void 0!==this.el.contentWindow.Following.View.Main.start_route&&(e=this.el.contentWindow.Following.View.Main.start_route),this.el.contentWindow.Following.Router.navigate(e,{trigger:!0,replace:!0})):this.contentFrame.attr("src","/followingframe/"+Cargo.Helper.GetUrl()+("string"==typeof e?"/"+e:"")+"?"+__cargo_js_ver__))},updateCookieData:function(){this.el.contentWindow&&void 0!==this.el.contentWindow.Following&&this.el.contentWindow.Following.Model.Default.fetch()},resizeListener:function(e){var t=document.getElementsByTagName("html")[0],i=window.innerWidth+"px",n=window.innerHeight+"px";!0===e&&(i="",n=""),t.style.width=i,t.style.height=n,document.body.style.width=i,document.body.style.height=n,$(window).width()>500?this.followingWidth="400px":this.followingWidth=$(window).width()-40+"px",this.enabled&&(document.body.style.setProperty("transform","translateX(-"+this.followingWidth+")"),document.body.style.setProperty("-webkit-transform","translateX(-"+this.followingWidth+")")),$("#following-container").css({width:this.followingWidth,height:n})},enable:function(e){if((!this.isInAdminOrPreviewMode||!0===e)&&!0!==this.animationInProgress){document.body,document.getElementsByTagName("html")[0];if(this.fixedElements=this.getFixedElements(),$('<div id="following-container-overlap" />').insertAfter(this.$el.parent()),this.animationInProgress=!0,this.scrollAnchor=document.createElement("div"),this.scrollPos=window.scrollY,this.inlineStyles=document.createElement("style"),this.tempInlineStyles=document.createElement("style"),this.scrollAnchor.style.position="absolute",this.scrollAnchor.style.width="0px",this.scrollAnchor.style.height="0px",this.scrollAnchor.style.top=this.scrollPos+"px",document.body.appendChild(this.scrollAnchor),document.body.appendChild(this.tempInlineStyles),document.body.appendChild(this.inlineStyles),Cargo.Router.is_first_route)return this.direct_route=!0,this.prepareElementsForAnimation(),void this.realEnable();window.requestAnimationFrame(_.bind(function(){this.prepareElementsForAnimation(),window.setTimeout(_.bind(function(){window.requestAnimationFrame(_.bind(this.realEnable,this))},this),150)},this))}},prepareElementsForAnimation:function(){var e=document.body,t=document.getElementsByTagName("html")[0];this.tempInlineStyles.sheet.insertRule(".backdrop > div > * { \t-webkit-transform: translateZ(0);\t\t\ttransform: translateZ(0);}",0),e.style.setProperty("z-index","1"),e.style.setProperty("transform","translateZ(0)"),e.style.setProperty("-webkit-transform","rotateZ(0)"),e.style.setProperty("min-height",window.innerHeight+"px"),t.style.setProperty("transform","translateZ(0)"),t.style.setProperty("-webkit-transform","rotateZ(0)"),t.style.setProperty("min-height",window.innerHeight+"px"),this.container.css({transform:"translateX("+this.followingWidth+")","-webkit-transform":"translateX("+this.followingWidth+")"}),this.contentFrame.css({transform:"translateX(-"+this.followingWidth+")","-webkit-transform":"translateX(-"+this.followingWidth+")"}),this.resizeListener(),this.fixFixedElements(this.fixedElements),this.fixedElements=void 0,e.style.setProperty("position","fixed"),e.style.setProperty("overflow","hidden"),t.style.setProperty("position","fixed"),t.style.setProperty("overflow","hidden"),setTimeout(_.bind(function(){this.resizeListener()},this),150),this.scrollAnchor.scrollIntoView()},realEnable:function(){this.triggerEventInFrame("frame-animation-starting",{});var e=this;this.inlineStyles.sheet.insertRule("#following-container { \twidth: "+this.followingWidth+";\theight: 100%;\tposition: absolute;\ttop: 0;\tbottom: 0;\tright: 0;}",0),this.scrollAnchor.scrollIntoView(),this.resizeListener=_.bind(this.resizeListener,this),window.addEventListener("resize",this.resizeListener,!1),this.scrollAnchor.parentNode.removeChild(this.scrollAnchor),this.scrollAnchor=void 0;var t=this.direct_route?0:e.animationDuration;try{null!==this.contentFrame[0].contentWindow.document.body&&(this.contentFrame[0].contentWindow.document.body.style.display="none",setTimeout(function(){e.contentFrame[0].contentWindow.document.body.style.display="block"}))}catch(e){console.info(e)}$("body, #following-container-overlap").velocity({translateX:"-"+e.followingWidth,translateZ:0},{duration:t,easing:[29,9],complete:function(){e.enabled=!0,e.animationInProgress=!1,e.enableClickToClose(),e.tempInlineStyles.sheet.disabled=!0,e.direct_route=!1,_.each(Cargo.Plugins.elementResizer.targets(),function(e){_.each(e.children,function(e){e&&e.element&&e.element[0]._scrollWatcher&&!e.element[0].hasAttribute("src")&&e.element[0]._scrollWatcher.recalculateLocation()})}),scrollMonitor.update(),$("#following-container-overlap").remove()}}),this.container.velocity({translateX:[0,parseInt(this.followingWidth)],tween:[0,1]},{duration:t,easing:[29,9],progress:function(t,i,n,o,a){a<0&&e.container.css({transform:"translateX(0px)","-webkit-transform":"translateX(0px)"})}}),this.contentFrame.velocity({translateX:[0,-parseInt(this.followingWidth)],tween:[0,1]},{duration:t,easing:[29,9],progress:function(t,i,n,o,a){a<0&&e.contentFrame.css({transform:"translateX(0px)","-webkit-transform":"translateX(0px)"})}}),this.el.style.display=""},enableClickToClose:function(){this.followingOverlay.style.display="block"},disableClickToClose:function(){this.followingOverlay.style.display="none"},slideStart:function(e){$(window).on("mousemove touchmove",{slideData:this.slideData,slideEnd:_.bind(this.slideEnd,this),offset:e.clientX,width:this.followingWidth},this.slideMove)},slideMove:function(e){e.preventDefault();var t=e.data.slideData,i=0,n=parseInt(e.data.width),o=n-(i=event.touches?event.touches[0].clientX-e.data.offset:e.clientX-e.data.offset);t.delta=1-Math.abs(i-t.offsetLast)/30*1,t.delta<.3?t.delta=.3:t.delta>1&&(t.delta=1),i<0?o=n:o<0&&(o=0,e.data.slideEnd()),$("body, #following-container-overlap").velocity("stop").velocity({translateX:-1*o},1),t.closing=i>=t.offsetLast,t.offsetLast=i},slideEnd:function(e){this.slideData.closing?this.close():$("body, #following-container-overlap").velocity("stop").velocity({translateX:"-"+this.followingWidth,translateZ:0},{duration:this.animationDuration*this.slideData.delta,easing:[29,9]}),$(window).off("mousemove touchstart",this.slideMove),this.slideData.closing=!0,this.slideData.offsetLast=0,this.slideData.delta=1},close:function(){this.Toggle()},disable:function(){window.requestAnimationFrame(_.bind(this.realDisable,this))},realDisable:function(){if(!0!==this.animationInProgress){this.animationInProgress=!0,window.focus(),void 0!==this.el.contentWindow.Following&&this.el.contentWindow.Following.Events.trigger("disable");var e=this;this.tempInlineStyles&&this.tempInlineStyles.sheet&&(this.tempInlineStyles.sheet.disabled=!1),$("body, #following-container-overlap").velocity({translateX:0,translateZ:0},{begin:function(){$(this).css("cursor","auto")},duration:this.animationDuration*this.slideData.delta,easing:[25,8.5],complete:function(){e.enabled=!1,e.animationInProgress=!1,$(this).css({transform:"","-webkit-transform":""}),e.unfixFixedElements(),void 0!==e.inlineStyles&&(e.inlineStyles.sheet.disabled=!0,e.inlineStyles.parentNode.removeChild(e.inlineStyles)),void 0!==e.tempInlineStyles&&(e.tempInlineStyles.sheet.disabled=!0,e.tempInlineStyles.parentNode.removeChild(e.tempInlineStyles));var t=document.body,i=document.getElementsByTagName("html")[0];t.style.setProperty("z-index",""),t.style.setProperty("transform",""),t.style.setProperty("-webkit-transform",""),t.style.setProperty("min-height",""),i.style.setProperty("transform",""),i.style.setProperty("-webkit-transform",""),i.style.setProperty("min-height",""),t.style.setProperty("position",""),t.style.setProperty("overflow",""),i.style.setProperty("position",""),i.style.setProperty("overflow",""),e.resizeListener(!0),window.scrollTo(0,e.scrollPos),window.removeEventListener("resize",e.resizeListener,!1),e.disableClickToClose(),e.el.style.display="none"}}),this.container.velocity({translateX:[parseInt(this.followingWidth),0]},{duration:this.animationDuration*this.slideData.delta,easing:[25,8.5]}),this.contentFrame.velocity({translateX:[-parseInt(this.followingWidth),0]},{duration:this.animationDuration*this.slideData.delta,easing:[25,8.5]})}},isActive:function(){return this.enabled},getFixedElements:function(e){void 0===e&&(e=window.document);var t,i,n,o,a,r,s,l=['[style*="position:fixed"],[style*="position: fixed"]'],d=/\bposition:\s*fixed;/,c=e.styleSheets,h=[];for(i=0;i<c.length;i++){try{a=c[i].cssRules}catch(e){continue}if(null!==a)for(o=a.length,n=0;n<o;n++)r=a[n],d.test(r.cssText)&&null!=r.selectorText&&l.push(r.selectorText)}for(l=l.join(","),o=(l=e.querySelectorAll(l)).length,i=0;i<o;i++)s=l[i],"fixed"===(t=window.getComputedStyle(s,null)).getPropertyValue("position")&&h.push({el:s,offset:{left:isNaN(parseInt(t.getPropertyValue("left")))?0:parseInt(t.getPropertyValue("left")),top:isNaN(parseInt(t.getPropertyValue("top")))?0:parseInt(t.getPropertyValue("top"))},webkitTransformMatrix:"none"===t.getPropertyValue("-webkit-transform")?"":t.getPropertyValue("-webkit-transform"),transformMatrix:"none"===t.getPropertyValue("transform")?"":t.getPropertyValue("transform"),styleAttribute:s.getAttribute("style")});return h},fixFixedElements:function(e){var t=this;this.unfixFixedElements();var i={top:$(window).scrollTop(),left:$(window).scrollLeft()};lastScrollPos=i.top,void 0===e&&(e=this.getFixedElements()),Cargo.Helper.isEdge()&&(i.top=0),this.scrollOffset=i,e.forEach(function(e){e.el.style.setProperty("transform","translateY("+i.top+"px) "+e.transformMatrix,"important"),e.el.style.setProperty("-webkit-transform","translateY("+i.top+"px) "+e.webkitTransformMatrix,"important"),e.el.style.setProperty("transition","none","important"),e.el.style.setProperty("-webkit-transition","none","important"),t.fauxFixedElements.push(e)})},unfixFixedElements:function(){this.fauxFixedElements.forEach(function(e){e.el.style.removeProperty("transform"),e.el.style.removeProperty("-webkit-transform"),setTimeout(function(){null===e.styleAttribute||""===e.styleAttribute?e.el.removeAttribute("style"):e.el.setAttribute("style",e.styleAttribute)},1)}),this.scrollOffset=void 0,this.fauxFixedElements=[]}}),Cargo.o.view.FollowingButton=Backbone.View.extend({initialize:function(){var e=this;if(!0!==Cargo.Helper.IsAdminPath())return Cargo.API.Config.preview||Cargo.Helper.IsAdminEdit()?($.get("/dispatch/auth/getFollowingToolset",function(e){e.html&&$("body").prepend(e.html)},"json"),!1):void $.getJSON(Cargo.Helper.GetAuthDomain()+"/dispatch/auth/followingAuth/"+Cargo.Helper.GetUrl()+"?callback=?",function(t){!0!==Cargo.InspectorLoading&&($.post("/dispatch/auth/followingAuthLocal",{token:t.jdata.token,url:t.jdata.url,muid:t.jdata.muid,cv:t.jdata.cv},function(t){e.InitFollowingClick(),e.Init(t.jdata)},"json"),t.html&&($("body").prepend(t.html),e.InitFollowingClick(),e.Init(t.jdata)))})},InitFollowingClick:function(){Cargo.Helper.IsAdminBackdrop()?$("#toolset a",this.el).attr("href",Cargo.Model.Site.get("home_url")).attr("target","_top"):parent===window?$("#toolset_follow a").off().on("click",function(e){if(e.preventDefault(),$(this).closest("#toolset_follow").hasClass("noclick"))return!1;Cargo.View.Following.Toggle()}):$("#toolset_follow",this.el).addClass("noclick")},Init:function(e){Cargo.API.Config.cookie_url=e.cookie_url,Cargo.API.Config.cookie_link=e.cookie_link,Cargo.API.Config.cookie_site_count=e.cookie_site_count,"object"==typeof Cargo.View.Following&&"object"==typeof Cargo.View.Following.el&&Cargo.View.Following.updateCookieData()}}),Cargo.o.view.Thumbnail=Backbone.View.extend({name:"Thumbnail",isEditing:!1,Subview:!1,MobileSubview:!1,PageModel:!1,ContentModel:!1,templates:{},template:$('[type="text/x-handlebars-template"]#thumbnail').html(),initialize:function(){return this.model||(this.model=Cargo.Model.ThumbnailSettings),Cargo.Event.on("mobile_size",_.bind(this.checkSizeAndActivateView,this)),Cargo.Event.on("content_load_complete",_.bind(function(e){this.checkAndLoadThumbnails(e)},this)),Cargo.Event.on("homepage_loaded",this.checkAndLoadThumbnails,this),Cargo.Event.on("thumbnails:load_tag",function(e,t){var i;t?(isNaN(Number(t))||(i=Cargo.Collection.Scaffolding.getSetOrPageModel({id:Number(t)})),i||(i=Cargo.Collection.Scaffolding.getModelByPurl(t)),i&&(t=i.get("id")),this.ContentModel=i,this.loadThumbnailsFor(void 0,{set_id:t,tags:e})):this.checkAndLoadThumbnails(void 0,{tags:e})},this),this.show_thumbs=null,this},events:{dragstart:"dragstart"},dragstart:function(e){if(Cargo.API.Config.cookie_url&&e.target.nodeType===Node.ELEMENT_NODE&&"IMG"===e.target.nodeName&&e.target.hasAttribute("data-mid")){var t=parseInt($(e.target).closest("[data-id]").attr("data-id"));if(!isNaN(t)){var i=this.collection.findWhere({id:t});if(i.get("thumb_meta")&&i.get("thumb_meta").thumbnail_crop){var n=new Cargo.o.model.image(i.get("thumb_meta").thumbnail_crop.imageModel);if(n&&0==/(.*?)\.(svg)$/g.test(n.getOriginalImage().url)){var o={drag_image_src:e.target.getAttribute("src"),image_url:n.getOriginalImage().url,source_url:window.location.origin+i.get("url"),source_title:i.get("title")+" - "+Cargo.Model.Site.GetWebsiteTitle(),tags:""===i.get("tags")?[]:i.get("tags").split(", "),excerpt:i.get("excerpt")};e.dataTransfer.setData("cargo/imageselection",JSON.stringify(o))}}}}},requestTemplate:function(e,t){this.listenTo(Cargo.Event,"template_loaded",this.checkTemplate),this.listenTo(Cargo.Event,"content_load_complete",this.setActiveThumb);var i=e||this.model.get("name"),n=t||this.model.getTemplatePath();if(this.templates[i]=Cargo.Template.Get(i,n),this.templates.Thumbnail=Cargo.Template.Get("Thumbnail"),_.contains(this.templates,void 0))return this;this.stopListening(Cargo.Event,"template_loaded");var o=this.model.get("data").mobile_data;return o&&o.separate_mobile_view&&this.model.get("data").responsive&&Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth)?this.setupMobile():this.setup(),this},checkTemplate:function(e){if(!(e in this.templates))return this;if(this.templates[e]=Cargo.Template.Get(e),_.contains(this.templates,void 0))return this;this.stopListening(Cargo.Event,"template_loaded");var t=this.model.get("data").mobile_data;return t&&t.separate_mobile_view&&this.model.get("data").responsive&&Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth)?this.setupMobile():this.setup(),this},setup:function(){this.addEventListeners();var e=Cargo.Collection.ThumbnailModes.findWhere({mode_id:this.model.get("mode_id")});return e?(require(["/_jsapps/thumbnails/"+e.get("path")+"/main.js"],_.bind(this.setupSubView,this)),this):this},setupMobile:function(){if(this.addEventListeners(),this.MobileSubview)this.render(this.MobileSubview);else{if(require.defined("!text")||Backdrop.Data.require_loaded){var e=this.model.get("data").mobile_data;return require(["text!/_jsapps/thumbnails/"+e.mobile_design_path+"/defaults.json","/_jsapps/thumbnails/"+e.mobile_design_path+"/main.js"],_.bind(this.setupMobileSubView,this)),this}_.delay(_.bind(this.setupMobile,this),100)}},activateMobile:function(){this.model.set("mobile_active",!0,{changing:"mobile_active"});var e=this.model.get("data").mobile_data;if(e&&e.separate_mobile_view&&e.mobile_design_path&&this.model.get("data").responsive){var t=e.mobile_design_path,i=this.model.getTemplatePath(t);this.templates&&this.templates[t.toCamel(!0)]?this.setupMobile():this.requestTemplate(t.toCamel(!0),i)}else e&&(this.templates&&this.templates[this.model.get("name")]||this.requestTemplate());return this},activateNormal:function(){if(this.model.set("mobile_active",!1,{changing:"mobile_active"}),!this.MobileSubview||!this.templates[this.model.get("name")])return this.templates&&this.templates[this.model.get("name")]?this:(this.requestTemplate(),this);this.setup()},addEventListeners:function(){return this.stopListening(Cargo.Event,"inline-editor-destroy-complete"),this.stopListening(this.model,"change"),!1!==this.PageModel&&this.stopListening(this.PageModel,"change"),this.stopListening(this.collection,"sync"),this.listenTo(this.collection,"sync",this.checkCollectionLengthAndSize),this.listenTo(Cargo.Event,"inline-editor-destroy-complete",function(){this.checkAndLoadThumbnails(Cargo.Helper.GetCurrentProjectId())},this),this.listenTo(this.model,"change",this.handleUpdates),!1!==this.PageModel&&this.listenTo(this.PageModel,"change",this.handleUpdates),this},setResponsive:function(){this.model.get("mobile_active")&&this.model.get("data").responsive?this.el.setAttribute("responsive-layout",""):this.el.removeAttribute("responsive-layout")},checkCollectionLengthAndSize:function(e,t,i){var n=!1;i&&i.params&&void 0!==i.params.page_id&&i.params.page_id!==this.currentPageID&&(n=!0),i=i||{},this.collection.length>0?(i&&i.from_thumbnail_reseed&&!1===this.show_thumbs||n||this.showThumbs(),this.checkSizeAndActivateView(Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth)),this.checkPagination(),_.defer(function(){Cargo.Plugins.elementResizer.refresh()})):n||this.hideThumbs()},checkSizeAndActivateView:function(e,t){e&&this.model.get("data").responsive?this.model.get("mobile_active")&&this.MobileSubview.inited||this.activateMobile():!this.model.get("mobile_active")&&this.Subview.inited||this.activateNormal()},hideThumbs:function(){return this.Subview&&"function"==typeof this.Subview.hideThumbs&&this.Subview.hideThumbs(),this.show_thumbs=!1,this.el.style.display="none",Cargo.Event.trigger("thumbnails_hide"),this},showThumbs:function(){return this.Subview&&"function"==typeof this.Subview.showThumbs&&this.Subview.showThumbs(),this.show_thumbs=!0,this.el.style.display="",Cargo.Event.trigger("thumbnails_show"),this},setActiveThumb:function(e){var t=this.el.querySelector(".thumbnail.active"),i=this.el.querySelector('[data-id="'+e+'"].thumbnail');t&&t.getAttribute("data-id")!=e&&$(t).removeClass("active"),$(i).addClass("active")},handleUpdates:function(e,t){var i;if("page"===e.type){if(this.PageModel&&this.PageModel!==e)return;i=_.clone(e.getPageOption("thumbnail_options")),this.PageModel=e,this.ContentModel=e}else i=_.clone(this.model.get("data"));if(i){switch("filter_type"==t.changing&&"page"===e.type&&("tag"==t.value?setTimeout($.proxy(function(){e.setThumbnailOption("filter_tags",i.filter_tags)},this),100):"set"==t.value&&setTimeout($.proxy(function(){e.setThumbnailOption("filter_set",i.filter_set)},this),100)),t.changing){case"thumb_meta":this.setup();break;case"show_thumbs":case"show_local_thumbs":!0===t.value?this.checkAndLoadThumbnails(void 0,i):this.hideThumbs();break;case"thumbnail_mode":this.requestTemplate();break;case"mobile_active":case"responsive":this.setResponsive(),this.checkSizeAndActivateView(Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth));break;case"filter_set":case"filter_tags":case"filter_type":case"random_limit":this.checkAndLoadThumbnails(void 0,i);break;default:this.ContentModel&&this.PageModel&&this.checkAndLoadThumbnails(this.PageModel.get("id"),this.PageModel.getPageOption("thumbnail_options"))}if(this.MobileSubview&&this.model.get("mobile_active")&&t&&this.model.get("data").responsive&&(t.mobile?i.mobile_data[t.mobile]=t.value:t.changing&&(i[t.changing]=t.value),i.show_thumbs||i.show_local_thumbs&&!i.show_thumbs)){var n=this.MobileSubview.model.get("data"),o=_.extend(n,i);this.MobileSubview.model.set("data",o,{silent:!0,changing:t.changing,value:t.value}),this.MobileSubview.handleUpdates(null,{changing:t.changing,value:t.value})}return this}},setupSubView:function(e){return this.Subview&&this.Subview.remove(),this.Subview=new e({model:this.model,collection:this.collection,parentView:this}),this.render(this.Subview),this.Subview.inited=!0,this},setupMobileSubView:function(e,t){this.MobileSubview&&this.MobileSubview.remove();var i=JSON.parse(e);_.extend(i,this.model.get("data"));var n=Cargo.Collection.ThumbnailModes.findWhere({path:i.mobile_data.mobile_design_path}),o=new Cargo.o.model.thumbnailsettings;return o.set({page_id:this.model.get("page_id"),site_id:this.model.get("site_id"),mobile_active:this.model.get("mobile_active"),mode_id:n.get("mode_id"),name:n.get("name"),path:n.get("path"),data:i}),this.MobileSubview=new t({model:o,collection:this.collection,parentView:this}),this.render(this.MobileSubview),this.MobileSubview.inited=!0,this},render:function(e){if(!this.canRender())return this;e||(e=this.Subview),this.setResponsive(),Handlebars.registerPartial("thumbnail_subview","");var t=Cargo.Template.Get("Thumbnail"),i=Cargo.Core.Handlebars.Render(t,{});this.$el.html(i);var n=this.$el.find(".thumbnails");return n.empty(),n.replaceWith(e.$el),e.render(),this.el._thumb_pagination_watcher||(Cargo.Event.on("thumbnail_pagination_complete",function(e,t,i){scrollMonitor.update(),this.checkPagination()},this),this.el._thumb_pagination_watcher=scrollMonitor.create(this.el,{bottom:2*-screen.height}),this.el._thumb_pagination_watcher.partiallyExitViewport(_.bind(function(){setTimeout(_.bind(this.checkPagination,this))},this)),this.checkPagination()),this},checkPagination:function(){!0===this.show_thumbs&&this.el._thumb_pagination_watcher&&!this.el._thumb_pagination_watcher.isBelowViewport&&this.collection.paginate()},canRender:function(){return!(_.contains(this.templates,void 0)||!Cargo.Collection.ThumbnailModes.length)},checkAndLoadThumbnails:function(e,t){var i,n,o=Cargo.Helper.GetPageViewById(e),a=this.ContentModel;if(this.ContentModel=Cargo.Collection.Scaffolding.getModel({id:e}),this.PageModel=!!o&&o.model,this.currentPageID=e,!Cargo.API.Config.direct_link_pid||!this.ContentModel||this.ContentModel!==a){if(!this.ContentModel)if($("script[data-set='FirstloadThumbOptions']").html()&&(n=$.parseJSON($("script[data-set='FirstloadThumbOptions']").html())),n)0===n.length&&(n=void 0);else{var r=Cargo.Collection.Tags.findTagByUrl(e);if(r)n={tags:r.get("url")};else if(_.isUndefined(t)&&!this.model.get("data").show_thumbs)return}if($("script[data-set='FirstloadThumbOptions']").remove(),!this.ContentModel&&_.isUndefined(t)&&(!n||_.size(n)<=1)&&!this.model.get("data").show_thumbs)return this.hideThumbs(),void this.addEventListeners();this.ContentModel&&("set"==this.ContentModel.type?(i=this.ContentModel.get("thumbnail_options"),n=void 0):void 0!==this.ContentModel.type&&!0!==this.ContentModel.get("pin")&&!(i=this.ContentModel.getPageOption("thumbnail_options"))&&n&&(n.use_global_thumb_settings=!0));var s=_.clone(n||(t||i));this.loadThumbnailsFor(e,s),this.addEventListeners()}},loadThumbnailsFor:function(e,t){var i;if(t)i=t.use_global_thumb_settings?_.clone(this.model.get("data")):t;else if((i=_.clone(this.model.get("data"))).show_thumbs){var n,o=Cargo.Collection.Scaffolding.getModel({id:e});if(o&&0!==o.get("id"))(n=Cargo.Collection.Tags.findTagByUrl(o.get("project_url")))?(console.log("thumb index: tag/set url collision"),o&&o.get("is_set")?o.get("stack")||(i.set_id=o.get("id")):"bdif"!==Cargo.API.Config.cargo_url&&(i.show_thumbs=!1)):o&&o.get("is_set")&&!o.get("stack")&&(i.set_id=o.get("id"));else(n=Cargo.Collection.Tags.findTagByUrl(e))&&(i.tags=n.get("url"))}if(void 0!==i.show_local_thumbs&&(i.show_thumbs=i.show_local_thumbs),!1===i.show_thumbs)this.hideThumbs();else{var a=this.collection.fetch({params:this.getCollectionSettingsForOptions(e,i),reset:!0,success:_.bind(function(e,t){this.checkCollectionLengthAndSize.apply(this,arguments)},this)});a&&a.readyState!==XMLHttpRequest.DONE&&(this.el.style.visibility="hidden",Cargo.View.PinnedBottom.el.style.visibility="hidden",a.always(_.bind(function(){this.el.style.visibility="",Cargo.View.PinnedBottom.el.style.visibility=""},this)))}},getCollectionSettingsForOptions:function(e,t){var i={tags:void 0,page_id:void 0,set_id:void 0,random_limit:void 0,force_all:void 0};return t&&(t.tags||t.set_id?(i.tags=t.tags,i.set_id=t.set_id):"set"==t.filter_type?i.set_id=t.filter_set:"tag"==t.filter_type?i.tags=t.filter_tags:"random"==t.filter_type?(i.page_id=e,i.random_limit=parseInt(t.random_limit),isNaN(i.random_limit)&&(i.random_limit=10)):"all"==t.filter_type?(i.page_id=e,i.force_all=!0):i.page_id=e),i},updateIsEditing:function(e){this.isEditing=e==this.model.get("name"),this.trigger("is_editing",this.isEditing)},getIsEditing:function(){return this.isEditing},getActiveSubView:function(){return this.model.get("mobile_active")&&this.MobileSubview&&this.model.get("data").responsive?this.MobileSubview:this.Subview},updateThumbnailCrop:function(e,t,i){var n=this.collection.findWhere({id:e});if(n){if(n.set("thumb_meta",{thumbnail_crop:t},{silent:!0}),i)return void this.handleUpdates(n,{changing:"thumb_meta"});if(i)return;var o=this.el.querySelector('[data-id="'+e+'"].thumbnail img');o&&("function"==typeof t.imageModel.get?(o.setAttribute("width",t.imageModel.get("width")),o.setAttribute("height",t.imageModel.get("height"))):(o.setAttribute("width",t.imageModel.width),o.setAttribute("height",t.imageModel.height)),i?Cargo.Plugins.elementResizer.refresh():(o.style.width=t.percentWidth+"%",o.style.marginLeft=t.marginLeft+"%",o.style.marginTop=t.marginTop+"%",Cargo.Plugins.elementResizer.update()))}}}),Cargo.o.view.TemplateButton=Backbone.View.extend({data:{creating:!1},el:"body",events:{"click .new_site_button":"confirmCreate","mouseover .new_site_button":"showFull","mouseout .new_site_button":"hideFull"},enabled:null,is_inframe:!1,initialize:function(e){Cargo.API.Config.is_template&&(parent==window?this.render():($("body").addClass("template_site_inframe"),this.is_inframe=!0)),window.addEventListener("message",this.onPostMessage,!1)},render:function(e){var t=this,i=Cargo.Core.Handlebars.Render('<div class="new_site_button_wrapper"><div class="new_site_button"><div class="text">Make a site with this Template</div><div class="plus"><svg id="plus_makesite" x="0px" y="0px" viewBox="0 0 44 44" style="enable-background:new 0 0 44 44;"><defs><mask id="specialMask"><rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect><g id="specialOrderText" fill="#000000"><line class="cls-3" x1="10" x2="34" y1="22" y2="22"/><line class="cls-3" y1="10" y2="34" x1="22" x2="22"/></g></mask></defs><g class="masked" style="mask: url(\'#specialMask\');"><g id="transform-rect"><rect id="rect" x="0" y="0" width="44" height="44" style="fill: #05f;"></rect></g></g></svg></div></div></div>');return $("body").append(i).addClass("template_site"),this.data.currentID=Cargo.Model.Site.get("id"),this.delegateEvents(),$.get("/_jsapps/modal/modal.html",function(e){t.createsitemodal=new modal,t.createsitemodal.template=_.template(e)}),this},onPostMessage:function(e){e.data&&e.data.redirect_url&&(window.onbeforeunload=null,document.location.href=e.data.redirect_url),e.data&&e.data.tab_index&&this.is_inframe&&("off"===e.data.tab_index?setTimeout(function(){$("*").not('[tabindex="-1"]').addClass("tabindex-off").attr("tabindex","-1")},100):"clear"===e.data.tab_index&&$(".tabindex-off").attr("tabindex","").removeAttr("tabindex").removeClass("tabindex-off"))},remove:function(){window.removeEventListener("message",this.onPostMessage)},confirmCreate:function(e){var t=this;t.createsitemodal.Confirm({message:"Make a site with this Template?",confirm:function(){t.start(e)}}),t.$el.addClass("createsitemodal")},start:function(e){e.preventDefault(),require(["/_jsapps/admin/_models/adminsite.js"],_.bind(function(e){this.data.AdminSite=new e,this.data.AdminSite.set("template_id",this.data.currentID),this.data.AdminSite.save({},{success:_.bind(function(e,t,i){if(0!=t.length){Cargo.Modal.Block({message:""});var n="https://auth.cargo.site/newsitesignup/"+e.get("sites_uid")+"/"+e.get("master_muid")+"/"+e.get("progress_id")+"?template_id="+this.data.currentID;Cargo.Modal.$el.addClass("signup"),Cargo.Modal.$el.find(".confirm-box").html('<iframe src="'+n+'"></iframe>'),Cargo.Modal.$el.find("iframe").css({width:"100%",height:"calc(100% + 1px)",border:"none"}),document.body.style.overflow="hidden"}},this),error:_.bind(function(e,t,i){var n=$.parseJSON(t.responseText);0!=n.length&&alert(n.message)},this)})},this))},requestStartProgress:function(){this.requests++,$.ajax({method:"POST",dataType:"json",url:"/dispatch/siteservices/checkSiteCopyStatus",data:{new_site_uid:this.data.AdminSite.get("sites_uid"),template_site_uid:this.data.AdminSite.get("template_id"),progress_id:this.data.AdminSite.get("progress_id")},success:_.bind(function(e){if(!(e.error&&e.error.length>0)){var t=this.requests>100?1500:500*Math.random()+250;clearTimeout(this.data.requestTimeout),this.data.requestTimeout=setTimeout(_.bind(this.requestStartProgress,this),t),e&&e.jdata&&console.log(e.jdata)}},this),error:_.bind(function(){var e=this.requests>100?1500:500*Math.random()+250;clearTimeout(this.data.requestTimeout),this.data.requestTimeout=setTimeout(_.bind(this.requestStartProgress,this),e)},this)})},displayCompletionStatus:function(e){var t=e.percent;t<10&&(t=Math.min(.1*this.requests,10)),this.createsitemodal.UpdateProgress(Math.round(t)),t>=100&&(clearTimeout(this.data.requestTimeout),setTimeout(_.bind(function(){window.onbeforeunload=null,document.location.href=this.data.redirect_url},this),1e3))}}),Cargo.o.view.ProductWidget=Backbone.View.extend({defaults:{price:!0,button_text:"Add to Cart"},initialize:function(e){this.activeSKU=void 0,requirejs(["text!/_jsapps/ecommerce/_templates/productWidget.html"],_.bind(function(e){this.template=_.template(e),this.requestedRender&&(delete this.requestedRender,this.render())},this))},events:{"change [name='skus']":"changeSKU","click [data-add-cart]":"addToCart"},getOptions:function(){var e={};if(this.el.hasAttribute("data-options"))try{e=JSON.parse(this.el.getAttribute("data-options"))}catch(e){}return _.defaults(e,this.defaults)},updateOptions:function(e){if(e){var t=this.getOptions();t=_.extend(t,e);try{this.el.setAttribute("data-options",JSON.stringify(t))}catch(e){console.warn("unable to store widget settings",e)}return this.render(),t}},formatPriceForCurrency:function(e,t,i){var n;if(void 0!==i&&(e*=i),"string"!=typeof t)n=e/100+"";else{var o={AED:"Ø¯.Ø¥",AFN:"Ø‹",ALL:"L",AMD:"Ö",ANG:"Æ’",AOA:"Kz",ARS:"$",AUD:"$",AWG:"Æ’",AZN:"â‚¼",BAM:"KM",BBD:"$",BDT:"à§³",BGN:"Ð»Ð²",BHD:".Ø¯.Ø¨",BIF:"FBu",BMD:"$",BND:"$",BOB:"$b",BRL:"R$",BSD:"$",BTC:"à¸¿",BTN:"Nu.",BWP:"P",BYR:"p.",BZD:"BZ$",CAD:"$",CDF:"FC",CHF:"CHF",CLP:"$",CNY:"Â¥",COP:"$",CRC:"â‚¡",CUC:"$",CUP:"â‚±",CVE:"$",CZK:"KÄ",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"Ø¯Ø¬",EEK:"kr",EGP:"Â£",ERN:"Nfk",ETB:"Br",ETH:"Îž",EUR:"â‚¬",FJD:"$",FKP:"Â£",GBP:"Â£",GEL:"â‚¾",GGP:"Â£",GHC:"â‚µ",GHS:"GHâ‚µ",GIP:"Â£",GMD:"D",GNF:"FG",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"â‚ª",IMP:"Â£",INR:"â‚¹",IQD:"Ø¹.Ø¯",IRR:"ï·¼",ISK:"kr",JEP:"Â£",JMD:"J$",JOD:"JD",JPY:"Â¥",KES:"KSh",KGS:"Ð»Ð²",KHR:"áŸ›",KMF:"CF",KPW:"â‚©",KRW:"â‚©",KWD:"KD",KYD:"$",KZT:"Ð»Ð²",LAK:"â‚­",LBP:"Â£",LKR:"â‚¨",LRD:"$",LSL:"M",LTC:"Å",LTL:"Lt",LVL:"Ls",LYD:"LD",MAD:"MAD",MDL:"lei",MGA:"Ar",MKD:"Ð´ÐµÐ½",MMK:"K",MNT:"â‚®",MOP:"MOP$",MRO:"UM",MUR:"â‚¨",MVR:"Rf",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"â‚¦",NIO:"C$",NOK:"kr",NPR:"â‚¨",NZD:"$",OMR:"ï·¼",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"â‚±",PKR:"â‚¨",PLN:"zÅ‚",PYG:"Gs",QAR:"ï·¼",RMB:"ï¿¥",RON:"lei",RSD:"Ð”Ð¸Ð½.",RUB:"â‚½",RWF:"Râ‚£",SAR:"ï·¼",SBD:"$",SCR:"â‚¨",SDG:"Ø¬.Ø³.",SEK:"kr",SGD:"$",SHP:"Â£",SLL:"Le",SOS:"S",SRD:"$",SSP:"Â£",STD:"Db",SVC:"$",SYP:"Â£",SZL:"E",THB:"à¸¿",TJS:"SM",TMT:"T",TND:"Ø¯.Øª",TOP:"T$",TRL:"â‚¤",TRY:"â‚º",TTD:"TT$",TVD:"$",TWD:"NT$",TZS:"TSh",UAH:"â‚´",UGX:"USh",USD:"$",UYU:"$U",UZS:"Ð»Ð²",VEF:"Bs",VND:"â‚«",VUV:"VT",WST:"WS$",XAF:"FCFA",XBT:"Éƒ",XCD:"$",XOF:"CFA",XPF:"â‚£",YER:"ï·¼",ZAR:"R",ZWD:"Z$"};t=t.toUpperCase(),-1===["BIF","CLP","DJF","GNF","JPY","KMF","KRW","MGA","PYG","RWF","VND","VUV","XAF","XOF","XPF"].indexOf(t)&&(e/=100),n="undefined"!=typeof Intl?new Intl.NumberFormat(Cargo.__ecommerce_locale__||"en-US",{style:"currency",currency:t,currencyDisplay:"symbol",useGrouping:!0,minimumFractionDigits:0}).format(e):(o.hasOwnProperty(t)?o[t]:t+" ")+""+e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}if("string"==typeof n&&-1!==n.indexOf(".")){var a=n.split(".");2===a.length&&1===a[1].length&&(a[1]=a[1]+"0",n=a.join("."))}return n},render:function(){if(this.template){var e;void 0!==this.model&&((e=this.model.toJSON()).skus.data.sort(function(e,t){var i=_.reduce(e.attributes,function(e,t){return e+t},""),n=_.reduce(t.attributes,function(e,t){return e+t},"");return i<n?-1:i>n?1:0}),!this.activeSKU&&e.skus.data.length>0&&(this.activeSKU=e.skus.data[0]));var t=this.template({formatPriceForCurrency:this.formatPriceForCurrency,options:this.getOptions(),product:e,activeSKU:this.activeSKU,has_inventory:this.checkIfInventoryAvailable()});return this.el.innerHTML=t,this.el.setAttribute("contenteditable",!1),this}this.requestedRender=!0},changeSKU:function(e){var t=e.target[e.target.selectedIndex].value,i=_.findWhere(this.model.get("skus").data,{id:t});i&&(this.activeSKU=i,this.render())},checkIfInventoryAvailable:function(){if(this.activeSKU){if("finite"===this.activeSKU.inventory.type&&this.activeSKU.inventory.quantity>0)return!0;if("infinite"===this.activeSKU.inventory.type)return!0;if("bucket"===this.activeSKU.inventory.type&&("in_stock"===this.activeSKU.inventory.value||"limited"===this.activeSKU.inventory.value))return!0}return!1},addToCart:function(e){this.model&&!Cargo.Helper.IsAdminEdit()&&(e.preventDefault(),Cargo.View.Following.triggerEventInFrame("add-sku-to-cart",{sku:this.activeSKU.id,product:this.model.get("id")}))}}),window.Vimeo={},_.defer(function(){define("jquery",[],function(){return jQuery})}),function(){jQuery.noConflict=function(){return console.warn("Detected a call to jQuery.noConflict. Preventing this from happening so we don't brick user sites."),jQuery};var e=function(e){return!(!e||"string"!=typeof e||-1===e.indexOf("googletagmanager.com/gtm.js"))};(function(){var e=/\/adminedit/.test(document.location.pathname)||/\/admin/.test(document.location.pathname);try{var t=parent!=window&&"object"==typeof parent.Cargo,i=null!=Cargo.Editor;return e||t||i}catch(e){return!1}})()&&(document.createElement=function(){if("script"!==arguments[0].toLowerCase())return document.__proto__.createElement.apply(document,arguments);var t=document.__proto__.createElement.apply(document,arguments),i=t.setAttribute.bind(t);return Object.defineProperty(t,"src",{get:function(){return t.getAttribute("src")},set:function(t){return e(t)&&i("type","javascript/blocked"),i("src",t),!0}}),Object.defineProperty(t,"type",{set:function(n){return i("type",e(t.src)?"javascript/blocked":n),!0}}),t.setAttribute=function(e,i){"type"===e||"src"===e?t[e]=i:HTMLScriptElement.prototype.setAttribute.apply(t,arguments)},t})}(),$(function(){requirejs.onError=function(e){console.error(e)},requirejs.config({paths:{text:"//static.cargo.site/libs/require/text.2.0.16.min",css:"//static.cargo.site/libs/require/css.min"}}),document.body.style.visibility="";var e=Backbone.View.prototype.remove;Backbone.View.prototype.remove=function(){this.trigger("remove"),e.apply(this,arguments)},Cargo.API=new Cargo.o.api,Cargo.Helper=new Cargo.o.helpers,Cargo.Template=new Cargo.o.templates,Cargo.Router=new Cargo.o.router,Cargo.Model.DisplayOptions=new Cargo.o.model.display_options,Cargo.Model.Site=new Cargo.o.model.site,Cargo.Model.Image=new Cargo.o.model.image,Cargo.Model.Css=new Cargo.o.model.css,Cargo.Model.Tag=new Cargo.o.model.tag,Cargo.Model.ThumbnailSettings=new Cargo.o.model.thumbnailsettings,Cargo.Collection.Images=new Cargo.o.collection.images,Cargo.Collection.Scaffolding=new Cargo.o.collection.scaffolding,Cargo.Collection.SiteMenu=new Cargo.o.collection.sitemenu,Cargo.Collection.StripeProducts=new Cargo.o.collection.StripeProductCollection,Cargo.Collection.ThumbnailSettings=new Cargo.o.collection.thumbnailsettings,Cargo.Collection.ThumbnailModes=new Cargo.o.collection.thumbnailmodes,Cargo.Collection.GlobalThumbnails=new Cargo.o.collection.thumbnails,Cargo.Collection.Tags=new Cargo.o.collection.tags,Cargo.Model.DisplayOptions.once("change",function(){Cargo.Event.trigger("display_options_available",Cargo.Model.DisplayOptions)}),Cargo.Model.DisplayOptions.fetch({reset:!0}),Cargo.Analytics=new Cargo.o.analytics,Cargo.Model.Site.fetch(),Cargo.Model.ThumbnailSettings.fetch(),Cargo.Collection.Scaffolding.fetch(),Cargo.Collection.ThumbnailSettings.fetch(),Cargo.Collection.ThumbnailModes.fetch(),!0===Cargo.Model.Site.get("has_ecommerce")?Cargo.Collection.StripeProducts.fetch({success:function(e){Cargo.Collection.StripeProducts.productSyncOccurred=!0},error:function(){Cargo.Collection.StripeProducts.productSyncOccurred=!0}}):Cargo.Collection.StripeProducts.productSyncOccurred=!0,Cargo.Helper.TestUrlCaseAndRedirect(),Cargo.Helper.IsAdminPath()||(Cargo.Backdrop=Cargo.View.Backdrop=Backdrop.View.Backdrop=new Cargo.o.view.Backdrop),Cargo.Helper.IsAdminPath()&&(Cargo.Collection.ImageLibrary=new Cargo.o.collection.images,Cargo.Collection.ImageLibrary.fetch()),Cargo.View.Following=new Cargo.o.view.Following,Cargo.View.FollowingButton=new Cargo.o.view.FollowingButton,Cargo.View.TemplateButton=new Cargo.o.view.TemplateButton,void 0===Cargo.View.Main&&(Cargo.View.Main=new Cargo.o.view.Main({el:"body",collection:Cargo.Model.Site})),Cargo.Template.FindAndAddViewStubs(),Cargo.Template.LoadFoundViews(),Cargo.Helper.isOldIE()||Cargo.Helper.IsAdminPath()||(Cargo.Router.is_first_route=!0,Backbone.history.start({pushState:!0,hashChange:!1,root:Cargo.Helper.GetHomeUrl(!0)})),Cargo.Core.KeyboardShortcut.InitDefaults(),Cargo.Template.LoadAll(),Cargo.Template.LoadFoundViews(),Cargo.Core.ImageGallery.initialize(),Cargo.Core.Ecommerce.initialize(),Cargo.Core.InitKeycodeListener(),Cargo.Core.InitMessageListener(),"undefined"!=typeof scrollMonitor&&(Cargo.Helper.throttledScrollMonitorUpdate=_.throttle(scrollMonitor.update,50)),Cargo.Event.trigger("init_complete")}),function(e){"use strict";!function(e){var t=window.Slick||{};(t=function(){var t=0;return function(i,n){var o,a=this;a.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:e(i),appendDots:e(i),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(t,i){return e('<button type="button" data-role="none" role="button" tabindex="0" />').text(i+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,preventDefaults:!0,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},a.initials={animating:!1,dragging:!1,autoPlayTimer:null,hideUITimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},e.extend(a,a.initials),a.activeBreakpoint=null,a.animType=null,a.animProp=null,a.breakpoints=[],a.breakpointSettings=[],a.cssTransitions=!1,a.focussed=!1,a.interrupted=!1,a.hidden="hidden",a.paused=!0,a.positionProp=null,a.respondTo=null,a.rowCount=1,a.shouldClick=!0,a.$slider=e(i),a.$slidesCache=null,a.transformType=null,a.transitionType=null,a.visibilityChange="visibilitychange",a.windowWidth=0,a.windowTimer=null,o=e(i).data("slick")||{},a.options=e.extend({},a.defaults,n,o),a.currentSlide=a.options.initialSlide,a.originalSettings=a.options,void 0!==document.mozHidden?(a.hidden="mozHidden",a.visibilityChange="mozvisibilitychange"):void 0!==document.webkitHidden&&(a.hidden="webkitHidden",a.visibilityChange="webkitvisibilitychange");a.autoPlay=e.proxy(a.autoPlay,a),a.autoPlayClear=e.proxy(a.autoPlayClear,a),a.autoPlayIterator=e.proxy(a.autoPlayIterator,a),a.changeSlide=e.proxy(a.changeSlide,a),a.clickHandler=e.proxy(a.clickHandler,a),a.selectHandler=e.proxy(a.selectHandler,a),a.setPosition=e.proxy(a.setPosition,a),a.swipeHandler=e.proxy(a.swipeHandler,a),a.dragHandler=e.proxy(a.dragHandler,a),a.keyHandler=e.proxy(a.keyHandler,a),a.hideUI=e.proxy(a.hideUI,a),a.showUI=e.proxy(a.showUI,a),a.preventDefault=e.proxy(a.preventDefault,a),a.instanceUid=t++,a.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,a.registerBreakpoints(),a.init(!0)}}()).prototype.activateADA=function(){this.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},t.prototype.addSlide=t.prototype.slickAdd=function(t,i,n){var o=this;if("boolean"==typeof i)n=i,i=null;else if(i<0||i>=o.slideCount)return!1;o.unload(),"number"==typeof i?0===i&&0===o.$slides.length?e(t).appendTo(o.$slideTrack):n?e(t).insertBefore(o.$slides.eq(i)):e(t).insertAfter(o.$slides.eq(i)):!0===n?e(t).prependTo(o.$slideTrack):e(t).appendTo(o.$slideTrack),o.$slides=o.$slideTrack.children(this.options.slide),o.$slideTrack.children(this.options.slide).detach(),o.$slideTrack.append(o.$slides),o.$slides.each(function(t,i){e(i).attr("data-slick-index",t)}),o.$slidesCache=o.$slides,o.reinit()},t.prototype.animateHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);if(e.$list.animate({height:t},e.options.speed),!0===e.options.arrows){var i=e.$slides.eq(e.currentSlide),n=i.is(".has_caption")?t-i.find(".gallery_image_caption").outerHeight(!0):t;e.$prevArrow.animate({height:n},{duration:e.options.speed}).css("overflow","visible"),e.$nextArrow.animate({height:n},{duration:e.options.speed}).css("overflow","visible")}}},t.prototype.animateSlide=function(t,i){var n={},o=this;o.animateHeight(),!0===o.options.rtl&&!1===o.options.vertical&&(t=-t),!1===o.transformsEnabled?!1===o.options.vertical?o.$slideTrack.animate({left:t},o.options.speed,o.options.easing,i):o.$slideTrack.animate({top:t},o.options.speed,o.options.easing,i):!1===o.cssTransitions?(!0===o.options.rtl&&(o.currentLeft=-o.currentLeft),e({animStart:o.currentLeft}).animate({animStart:t},{duration:o.options.speed,easing:o.options.easing,step:function(e){e=Math.ceil(e),!1===o.options.vertical?(n[o.animType]="translate("+e+"px, 0px)",o.$slideTrack.css(n)):(n[o.animType]="translate(0px,"+e+"px)",o.$slideTrack.css(n))},complete:function(){i&&i.call()}})):(o.applyTransition(),t=Math.ceil(t),!1===o.options.vertical?n[o.animType]="translate3d("+t+"px, 0px, 0px)":n[o.animType]="translate3d(0px,"+t+"px, 0px)",o.$slideTrack.css(n),i&&setTimeout(function(){o.disableTransition(),i.call()},o.options.speed))},t.prototype.getNavTarget=function(){var t=this.options.asNavFor;return t&&null!==t&&(t=e(t).not(this.$slider)),t},t.prototype.asNavFor=function(t){var i=this.getNavTarget();null!==i&&"object"==typeof i&&i.each(function(){var i=e(this).slick("getSlick");i.unslicked||i.slideHandler(t,!0)})},t.prototype.applyTransition=function(e){var t=this,i={};!1===t.options.fade?i[t.transitionType]=t.transformType+" "+t.options.speed+"ms "+t.options.cssEase:i[t.transitionType]="opacity "+t.options.speed+"ms "+t.options.cssEase,!1===t.options.fade?t.$slideTrack.css(i):t.$slides.eq(e).css(i)},t.prototype.autoPlay=function(){var e=this;e.autoPlayClear(),e.slideCount>e.options.slidesToShow&&(e.autoPlayTimer=setInterval(e.autoPlayIterator,e.options.autoplaySpeed))},t.prototype.autoPlayClear=function(){this.autoPlayTimer&&clearInterval(this.autoPlayTimer)},t.prototype.autoPlayIterator=function(){var e=this,t=e.currentSlide+e.options.slidesToScroll;e.paused||e.interrupted||e.focussed||(!1===e.options.infinite&&(1===e.direction&&e.currentSlide+1===e.slideCount-1?e.direction=0:0===e.direction&&(t=e.currentSlide-e.options.slidesToScroll,e.currentSlide-1==0&&(e.direction=1))),e.slideHandler(t))},t.prototype.buildArrows=function(){var t=this;!0===t.options.arrows&&(t.$prevArrow=e(t.options.prevArrow).addClass("slick-arrow"),t.$nextArrow=e(t.options.nextArrow).addClass("slick-arrow"),t.slideCount>t.options.slidesToShow?(t.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),t.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.prependTo(t.options.appendArrows),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.appendTo(t.options.appendArrows),!0!==t.options.infinite&&t.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):t.$prevArrow.add(t.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},t.prototype.buildDots=function(){var t,i,n=this;if(!0===n.options.dots&&n.slideCount>n.options.slidesToShow){for(n.$slider.addClass("slick-dotted"),i=e("<ul />").addClass(n.options.dotsClass),t=0;t<=n.getDotCount();t+=1)i.append(e("<li />").append(n.options.customPaging.call(this,n,t)));n.$dots=i.appendTo(n.options.appendDots),n.$dots.find("li").first().addClass("slick-active").attr("aria-hidden","false")}},t.prototype.buildOut=function(){var t=this;t.$slides=t.$slider.children(t.options.slide+":not(.slick-cloned)").addClass("slick-slide"),t.slideCount=t.$slides.length,t.$slides.each(function(t,i){e(i).attr("data-slick-index",t).data("originalStyling",e(i).attr("style")||"")}),t.$slider.addClass("slick-slider"),t.$slideTrack=0===t.slideCount?e('<div class="slick-track"/>').appendTo(t.$slider):t.$slides.wrapAll('<div class="slick-track"/>').parent(),t.$list=t.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent(),t.$slideTrack.css("opacity",0),!0!==t.options.centerMode&&!0!==t.options.swipeToSlide||(t.options.slidesToScroll=1),e("img[data-lazy]",t.$slider).not("[src]").addClass("slick-loading"),t.setupInfinite(),t.buildArrows(),t.buildDots(),t.updateDots(),t.setSlideClasses("number"==typeof t.currentSlide?t.currentSlide:0),!0===t.options.draggable&&t.$list.addClass("draggable")},t.prototype.buildRows=function(){var e,t,i,n,o,a,r,s=this;if(n=document.createDocumentFragment(),a=s.$slider.children(),s.options.rows>1){for(r=s.options.slidesPerRow*s.options.rows,o=Math.ceil(a.length/r),e=0;e<o;e++){var l=document.createElement("div");for(t=0;t<s.options.rows;t++){var d=document.createElement("div");for(i=0;i<s.options.slidesPerRow;i++){var c=e*r+(t*s.options.slidesPerRow+i);a.get(c)&&d.appendChild(a.get(c))}l.appendChild(d)}n.appendChild(l)}s.$slider.empty().append(n),s.$slider.children().children().children().css({width:100/s.options.slidesPerRow+"%",display:"inline-block"})}},t.prototype.checkResponsive=function(t,i){var n,o,a,r=this,s=!1,l=r.$slider.width(),d=window.innerWidth||e(window).width();if("window"===r.respondTo?a=d:"slider"===r.respondTo?a=l:"min"===r.respondTo&&(a=Math.min(d,l)),r.options.responsive&&r.options.responsive.length&&null!==r.options.responsive){for(n in o=null,r.breakpoints)r.breakpoints.hasOwnProperty(n)&&(!1===r.originalSettings.mobileFirst?a<r.breakpoints[n]&&(o=r.breakpoints[n]):a>r.breakpoints[n]&&(o=r.breakpoints[n]));null!==o?null!==r.activeBreakpoint?(o!==r.activeBreakpoint||i)&&(r.activeBreakpoint=o,"unslick"===r.breakpointSettings[o]?r.unslick(o):(r.options=e.extend({},r.originalSettings,r.breakpointSettings[o]),!0===t&&(r.currentSlide=r.options.initialSlide),r.refresh(t)),s=o):(r.activeBreakpoint=o,"unslick"===r.breakpointSettings[o]?r.unslick(o):(r.options=e.extend({},r.originalSettings,r.breakpointSettings[o]),!0===t&&(r.currentSlide=r.options.initialSlide),r.refresh(t)),s=o):null!==r.activeBreakpoint&&(r.activeBreakpoint=null,r.options=r.originalSettings,!0===t&&(r.currentSlide=r.options.initialSlide),r.refresh(t),s=o),t||!1===s||r.$slider.trigger("breakpoint",[r,s])}},t.prototype.changeSlide=function(t,i){var n,o,a,r=this,s=e(t.currentTarget);switch(s.is("a")&&t.preventDefault(),s.is("li")||(s=s.closest("li")),a=r.slideCount%r.options.slidesToScroll!=0,n=a?0:(r.slideCount-r.currentSlide)%r.options.slidesToScroll,t.data.message){case"previous":o=0===n?r.options.slidesToScroll:r.options.slidesToShow-n,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide-o,!1,i);break;case"next":o=0===n?r.options.slidesToScroll:n,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide+o,!1,i);break;case"index":var l=0===t.data.index?0:t.data.index||s.index()*r.options.slidesToScroll;r.slideHandler(r.checkNavigable(l),!1,i),s.children().trigger("focus");break;default:return}},t.prototype.checkNavigable=function(e){var t,i;if(t=this.getNavigableIndexes(),i=0,e>t[t.length-1])e=t[t.length-1];else for(var n in t){if(e<t[n]){e=i;break}i=t[n]}return e},t.prototype.cleanUpEvents=function(){var t=this;t.options.dots&&null!==t.$dots&&e("li",t.$dots).off("click.slick",t.changeSlide).off("mouseenter.slick",e.proxy(t.interrupt,t,!0)).off("mouseleave.slick",e.proxy(t.interrupt,t,!1)),t.$slider.off("focus.slick blur.slick"),!0===t.options.arrows&&t.slideCount>t.options.slidesToShow&&(t.$prevArrow&&t.$prevArrow.off("click.slick",t.changeSlide),t.$nextArrow&&t.$nextArrow.off("click.slick",t.changeSlide)),t.$slider.off("touchstart.slick mousedown.slick",t.swipeHandler),t.$slider.off("touchmove.slick mousemove.slick",t.swipeHandler),t.$slider.off("touchend.slick mouseup.slick",t.swipeHandler),t.$slider.off("touchcancel.slick mouseleave.slick",t.swipeHandler),t.$list.off("click.slick",t.clickHandler),e(document).off(t.visibilityChange,t.visibility),t.cleanUpSlideEvents(),!0===t.options.accessibility&&t.$list.off("keydown.slick",t.keyHandler),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().off("click.slick",t.selectHandler),e(window).off("orientationchange.slick.slick-"+t.instanceUid,t.orientationChange),e(window).off("resize.slick.slick-"+t.instanceUid,t.resize),e("[draggable!=true]",t.$slideTrack).off("dragstart",t.preventDefault),e(window).off("load.slick.slick-"+t.instanceUid,t.setPosition),e(document).off("ready.slick.slick-"+t.instanceUid,t.setPosition),Cargo.Event.off("slideshow-lazyload",t.lazyLoad),Cargo.Event.off("slideshow-lazyload",t.progressiveLazyLoad)},t.prototype.cleanUpSlideEvents=function(){var t=this;t.$list.off("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$list.off("mouseleave.slick",e.proxy(t.interrupt,t,!1))},t.prototype.cleanUpRows=function(){var e,t=this;t.options.rows>1&&((e=t.$slides.children().children()).removeAttr("style"),t.$slider.empty().append(e))},t.prototype.clickHandler=function(e){!1===this.shouldClick&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())},t.prototype.destroy=function(t){var i=this;i.autoPlayClear(),i.touchObject={},i.cleanUpEvents(),e(".slick-cloned",i.$slider).detach(),i.$dots&&i.$dots.remove(),i.$prevArrow&&i.$prevArrow.length&&(i.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),i.htmlExpr.test(i.options.prevArrow)&&i.$prevArrow.remove()),i.$nextArrow&&i.$nextArrow.length&&(i.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),i.htmlExpr.test(i.options.nextArrow)&&i.$nextArrow.remove()),i.$slides&&(i.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){e(this).attr("style",e(this).data("originalStyling"))}),i.$slideTrack.children(this.options.slide).detach(),i.$slideTrack.detach(),i.$list.detach(),i.$slider.append(i.$slides)),i.cleanUpRows(),i.$slider.removeClass("slick-slider"),i.$slider.removeClass("slick-initialized"),i.$slider.removeClass("slick-dotted"),i.unslicked=!0,t||i.$slider.trigger("destroy",[i])},t.prototype.disableTransition=function(e){var t=this,i={};i[t.transitionType]="",!1===t.options.fade?t.$slideTrack.css(i):t.$slides.eq(e).css(i)},t.prototype.fadeSlide=function(e,t){var i=this;!1===i.cssTransitions?(i.$slides.eq(e).css({zIndex:i.options.zIndex}),i.$slides.eq(e).animate({opacity:1},i.options.speed,i.options.easing,t)):(i.applyTransition(e),i.$slides.eq(e).css({opacity:1,zIndex:i.options.zIndex}),t&&setTimeout(function(){i.disableTransition(e),t.call()},i.options.speed))},t.prototype.fadeSlideOut=function(e){var t=this;!1===t.cssTransitions?t.$slides.eq(e).animate({opacity:0,zIndex:t.options.zIndex-2},t.options.speed,t.options.easing):(t.applyTransition(e),t.$slides.eq(e).css({opacity:0,zIndex:t.options.zIndex-2}))},t.prototype.filterSlides=t.prototype.slickFilter=function(e){var t=this;null!==e&&(t.$slidesCache=t.$slides,t.unload(),t.$slideTrack.children(this.options.slide).detach(),t.$slidesCache.filter(e).appendTo(t.$slideTrack),t.reinit())},t.prototype.focusHandler=function(){var t=this;t.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*:not(.slick-arrow)",function(i){i.stopImmediatePropagation();var n=e(this);setTimeout(function(){t.options.pauseOnFocus&&(t.focussed=n.is(":focus"),t.autoPlay())},0)})},t.prototype.getCurrent=t.prototype.slickCurrentSlide=function(){return this.currentSlide},t.prototype.getDotCount=function(){var e=this,t=0,i=0,n=0;if(!0===e.options.infinite)for(;t<e.slideCount;)++n,t=i+e.options.slidesToScroll,i+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else if(!0===e.options.centerMode)n=e.slideCount;else if(e.options.asNavFor)for(;t<e.slideCount;)++n,t=i+e.options.slidesToScroll,i+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else n=1+Math.ceil((e.slideCount-e.options.slidesToShow)/e.options.slidesToScroll);return n-1},t.prototype.getLeft=function(e){var t,i,n,o=this,a=0;return o.slideOffset=0,i=o.$slides.first().outerHeight(!0),!0===o.options.infinite?(o.slideCount>o.options.slidesToShow&&(o.slideOffset=o.slideWidth*o.options.slidesToShow*-1,a=i*o.options.slidesToShow*-1),o.slideCount%o.options.slidesToScroll!=0&&e+o.options.slidesToScroll>o.slideCount&&o.slideCount>o.options.slidesToShow&&(e>o.slideCount?(o.slideOffset=(o.options.slidesToShow-(e-o.slideCount))*o.slideWidth*-1,a=(o.options.slidesToShow-(e-o.slideCount))*i*-1):(o.slideOffset=o.slideCount%o.options.slidesToScroll*o.slideWidth*-1,a=o.slideCount%o.options.slidesToScroll*i*-1))):e+o.options.slidesToShow>o.slideCount&&(o.slideOffset=(e+o.options.slidesToShow-o.slideCount)*o.slideWidth,a=(e+o.options.slidesToShow-o.slideCount)*i),o.slideCount<=o.options.slidesToShow&&(o.slideOffset=0,a=0),!0===o.options.centerMode&&!0===o.options.infinite?o.slideOffset+=o.slideWidth*Math.floor(o.options.slidesToShow/2)-o.slideWidth:!0===o.options.centerMode&&(o.slideOffset=0,o.slideOffset+=o.slideWidth*Math.floor(o.options.slidesToShow/2)),t=!1===o.options.vertical?e*o.slideWidth*-1+o.slideOffset:e*i*-1+a,!0===o.options.variableWidth&&(n=o.slideCount<=o.options.slidesToShow||!1===o.options.infinite?o.$slideTrack.children(".slick-slide").eq(e):o.$slideTrack.children(".slick-slide").eq(e+o.options.slidesToShow),t=!0===o.options.rtl?n[0]?-1*(o.$slideTrack.width()-n[0].offsetLeft-n.width()):0:n[0]?-1*n[0].offsetLeft:0,!0===o.options.centerMode&&(n=o.slideCount<=o.options.slidesToShow||!1===o.options.infinite?o.$slideTrack.children(".slick-slide").eq(e):o.$slideTrack.children(".slick-slide").eq(e+o.options.slidesToShow+1),t=!0===o.options.rtl?n[0]?-1*(o.$slideTrack.width()-n[0].offsetLeft-n.width()):0:n[0]?-1*n[0].offsetLeft:0,t+=(o.$list.width()-n.outerWidth())/2)),t},t.prototype.getOption=t.prototype.slickGetOption=function(e){return this.options[e]},t.prototype.getNavigableIndexes=function(){var e,t=this,i=0,n=0,o=[];for(!1===t.options.infinite?e=t.slideCount:(i=-1*t.options.slidesToScroll,n=-1*t.options.slidesToScroll,e=2*t.slideCount);i<e;)o.push(i),i=n+t.options.slidesToScroll,n+=t.options.slidesToScroll<=t.options.slidesToShow?t.options.slidesToScroll:t.options.slidesToShow;return o},t.prototype.getSlick=function(){return this},t.prototype.getSlideCount=function(){var t,i,n=this;return i=!0===n.options.centerMode?n.slideWidth*Math.floor(n.options.slidesToShow/2):0,!0===n.options.swipeToSlide?(n.$slideTrack.find(".slick-slide").each(function(o,a){if(a.offsetLeft-i+e(a).outerWidth()/2>-1*n.swipeLeft)return t=a,!1}),Math.abs(e(t).attr("data-slick-index")-n.currentSlide)||1):n.options.slidesToScroll},t.prototype.goTo=t.prototype.slickGoTo=function(e,t){this.changeSlide({data:{message:"index",index:parseInt(e)}},t)},t.prototype.init=function(t){var i=this;e(i.$slider).hasClass("slick-initialized")||(e(i.$slider).addClass("slick-initialized"),i.buildRows(),i.buildOut(),i.setProps(),i.startLoad(),i.loadSlider(),i.initializeEvents(),i.updateArrows(),i.updateDots(),i.checkResponsive(!0),i.focusHandler()),t&&i.$slider.trigger("init",[i]),!0===i.options.accessibility&&i.initADA(),i.options.autoplay&&(i.paused=!1,i.autoPlay()),i.showUI(),this.hideUITimer=setTimeout(this.hideUI,1500)},t.prototype.initADA=function(){var t=this;t.$slides.add(t.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),t.$slideTrack.attr("role","listbox"),t.$slides.not(t.$slideTrack.find(".slick-cloned")).each(function(i){e(this).attr({role:"option","aria-describedby":"slick-slide"+t.instanceUid+i})}),null!==t.$dots&&t.$dots.attr("role","tablist").find("li").each(function(i){e(this).attr({role:"presentation","aria-selected":"false","aria-controls":"navigation"+t.instanceUid+i,id:"slick-slide"+t.instanceUid+i})}).first().attr("aria-selected","true").end().find("button").attr("role","button").end().closest("div").attr("role","toolbar"),t.activateADA()},t.prototype.initArrowEvents=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},e.changeSlide),e.$nextArrow.off("click.slick").on("click.slick",{message:"next"},e.changeSlide))},t.prototype.initDotEvents=function(){var t=this;!0===t.options.dots&&t.slideCount>t.options.slidesToShow&&e("li",t.$dots).on("click.slick",{message:"index"},t.changeSlide),!0===t.options.dots&&!0===t.options.pauseOnDotsHover&&e("li",t.$dots).on("mouseenter.slick",e.proxy(t.interrupt,t,!0)).on("mouseleave.slick",e.proxy(t.interrupt,t,!1))},t.prototype.initSlideEvents=function(){var t=this;t.options.pauseOnHover&&(t.$prevArrow&&(t.$prevArrow.on("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$prevArrow.on("mouseleave.slick",e.proxy(t.interrupt,t,!1))),t.$nextArrow&&(t.$nextArrow.on("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$nextArrow.on("mouseleave.slick",e.proxy(t.interrupt,t,!1))),t.$list.on("mouseenter.slick",e.proxy(t.interrupt,t,!0)),t.$list.on("mouseleave.slick",e.proxy(t.interrupt,t,!1)))},t.prototype.initializeEvents=function(){var t=this;t.initArrowEvents(),t.initDotEvents(),t.initSlideEvents(),t.$slider.on("touchstart.slick mousedown.slick",{action:"start"},t.swipeHandler),t.$slider.on("touchmove.slick mousemove.slick",{action:"move"},t.swipeHandler),t.$slider.on("touchend.slick mouseup.slick",{action:"end"},t.swipeHandler),t.$slider.on("touchcancel.slick mouseleave.slick",{action:"end"},t.swipeHandler),t.$list.on("click.slick",t.clickHandler),e(document).on(t.visibilityChange,e.proxy(t.visibility,t)),!0===t.options.accessibility&&t.$list.on("keydown.slick",t.keyHandler),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().on("click.slick",t.selectHandler),e(window).on("orientationchange.slick.slick-"+t.instanceUid,e.proxy(t.orientationChange,t)),e(window).on("resize.slick.slick-"+t.instanceUid,e.proxy(t.resize,t)),e("[draggable!=true]",t.$slideTrack).on("dragstart",t.preventDefault),e(window).on("load.slick.slick-"+t.instanceUid,t.setPosition),e(document).on("ready.slick.slick-"+t.instanceUid,t.setPosition)},t.prototype.initUI=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.show(),e.$nextArrow.show()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.show()},t.prototype.keyHandler=function(e){var t=this;e.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===e.keyCode&&!0===t.options.accessibility?t.changeSlide({data:{message:!0===t.options.rtl?"next":"previous"}}):39===e.keyCode&&!0===t.options.accessibility&&t.changeSlide({data:{message:!0===t.options.rtl?"previous":"next"}}))},t.prototype.lazyLoad=function(){var t,i,n=this;function o(t){e("img[data-lazy], img[data-lazy-src]",t).each(function(){var t=e(this),i=t.attr("data-lazy")||t.attr("data-lazy-src"),o=document.createElement("img");t.removeAttr("data-lazy"),t.removeAttr("data-lazy-src"),o.onload=function(){t.attr("src",i).removeClass("slick-loading"),n.$slider.trigger("lazyLoaded",[n,t,i])},o.onerror=function(){t.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),n.$slider.trigger("lazyLoadError",[n,t,i])},o.src=i})}!0===n.options.centerMode?!0===n.options.infinite?(t=n.currentSlide+(n.options.slidesToShow/2+1),i=t+n.options.slidesToShow+2):(t=Math.max(0,n.currentSlide-(n.options.slidesToShow/2+1)),i=n.options.slidesToShow/2+1+2+n.currentSlide):(t=n.options.infinite?n.options.slidesToShow+n.currentSlide:n.currentSlide,i=Math.ceil(t+n.options.slidesToShow),!0===n.options.fade&&(t>0&&t--,i<=n.slideCount&&i++)),i+=3,(t-=1)<0&&(t=0),o(n.$slider.find(".slick-slide").slice(t,i)),n.slideCount<=n.options.slidesToShow?o(n.$slider.find(".slick-slide")):n.currentSlide>=n.slideCount-n.options.slidesToShow?o(n.$slider.find(".slick-cloned").slice(0,n.options.slidesToShow)):0===n.currentSlide&&o(n.$slider.find(".slick-cloned").slice(-1*n.options.slidesToShow))},t.prototype.loadSlider=function(){var e=this;e.setPosition(),e.$slideTrack.css({opacity:1}),e.$slider.removeClass("slick-loading"),e.initUI(),"progressive"===e.options.lazyLoad&&e.progressiveLazyLoad()},t.prototype.next=t.prototype.slickNext=function(){this.changeSlide({data:{message:"next"}})},t.prototype.orientationChange=function(){this.checkResponsive(),this.setPosition()},t.prototype.pause=t.prototype.slickPause=function(){this.autoPlayClear(),this.paused=!0},t.prototype.play=t.prototype.slickPlay=function(){var e=this;e.autoPlay(),e.options.autoplay=!0,e.paused=!1,e.focussed=!1,e.interrupted=!1},t.prototype.postSlide=function(e){var t=this;t.unslicked||(t.$slider.trigger("afterChange",[t,e]),t.animating=!1,t.setPosition(),t.swipeLeft=null,t.options.autoplay&&t.autoPlay(),!0===t.options.accessibility&&t.initADA())},t.prototype.prev=t.prototype.slickPrev=function(){this.changeSlide({data:{message:"previous"}})},t.prototype.preventDefault=function(e){this.options.preventDefaults&&e.preventDefault()},t.prototype.progressiveLazyLoad=function(t){t=t||1;var i,n,o,a=this,r=e("img[data-lazy]",a.$slider);r.length?(i=r.first(),n=i.attr("data-lazy"),(o=document.createElement("img")).onload=function(){i.attr("src",n).removeAttr("data-lazy").removeClass("slick-loading"),!0===a.options.adaptiveHeight&&a.setPosition(),a.$slider.trigger("lazyLoaded",[a,i,n]),a.progressiveLazyLoad()},o.onerror=function(){t<3?setTimeout(function(){a.progressiveLazyLoad(t+1)},500):(i.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),a.$slider.trigger("lazyLoadError",[a,i,n]),a.progressiveLazyLoad())},o.src=n):a.$slider.trigger("allImagesLoaded",[a])},t.prototype.refresh=function(t){var i,n,o=this;n=o.slideCount-o.options.slidesToShow,!o.options.infinite&&o.currentSlide>n&&(o.currentSlide=n),o.slideCount<=o.options.slidesToShow&&(o.currentSlide=0),i=o.currentSlide,o.destroy(!0),e.extend(o,o.initials,{currentSlide:i}),o.init(),t||o.changeSlide({data:{message:"index",index:i}},!1)},t.prototype.registerBreakpoints=function(){var t,i,n,o=this,a=o.options.responsive||null;if("array"===e.type(a)&&a.length){for(t in o.respondTo=o.options.respondTo||"window",a)if(n=o.breakpoints.length-1,i=a[t].breakpoint,a.hasOwnProperty(t)){for(;n>=0;)o.breakpoints[n]&&o.breakpoints[n]===i&&o.breakpoints.splice(n,1),n--;o.breakpoints.push(i),o.breakpointSettings[i]=a[t].settings}o.breakpoints.sort(function(e,t){return o.options.mobileFirst?e-t:t-e})}},t.prototype.reinit=function(){var t=this;t.$slides=t.$slideTrack.children(t.options.slide).addClass("slick-slide"),t.slideCount=t.$slides.length,t.currentSlide>=t.slideCount&&0!==t.currentSlide&&(t.currentSlide=t.currentSlide-t.options.slidesToScroll),t.slideCount<=t.options.slidesToShow&&(t.currentSlide=0),t.registerBreakpoints(),t.setProps(),t.setupInfinite(),t.buildArrows(),t.updateArrows(),t.initArrowEvents(),t.buildDots(),t.updateDots(),t.initDotEvents(),t.cleanUpSlideEvents(),t.initSlideEvents(),t.checkResponsive(!1,!0),!0===t.options.focusOnSelect&&e(t.$slideTrack).children().on("click.slick",t.selectHandler),t.setSlideClasses("number"==typeof t.currentSlide?t.currentSlide:0),t.setPosition(),t.focusHandler(),t.paused=!t.options.autoplay,t.autoPlay(),t.options.arrows&&(t.showUI(),t.hideUITimer=setTimeout(t.hideUI,1500)),t.$slider.trigger("reInit",[t])},t.prototype.resize=function(){var t=this;e(window).width()!==t.windowWidth&&(clearTimeout(t.windowDelay),t.windowDelay=window.setTimeout(function(){t.windowWidth=e(window).width(),t.checkResponsive(),t.unslicked||t.setPosition()},50))},t.prototype.removeSlide=t.prototype.slickRemove=function(e,t,i){var n=this;if(e="boolean"==typeof e?!0===(t=e)?0:n.slideCount-1:!0===t?--e:e,n.slideCount<1||e<0||e>n.slideCount-1)return!1;n.unload(),!0===i?n.$slideTrack.children().remove():n.$slideTrack.children(this.options.slide).eq(e).remove(),n.$slides=n.$slideTrack.children(this.options.slide),n.$slideTrack.children(this.options.slide).detach(),n.$slideTrack.append(n.$slides),n.$slidesCache=n.$slides,n.reinit()},t.prototype.setCSS=function(e){var t,i,n=this,o={};!0===n.options.rtl&&(e=-e),t="left"==n.positionProp?Math.ceil(e)+"px":"0px",i="top"==n.positionProp?Math.ceil(e)+"px":"0px",o[n.positionProp]=e,!1===n.transformsEnabled?n.$slideTrack.css(o):(o={},!1===n.cssTransitions?(o[n.animType]="translate("+t+", "+i+")",n.$slideTrack.css(o)):(o[n.animType]="translate3d("+t+", "+i+", 0px)",n.$slideTrack.css(o)))},t.prototype.setDimensions=function(){var e=this;!1===e.options.vertical?!0===e.options.centerMode&&e.$list.css({padding:"0px "+e.options.centerPadding}):(e.$list.height(e.$slides.first().outerHeight(!0)*e.options.slidesToShow),!0===e.options.centerMode&&e.$list.css({padding:e.options.centerPadding+" 0px"}));var t=e.$list.get(0).getBoundingClientRect();e.listWidth=t.width,e.listHeight=t.height,!1===e.options.vertical&&!1===e.options.variableWidth?(e.slideWidth=Math.ceil(e.listWidth/e.options.slidesToShow),e.$slideTrack.width(Math.ceil(e.slideWidth*e.$slideTrack.children(".slick-slide").length))):!0===e.options.variableWidth?e.$slideTrack.width(5e3*e.slideCount):(e.slideWidth=Math.ceil(e.listWidth),e.$slideTrack.height(Math.ceil(e.$slides.first().outerHeight(!0)*e.$slideTrack.children(".slick-slide").length)));var i=e.$slides.first().outerWidth(!0)-e.$slides.first().width();!1===e.options.variableWidth&&e.$slideTrack.children(".slick-slide").width(e.slideWidth-i)},t.prototype.setFade=function(){var t,i=this;i.$slides.each(function(n,o){t=i.slideWidth*n*-1,!0===i.options.rtl?e(o).css({position:"relative",right:t,top:0,zIndex:i.options.zIndex-2,opacity:0}):e(o).css({position:"relative",left:t,top:0,zIndex:i.options.zIndex-2,opacity:0})}),i.$slides.eq(i.currentSlide).css({zIndex:i.options.zIndex-1,opacity:1})},t.prototype.setHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);if(e.$list.css("height",t),!0===e.options.arrows){var i=e.$slides.eq(e.currentSlide),n=i.is(".has_caption")?t-i.find(".gallery_image_caption").outerHeight(!0):t;e.$prevArrow.css("height",n),e.$nextArrow.css("height",n)}}},t.prototype.setOption=t.prototype.slickSetOption=function(){var t,i,n,o,a,r=this,s=!1;if("object"===e.type(arguments[0])?(n=arguments[0],s=arguments[1],a="multiple"):"string"===e.type(arguments[0])&&(n=arguments[0],o=arguments[1],s=arguments[2],"responsive"===arguments[0]&&"array"===e.type(arguments[1])?a="responsive":void 0!==arguments[1]&&(a="single")),"single"===a)r.options[n]=o;else if("multiple"===a)e.each(n,function(e,t){r.options[e]=t});else if("responsive"===a)for(i in o)if("array"!==e.type(r.options.responsive))r.options.responsive=[o[i]];else{for(t=r.options.responsive.length-1;t>=0;)r.options.responsive[t].breakpoint===o[i].breakpoint&&r.options.responsive.splice(t,1),t--;r.options.responsive.push(o[i])}s&&(r.unload(),r.reinit())},t.prototype.setPosition=function(){var e=this;e.setDimensions(),e.setHeight(),!1===e.options.fade?e.setCSS(e.getLeft(e.currentSlide)):e.setFade(),e.$slider.trigger("setPosition",[e])},t.prototype.setProps=function(){var e=this,t=document.body.style;e.positionProp=!0===e.options.vertical?"top":"left","top"===e.positionProp?e.$slider.addClass("slick-vertical"):e.$slider.removeClass("slick-vertical"),void 0===t.WebkitTransition&&void 0===t.MozTransition&&void 0===t.msTransition||!0===e.options.useCSS&&(e.cssTransitions=!0),e.options.fade&&("number"==typeof e.options.zIndex?e.options.zIndex<3&&(e.options.zIndex=3):e.options.zIndex=e.defaults.zIndex),void 0!==t.OTransform&&(e.animType="OTransform",e.transformType="-o-transform",e.transitionType="OTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.MozTransform&&(e.animType="MozTransform",e.transformType="-moz-transform",e.transitionType="MozTransition",void 0===t.perspectiveProperty&&void 0===t.MozPerspective&&(e.animType=!1)),void 0!==t.webkitTransform&&(e.animType="webkitTransform",e.transformType="-webkit-transform",e.transitionType="webkitTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.msTransform&&(e.animType="msTransform",e.transformType="-ms-transform",e.transitionType="msTransition",void 0===t.msTransform&&(e.animType=!1)),void 0!==t.transform&&!1!==e.animType&&(e.animType="transform",e.transformType="transform",e.transitionType="transition"),e.transformsEnabled=e.options.useTransform&&null!==e.animType&&!1!==e.animType},t.prototype.setSlideClasses=function(e){var t,i,n,o,a=this;i=a.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),a.$slides.eq(e).addClass("slick-current"),!0===a.options.centerMode?(t=Math.floor(a.options.slidesToShow/2),!0===a.options.infinite&&(e>=t&&e<=a.slideCount-1-t?a.$slides.slice(e-t,e+t+1).addClass("slick-active").attr("aria-hidden","false"):(n=a.options.slidesToShow+e,i.slice(n-t+1,n+t+2).addClass("slick-active").attr("aria-hidden","false")),0===e?i.eq(i.length-1-a.options.slidesToShow).addClass("slick-center"):e===a.slideCount-1&&i.eq(a.options.slidesToShow).addClass("slick-center")),a.$slides.eq(e).addClass("slick-center")):e>=0&&e<=a.slideCount-a.options.slidesToShow?a.$slides.slice(e,e+a.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):i.length<=a.options.slidesToShow?i.addClass("slick-active").attr("aria-hidden","false"):(o=a.slideCount%a.options.slidesToShow,n=!0===a.options.infinite?a.options.slidesToShow+e:e,a.options.slidesToShow==a.options.slidesToScroll&&a.slideCount-e<a.options.slidesToShow?i.slice(n-(a.options.slidesToShow-o),n+o).addClass("slick-active").attr("aria-hidden","false"):i.slice(n,n+a.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false")),"ondemand"===a.options.lazyLoad?(Cargo.Event.on("slideshow-lazyload",a.lazyLoad,this),a.lazyLoad()):"progressive"===a.options.lazyLoad&&Cargo.Event.on("slideshow-lazyload",a.progressiveLazyLoad,this)},t.prototype.setupInfinite=function(){var t,i,n,o=this;if(!0===o.options.fade&&(o.options.centerMode=!1),!0===o.options.infinite&&!1===o.options.fade&&(i=null,o.slideCount>o.options.slidesToShow)){for(n=!0===o.options.centerMode?o.options.slidesToShow+1:o.options.slidesToShow,t=o.slideCount;t>o.slideCount-n;t-=1){i=t-1;var a=e(o.$slides[i]).clone(!0).attr({id:"","data-exclude-item":""});a.find("[data-gallery-item], [data-gallery-item] *").attr("data-exclude-item",""),a.attr("data-slick-index",i-o.slideCount).prependTo(o.$slideTrack).addClass("slick-cloned")}for(t=0;t<n;t+=1){i=t;var a=e(o.$slides[i]).clone(!0).attr({id:"","data-exclude-item":""});a.find("[data-gallery-item], [data-gallery-item] *").attr("data-exclude-item",""),a.attr("data-slick-index",i+o.slideCount).appendTo(o.$slideTrack).addClass("slick-cloned")}o.$slideTrack.find(".slick-cloned").find("[id]").each(function(){e(this).attr("id","")})}},t.prototype.interrupt=function(e){e||this.autoPlay(),this.interrupted=e},t.prototype.selectHandler=function(t){var i=this,n=e(t.target).is(".slick-slide")?e(t.target):e(t.target).parents(".slick-slide"),o=parseInt(n.attr("data-slick-index"));if(o||(o=0),i.slideCount<=i.options.slidesToShow)return i.setSlideClasses(o),void i.asNavFor(o);i.slideHandler(o)},t.prototype.slideHandler=function(e,t,i){var n,o,a,r,s,l=null,d=this;if(t=t||!1,(!0!==d.animating||!0!==d.options.waitForAnimate)&&!(!0===d.options.fade&&d.currentSlide===e||d.slideCount<=d.options.slidesToShow))if(!1===t&&d.asNavFor(e),n=e,l=d.getLeft(n),r=d.getLeft(d.currentSlide),d.currentLeft=null===d.swipeLeft?r:d.swipeLeft,!1===d.options.infinite&&!1===d.options.centerMode&&(e<0||e>d.getDotCount()*d.options.slidesToScroll))!1===d.options.fade&&(n=d.currentSlide,!0!==i?d.animateSlide(r,function(){d.postSlide(n)}):d.postSlide(n));else if(!1===d.options.infinite&&!0===d.options.centerMode&&(e<0||e>d.slideCount-d.options.slidesToScroll))!1===d.options.fade&&(n=d.currentSlide,!0!==i?d.animateSlide(r,function(){d.postSlide(n)}):d.postSlide(n));else{if(d.options.autoplay&&clearInterval(d.autoPlayTimer),o=n<0?d.slideCount%d.options.slidesToScroll!=0?d.slideCount-d.slideCount%d.options.slidesToScroll:d.slideCount+n:n>=d.slideCount?d.slideCount%d.options.slidesToScroll!=0?0:n-d.slideCount:n,d.animating=!0,d.$slider.trigger("beforeChange",[d,d.currentSlide,o]),a=d.currentSlide,d.currentSlide=o,d.setSlideClasses(d.currentSlide),d.options.asNavFor&&(s=(s=d.getNavTarget()).slick("getSlick")).slideCount<=s.options.slidesToShow&&s.setSlideClasses(d.currentSlide),d.updateDots(),d.updateArrows(),!0===d.options.fade)return!0!==i?(d.fadeSlideOut(a),d.fadeSlide(o,function(){d.postSlide(o)})):d.postSlide(o),void d.animateHeight();!0!==i?d.animateSlide(l,function(){d.postSlide(o)}):d.postSlide(o)}},t.prototype.startLoad=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.hide(),e.$nextArrow.hide()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.hide(),e.$slider.addClass("slick-loading")},t.prototype.swipeDirection=function(){var e,t,i,n,o=this;return e=o.touchObject.startX-o.touchObject.curX,t=o.touchObject.startY-o.touchObject.curY,i=Math.atan2(t,e),(n=Math.round(180*i/Math.PI))<0&&(n=360-Math.abs(n)),n<=45&&n>=0?!1===o.options.rtl?"left":"right":n<=360&&n>=315?!1===o.options.rtl?"left":"right":n>=135&&n<=225?!1===o.options.rtl?"right":"left":!0===o.options.verticalSwiping?n>=35&&n<=135?"down":"up":"vertical"},t.prototype.swipeEnd=function(e){var t,i,n=this;if(n.dragging=!1,n.interrupted=!1,n.shouldClick=!(n.touchObject.swipeLength>10),n.$slider.removeAttr("data-in-transition"),void 0===n.touchObject.curX)return!1;if(!0===n.touchObject.edgeHit&&n.$slider.trigger("edge",[n,n.swipeDirection()]),n.touchObject.swipeLength>=n.touchObject.minSwipe){switch(i=n.swipeDirection()){case"left":case"down":t=n.options.swipeToSlide?n.checkNavigable(n.currentSlide+n.getSlideCount()):n.currentSlide+n.getSlideCount(),n.currentDirection=0;break;case"right":case"up":t=n.options.swipeToSlide?n.checkNavigable(n.currentSlide-n.getSlideCount()):n.currentSlide-n.getSlideCount(),n.currentDirection=1}"vertical"!=i&&(n.slideHandler(t),n.touchObject={},n.$slider.trigger("swipe",[n,i]))}else n.touchObject.startX!==n.touchObject.curX&&(n.slideHandler(n.currentSlide),n.touchObject={})},t.prototype.swipeHandler=function(t){var i=this;if("move"===t.data.action&&i.showUI(),e(t.target).closest(".slick-arrow").length?clearTimeout(this.hideUITimer):"mouseleave"==t.type?this.hideUITimer=setTimeout(this.hideUI,250):this.hideUITimer=setTimeout(this.hideUI,1500),!(!1===i.options.swipe||"ontouchend"in document&&!1===i.options.swipe||!1===i.options.draggable&&-1!==t.type.indexOf("mouse")))switch(i.touchObject.fingerCount=t.originalEvent&&void 0!==t.originalEvent.touches?t.originalEvent.touches.length:1,i.touchObject.minSwipe=i.listWidth/i.options.touchThreshold,!0===i.options.verticalSwiping&&(i.touchObject.minSwipe=i.listHeight/i.options.touchThreshold),t.data.action){case"start":i.swipeStart(t);break;case"move":i.swipeMove(t);break;case"end":i.swipeEnd(t)}},t.prototype.showUI=function(){this.$slider.find(".slick-arrow").removeClass("hidden"),clearTimeout(this.hideUITimer)},t.prototype.hideUI=function(){this.hideUITimer=null,this.$slider.find(".slick-arrow").addClass("hidden")},t.prototype.swipeMove=function(e){var t,i,n,o,a,r=this;return a=void 0!==e.originalEvent?e.originalEvent.touches:null,!(!r.dragging||a&&1!==a.length)&&(t=r.getLeft(r.currentSlide),r.touchObject.curX=void 0!==a?a[0].pageX:e.clientX,r.touchObject.curY=void 0!==a?a[0].pageY:e.clientY,r.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(r.touchObject.curX-r.touchObject.startX,2))),!0===r.options.verticalSwiping&&(r.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(r.touchObject.curY-r.touchObject.startY,2)))),"vertical"!==(i=r.swipeDirection())?(void 0!==e.originalEvent&&r.touchObject.swipeLength>4&&e.preventDefault(),o=(!1===r.options.rtl?1:-1)*(r.touchObject.curX>r.touchObject.startX?1:-1),!0===r.options.verticalSwiping&&(o=r.touchObject.curY>r.touchObject.startY?1:-1),n=r.touchObject.swipeLength,r.touchObject.edgeHit=!1,!1===r.options.infinite&&(0===r.currentSlide&&"right"===i||r.currentSlide>=r.getDotCount()&&"left"===i)&&(n=r.touchObject.swipeLength*r.options.edgeFriction,r.touchObject.edgeHit=!0),!1===r.options.vertical?r.swipeLeft=t+n*o:r.swipeLeft=t+n*(r.$list.height()/r.listWidth)*o,!0===r.options.verticalSwiping&&(r.swipeLeft=t+n*o),!0!==r.options.fade&&!1!==r.options.touchMove&&(!0===r.animating?(r.swipeLeft=null,!1):void r.setCSS(r.swipeLeft))):void 0)},t.prototype.swipeStart=function(e){var t,i=this;if(i.interrupted=!0,1!==i.touchObject.fingerCount||i.slideCount<=i.options.slidesToShow)return i.touchObject={},!1;void 0!==e.originalEvent&&void 0!==e.originalEvent.touches&&(t=e.originalEvent.touches[0]),i.touchObject.startX=i.touchObject.curX=void 0!==t?t.pageX:e.clientX,i.touchObject.startY=i.touchObject.curY=void 0!==t?t.pageY:e.clientY,setTimeout(function(){i.interrupted&&i.$slider.attr("data-in-transition","")},10),i.dragging=!0},t.prototype.unfilterSlides=t.prototype.slickUnfilter=function(){var e=this;null!==e.$slidesCache&&(e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.appendTo(e.$slideTrack),e.reinit())},t.prototype.unload=function(){var t=this;e(".slick-cloned",t.$slider).remove(),t.$dots&&t.$dots.remove(),t.$prevArrow&&t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove(),t.$nextArrow&&t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove(),t.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},t.prototype.unslick=function(e){var t=this;t.$slider.trigger("unslick",[t,e]),t.destroy()},t.prototype.updateArrows=function(){var e=this;Math.floor(e.options.slidesToShow/2),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&!e.options.infinite&&(e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===e.currentSlide?(e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):e.currentSlide>=e.slideCount-e.options.slidesToShow&&!1===e.options.centerMode?(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):e.currentSlide>=e.slideCount-1&&!0===e.options.centerMode&&(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},t.prototype.updateDots=function(){var e=this;null!==e.$dots&&(e.$dots.find("li").removeClass("slick-active").attr("aria-hidden","true"),e.$dots.find("li").eq(Math.floor(e.currentSlide/e.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden","false"))},t.prototype.visibility=function(){var e=this;e.options.autoplay&&(document[e.hidden]?e.interrupted=!0:e.interrupted=!1)},e.fn.slick=function(){var e,i,n=this,o=arguments[0],a=Array.prototype.slice.call(arguments,1),r=n.length;for(e=0;e<r;e++)if("object"==typeof o||void 0===o?n[e].slick=new t(n[e],o):i=n[e].slick[o].apply(n[e].slick,a),void 0!==i)return i;return n}}(jQuery)}(),function(e,t){var i=function(e,t,i){if(!1!==e.prototype.hasOwnProperty(name))return!1;e.prototype[t]=i};i(Node,"saveable",!1),i(Node,"setSaveable",function(e){return this.saveable=e,this}),i(Node,"isSaveable",function(){return this.saveable}),Node.prototype.persistCloneNode=function(){var e=function(t,i,n){for(var o=0;o<t.childNodes.length;o++)n(t.childNodes[o],i.childNodes[o]),0<t.childNodes[o].childNodes.length&&e(t.childNodes[o],i.childNodes[o],n)},t=Node.prototype.cloneNode.apply(this,arguments);return!0===this.isSaveable()&&t.setSaveable(!0),0<this.childNodes.length&&e(this,t,function(e,t){!0===e.isSaveable()&&t.setSaveable(!0)}),t},this.core={markAsEditable:function(e){}}}(window.CargoEditor=window.CargoEditor||{}),function(){"use strict";function e(){return this.data={main_margin:0,mobile_formatting:!1,mobile_padding:0,mobile_zoom:20},this.cache={chrome:0,offset:0,size:0,window:{h:0,w:0}},_.extend(this,Backbone.Events),this.listenTo(Cargo.Event,"design:ready",this.initialize),$(document).on("ready.BaseUnit",_.bind(this.onDocumentReady,this)),this}e.prototype.addEventListeners=function(){this.listenTo(Cargo.Event,"content_load_complete",this.refresh),this.listenTo(Cargo.Event,"editor-image-added handleAdminUIChange",this.onEditorChange),this.listenTo(Cargo.Event,"handleAdminUIChange",this.handleAdminUIChange);var e=Cargo.Helper.isMobile(),t=(e?"orientationchange":"resize")+".BaseUnit",i=e&&!Cargo.Helper.isIOS()?_.debounce(_.bind(this.onWindowResize,this),150):e&&Cargo.Helper.isIOS()?_.debounce(_.bind(this.onWindowResize,this),150):_.bind(this.onWindowResize,this);return $(window).on(t,i),$(window).on("load.BaseUnit",_.bind(this.onWindowLoad,this)),this},e.prototype.removeEventListeners=function(){return this.stopListening(),$(document).off(".BaseUnit"),$(window).off(".BaseUnit"),this},e.prototype.handleAdminUIChange=function(e,t){switch(e){case"mobile_formatting":case"mobile_pages_full_width":this.data[e]=t;break;case"main_margin":case"mobile_padding":case"mobile_zoom":this.data[e]=parseFloat(t)}return this.setBaseUnit(),this.triggerEvent("refresh"),this},e.prototype.onDocumentReady=function(e){this.$html=$(document.documentElement),this.addEventListeners(),Cargo.Event.trigger("design:ready")},e.prototype.onWindowLoad=function(e){CargoEditor&&CargoEditor.events&&this.listenTo(CargoEditor.events,"editor-summary-created",this.onEditorChange),this.cacheWindowSize(),this.refresh()},e.prototype.isIphoneX=function(){var e=window.devicePixelRatio||1,t=window.screen.width*e,i=window.screen.height*e;return!(!/iPad|iPhone|iPod/.test(navigator.userAgent)||window.MSStream||1125!=t||2436!==i)},e.prototype.onWindowResize=function(e){this.cacheWindowSize(),this.setBaseUnit(),this.triggerEvent("refresh")},e.prototype.onEditorChange=_.debounce(function(){this.refresh(),Cargo.Plugins.elementResizer.refresh()},0),e.prototype.initialize=function(){var e=Cargo.Model.DisplayOptions.get("layout_options");return this.data=_.extend(this.data,e),this.data.mobile_zoom=parseFloat(this.data.mobile_zoom),this.data.mobile_padding=parseFloat(this.data.mobile_padding),this.data.main_margin=parseFloat(this.data.main_margin),this.cacheWindowSize(),this.refresh(),Cargo.Plugins.elementResizer.refresh(),this},e.prototype.refresh=function(){return this.setBaseUnit(),this.triggerEvent("refresh"),this},e.prototype.cacheWindowSize=function(){return Cargo.Helper.isMobile()?(document.documentElement.clientWidth>window.innerHeight?(this.cache.window.h=screen.width||window.innerHeight,this.cache.window.w=screen.height||document.documentElement.clientWidth,this.isIphoneX()&&(this.cache.window.w=document.documentElement.clientWidth)):(this.cache.window.h=screen.height||window.innerHeight,this.cache.window.w=screen.width||document.documentElement.clientWidth),this.cache.chrome=this.cache.window.h-window.innerHeight,this):(this.cache.window.h=window.innerHeight,this.cache.window.w=document.documentElement.clientWidth,this)},e.prototype.setBaseUnit=function(){var e,t=0,i=this.data.mobile_padding,n=this.data.mobile_zoom-15;return this.cache.window.h>this.cache.window.w&&(t=this.cache.window.h/this.cache.window.w-1),(t/=.777777778)>1&&(t=1),i=Math.abs(i)/10,i=this.data.main_margin*i*t*-1,e=this.getBaseUnit({weight:9+n*t,min:20}),this.triggerEvent("set",{diff:t,offset:i,size:e}),this.cache.size===e?this:(this.$html.css("font-size",e+"%"),this.cache.size=e,this)},e.prototype.getBaseUnit=function(e){e=e||{};var t=0;return t=(e=$.extend(!0,{height:this.cache.window.h,width:this.cache.window.w,min:11,max:!1,weight:5,round:!1,offset:1},e)).width<e.height?e.width:e.height,t*=e.offset,t/=100/e.weight,e.min&&t<e.min&&(t=e.min),e.max&&t>e.max&&(t=e.max),e.round&&(t=Math.floor(t)),t},e.prototype.triggerEvent=function(e,t){return e="BaseUnit:"+e,t=t||{},Cargo.Event.trigger(e,_.extend(t,{cache:this.cache,data:this.data})),this},window.BaseUnit=e}(),function(){"use strict";function e(){return this.cache={},this.data={},_.extend(this,Backbone.Events),$(document).on("ready.MobileAdjustments",_.bind(this.setup,this)),this.listenTo(Cargo.Event,"BaseUnit:refresh BaseUnit:set",this.cacheChanges),this.listenTo(Cargo.Event,"slideshow_update BaseUnit:refresh",this.stretchShortMobileContent),this.listenTo(Cargo.Event,"mobile_size",this.setMobileClass),this}e.prototype.setup=function(){this.$body=$(document.body),this.$main=$("main"),this.$containerPadding=$("[data-container-padding]"),this.$contentPadded=$(".l-content-padding"),this.$contentRuler=$("[data-content-ruler]"),this.listenTo(Cargo.Event,"BaseUnit:set content_load_complete set_render_complete thumbnails_render_complete inspector_style_changed",this.onOtherEvent)},e.prototype.stretchShortMobileContent=function(){if(!_.isEmpty(this.cache)){var e=this.cache.window.h-this.cache.chrome>=this.$contentPadded.outerHeight();return this.data.mobile_formatting||!e?(this.$main.css({position:"",top:"",bottom:"",minHeight:""}),this):(this.$main.css({position:"fixed",top:0,bottom:0,minHeight:0}),this)}},e.prototype.forceMobileSizing=function(){return this.$contentRuler.width()/this.data.window.w*100>85},e.prototype.setMobileClass=function(e){this.$body||(this.$body=$(document.body));var t=e?"addClass":"removeClass";this.is_mobile_size=e,this.$body[t]("mobile"),this.setPagesToFullWidth()},e.prototype.setMobilePaddingOffset=function(e){var t=this,i=this.$body.find(".content_padding");this.mobile_padding=parseFloat(e.mobile_padding),i.each(function(){if(t.is_mobile_size){var e,i,n=parseInt($(this).closest("[data-id]").attr("data-id")),o=Cargo.Collection.Scaffolding.getModel({id:n});if(Cargo.Helper.IsAdminEdit()&&void 0!==parent.Cargo&&void 0!==parent.Cargo.Editor&&void 0!==parent.Cargo.Editor.View&&void 0!==parent.Cargo.Editor.View.ContentView&&parent.Cargo.Editor.View.ContentView.$el.is("#editproject")&&parent.Cargo.Editor.View.ContentView.pid==n){if(e=!0,void 0===parent.Cargo.Editor.View.ContentView.layoutOptions)return;i=parent.Cargo.Editor.View.ContentView.layoutOptions.getCurrentValues()}else e=!1,i=void 0!==o?o.getPageOption("local_layout_options"):Cargo.Model.DisplayOptions.get("layout_options");var a,r,s=Cargo.Model.DisplayOptions.get("layout_options");_.each(["top","right","bottom","left"],function(n){if(a="main_margin_"+n,r=NaN,i&&void 0!==i[a]?r=e?parseFloat(i[a].value):parseFloat(i[a]):s&&void 0!==s[a]&&(r=parseFloat(s[a])),isNaN(r))this.style.removeProperty("padding-"+n);else{var o=t.calculateMobilePaddingOffset(r);this.style.setProperty("padding-"+n,o+"rem")}},this)}else this.removeAttribute("style")});var n,o=document.getElementById("site_menu_button"),a=document.getElementById("shop_button"),r=[];o&&r.push(o),a&&r.push(a),_.each(document.styleSheets,function(e){e&&e.ownerNode&&"member_stylesheet"==e.ownerNode.id&&(n=e),e&&e.publicData&&"member_stylesheet"==e.publicData.id&&(n=e)}),n&&void 0!==r[0]&&_.each(r,function(e,i){var o;try{o=n.cssRules}catch(e){console.warn(e)}if(o){var a={top:"",right:"",bottom:"",left:""};_.each(o,function(t){(function(e,t){var i=Element.prototype,n=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(e){return-1!==[].indexOf.call(document.querySelectorAll(e),this)};try{return n.call(e,t)}catch(e){console.warn(e)}return!1})(e,t.selectorText)&&_.each(t.style,function(e){a.hasOwnProperty(e)&&(a[e]=t.style[e])})}),_.each(a,function(i,n){if(t.is_mobile_size){if(""!==i){var o=parseFloat(i),a=t.calculateMobilePaddingOffset(o);e.style[n]=a+"rem"}}else e.style[n]=""})}}),Cargo.Event.trigger("mobile_padding_set")},e.prototype.calculateMobilePaddingOffset=function(e){var t=e-Math.abs(this.mobile_padding)/10*e;return Number(t.toFixed(1))},e.prototype.setPagesToFullWidth=function(e){this.mobile_pages_full_width=void 0!==e?e.mobile_pages_full_width:this.data.mobile_pages_full_width;var t=this.mobile_pages_full_width&&this.is_mobile_size?"addClass":"removeClass";this.$body[t]("full_width")},e.prototype.onOtherEvent=function(){this.setMobilePaddingOffset(this.data),this.setPagesToFullWidth(this.data)},e.prototype.cacheChanges=function(e){this.cache=e.cache,this.data=e.data},e.prototype.eventPreventDefault=function(e){e.preventDefault()},window.MobileAdjustments=e}(),Cargo=window.Cargo||{},Cargo.Modal;var modal=Backbone.View.extend({id:"confirm_modal",defaults:{message:"Save changes?",modal_type:"save",selector:"body",textarea_value:""},template:null,existingLinkElement:void 0,events:{"click .modal-overlay":"ModalClose","click [data-confirm]":"ModalConfirm","click [data-deny]":"ModalDeny"},is_active:!1,blocked:!1,initialize:function(e){if(null==this.template){var t=this;$.get("/_jsapps/modal/modal.html",function(e){t.template=_.template(e)})}},render:function(){var e=this.template({modal:this.model.toJSON()});return this.$el.html(e),void 0!==Cargo.View&&void 0!==Cargo.View.Following&&!Cargo.View.Following.enabled&&null==Cargo.Homepage&&Cargo.Helper.IsAdminEdit()&&setTimeout(function(){$(this.el).attr("tabindex","-1"),$(this.el).focus(),$("#editor_masterview").length>0&&$("#editor_masterview").is(".translate")&&parseInt($("#panel_content").css("top"))>0&&$("#master_wrapper").scrollTop(parseInt($("#panel_content").css("top"))),setTimeout(function(){$(this.el).focus()}.bind(this),100)}.bind(this),100),Cargo.Event.once("enter_keycode_triggered",this.ModalConfirm,this),Cargo.Event.once("esc_keycode_triggered",this.ModalClose,this),"save"==this.model.get("modal_type")&&Cargo.Event.once("save_shortcut_triggered",this.ModalConfirm,this),void 0!==Cargo.View&&void 0!==Cargo.View.Following&&Cargo.View.Following.enabled&&Cargo.View.Following.scrollOffset&&(this.$el.find(".modal-overlay").css("top",Cargo.View.Following.scrollOffset.top+"px"),this.$el.find(".confirm-box").css("top","calc("+Cargo.View.Following.scrollOffset.top+"px + 40%)")),Cargo.Event.trigger("modal_render_complete"),this},Confirm:function(e){(e=e||{}).modal_type="confirm",this.show(e)},ConfirmWithProgress:function(e){(e=e||{}).modal_type="confirm_with_progress",this.show(e)},Alert:function(e){(e=e||{}).modal_type="alert",this.show(e)},Prompt:function(e){(e=e||{}).modal_type="prompt",this.show(e),$(document).on("keydown.confirm_modal",_.bind(function(e){!0===e.shiftKey&&13===e.keyCode&&(e.preventDefault(),this.ModalConfirm())},this)),setTimeout(_.bind(function(){var e=$("[data-modal-textarea]",this.el)[0];e.focus();var t=e.value;e.value="",e.value=t},this),300)},Dialog:function(e){(e=e||{}).modal_type="dialog",this.show(e),setTimeout(_.bind(function(){$("[data-modal-textarea]",this.el).select()},this),300)},Block:function(e){(e=e||{}).modal_type="block",this.blocked=!0,this.show(e)},Save:function(e){(e=e||{}).modal_type="save",this.show(e)},show:function(e){this.model=null,this.model=new Backbone.Model(this.defaults),_.extend(this.model.attributes,e),$(this.model.get("selector")).append(this.render().el),Cargo.Event.trigger("confirm_modal:open"),this.is_active=!0},isActive:function(){return this.is_active},ModalConfirm:function(){var e,t=this.model.get("modal_type");"function"==typeof this.model.get("confirm")&&("prompt"==t&&(e=$("[data-modal-textarea]",this.el).val()),this.model.get("confirm")(e)),this.model.set("modal_type",null),"confirm_with_progress"==t?this.ShowProgress():this.ModalClose()},ModalDeny:function(){"function"==typeof this.model.get("deny")&&this.model.get("deny")(),this.ModalClose()},ModalClose:function(){if(!0!==this.blocked){if("alert"==this.model.get("modal_type"))return this.model.set("modal_type",null),void this.ModalConfirm();this.is_active=!1,Cargo.Event.off("enter_keycode_triggered",this.ModalConfirm),Cargo.Event.off("enter_keycode_triggered",this.ModalClose),Cargo.Event.off("esc_keycode_triggered",this.ModalClose),Cargo.Event.off("save_shortcut_triggered",this.ModalConfirm),Cargo.Event.trigger("confirm_modal:close"),$(document).off("keydown.confirm_modal"),this.el.remove()}},ShowProgress:function(){this.blocked=!0,$("[data-modal-message] div").html(this.model.get("progress_message")),$("[data-deny], [data-confirm]",this.el).hide(),$("[data-progress]",this.el).show(),this.UpdateProgress(0)},UpdateProgress:function(e){var t=$("[data-progress]",this.el),i=t.find(".progress-indicator"),n=t.find(".progress-percentage");0!=e||this.processing?e>10&&(i.find(".loading_animation").length>0&&(i.removeClass("waiting"),i.find(".loading_animation").remove()),i.css("width",e+"%"),n.text(e+"%")):(i.addClass("waiting").html(Cargo.Core.Handlebars.Render("{{>loading_animation}}",{})),this.processing=!0),100==e&&(this.processing=!1,this.blocked=!1)}});Cargo.Modal=new modal;var Backdrop={Data:{require_loaded:!1},o:{}};Backdrop.o.model={},Backdrop.o.collection={},Backdrop.Model={},Backdrop.Collection={},Backdrop.View={},Backdrop.o.model.Settings=Backbone.Model.extend({constructor:function(){this.defaults={page_id:void 0,backdrop_id:1,backdrop_path:"none",data:{}},Backbone.Model.prototype.constructor.apply(this,arguments)},url:function(){var e=Cargo.API.Config;return e.api_path+"/"+e.Version+"/backdrop/"+Cargo.Model.Site.get("site_url")+"/"+this.get("page_id")+"/"+this.get("backdrop_id")}}),Backdrop.o.model.Global=Backbone.Model.extend({isNew:function(){return!0},fetch:function(e){$("[data-set='GlobalSettings']").length>0?this.set($.parseJSON($("[data-set='GlobalSettings']").html()),e):Backbone.Model.prototype.fetch.apply(this,arguments)},url:function(){var e=Cargo.API.Config;return e.api_path+"/"+e.Version+"/backdrop/"+e.cargo_url}});var Cargo=Cargo||{};Cargo.Plugins=Cargo.Plugins||{},function(){function e(){}e.prototype.initializeImage=function(e){},e.prototype.setSrcAccordingToSize=function(e){if(null!=e){var t=Math.floor(Math.min(250*Math.ceil(Math.max(childObj.actualWidth,parentWidth)/250),childObj.imageModel.get("width"))),i=childObj.imageModel.getImageWithOptions({w:t});i.retina&&childObj.actualWidth/i.w>.8&&(i=childObj.imageModel.getImageWithOptions({w:t,q:94})),(i.w>childObj.lastSize||i.q>childObj.lastQ)&&childObj.element.attr("src")!==i.url&&(childObj.element.attr("src",i.url),childObj.lastSize=i.w,childObj.lastQ=i.q,childObj.element[0].__cachedLastSize=i.w,childObj.element[0].__cachedLastQ=i.q)}},Cargo.Plugins.imageSrcLoader=new e}();var Cargo=Cargo||{},requirejs,require,define;Cargo.Plugins=Cargo.Plugins||{},Cargo.Plugins.elementResizer=function(e){var t=/googlebot|bingbot|crawler|spider|robot|crawling/i.test(navigator.userAgent);function i(e,t){var n=e&&(t(e)?e:i(e.parentNode,t));return n||null}var n={vars:{ticking:!1,initialized:!1,isInCargoFrame:function(){var e=/\/adminedit/.test(document.location.pathname)||/\/admin/.test(document.location.pathname);try{var t=parent!=window&&"object"==typeof parent.Cargo,i=null!=Cargo.Editor;return e||t||i}catch(e){return!1}}()},options:{cargo_refreshEvents:["homepage_loaded","show_index_complete","mobile_padding_set","inspector_preview","page_collection_reset","direct_link_loaded","image_gallery_init_complete"],generic_refreshEvents:[],updateEvents:["resize","orientationchange"],selectors:["img","object","iframe","video",".elementresizer","[data-elementresizer-child]",".audio_component"],targets:{},minimumHeight:1,minimumWidth:1,centerElements:!0,adjustElementsToWindowHeight:!0,forceMobileImagesFullWidth:!1,forceMargin:!1,scrollTransition:!1,scrollTransitionThreshold:-100,forceVerticalMargin:40,forceHorizontalMargin:0,allowInit:!0},init:function(){function t(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)}if(this.isMobile=!!Cargo.Helper&&Cargo.Helper.isMobile(),Cargo.Event.trigger("element_resizer_init",o),!n.options.allowInit)return!1;var i,a=document.createElement("img");a.classList.add("scroll-transition-fade","below-viewport");var r=document.createElement("div");r.classList.add("content"),r.appendChild(a),document.body.appendChild(r);var s=window.getComputedStyle(a).getPropertyValue("transform"),l=s.indexOf("matrix(")>-1,d=s.indexOf("matrix3d(")>-1,c=0,h=0;if(l){s=s.replace(")","").replace("matrix(","").split(",");for(var u=0;u<s.length;u++)s[u]=parseFloat(s[u])||0;h=s[s.length-1],c=s[s.length-2]}else if(d){s=s.replace(")","").replace("matrix3d(","").split(",");for(u=0;u<s.length;u++)s[u]=parseFloat(s[u]);h=s[s.length-3],c=s[s.length-4]}document.body.removeChild(r),this.imageTransforms={x:c,y:h},e.each(n.options.updateEvents,function(e,o){t(window,o,function(){n.requestTick(),"orientationchange"===o&&(clearTimeout(i),i=setTimeout(function(){n.requestTick()},160))})}),e.each(n.options.generic_refreshEvents,function(e,i){t(window,i,function(){n.refresh()})}),Cargo.Event.on("pagination_complete",function(){n.matchImagesWithImageModels(),n.refresh(!0)}),e.each(n.options.cargo_refreshEvents,function(e,t){Cargo.hasOwnProperty("Event")&&Cargo.Event.on(t,function(){n.requestRefreshTick()})}),Cargo.hasOwnProperty("Event")&&Cargo.Event.on("inspector_open",function(){CargoInspector.eventManager.subscribe("style_changed",function(e){n.requestTick()})});try{var g=window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5)");"function"==typeof g.addListener&&g.addListener(function(){n.setResponsiveImageSrcs(),scrollMonitor.update()})}catch(e){}Cargo.Event.on("content_load_complete",function(){n.matchImagesWithImageModels(),n.requestTick()}),Cargo.Event.on("thumbnails_hide",function(){_.defer(function(){n.update()})}),Cargo.Event.on("thumbnails_render_complete",function(){scrollMonitor.update()}),void 0!==Cargo.Collection&&void 0!==Cargo.Collection.Scaffolding&&Cargo.Collection.Scaffolding.on("add",_.debounce(function(){n.matchImagesWithImageModels(),n.update()},1)),Cargo.Event.on("pin_load_complete",function(){n.requestRefreshTick()}),Cargo.Event.on("pin_format_complete",function(){n.requestTick()}),n.vars.initialized=!0,n.refresh()},refresh:function(t){if(!0!==t&&(t=!1),!n.vars.initialized)return!1;var a=e("[data-elementresizer]");t||(n.options.targets={}),a.each(function(o,a){if(t&&_.find(n.options.targets,function(e){return e.container[0]===a}))return;var r=e(a).find(n.options.selectors.join(",")),s=e(i(a,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("data-resize-parent")}));0==s.length&&(s=e("body"));var l=[];r.each(function(t,o){var r=i((o=e(o))[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("image-gallery")});if((!r||r.classList.contains("initialized"))&&(null===i(o[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("data-no-elementresizer")})&&!o[0].hasAttribute("data-no-elementresizer"))){var s=i(o[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("grid-col")}),d=i(o[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("slick")}),c=i(o[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.hasAttribute("thumbnails")}),h=i(a,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return"wallpaper"==e.getAttribute("data-backdrop")}),u=i(o[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("page_container")&&e.classList.contains("overlay")&&e.classList.contains("accommodate")});fixedPinParent=i(o[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("page_container")&&e.classList.contains("fixed")}),marqueeParent=i(o[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("marquee")});var g=o.width(),p=o.height(),m=parseInt(o.attr("data-rotation"))||0,f=parseInt(o.attr("width")),v=parseInt(o.attr("height")),b="string"==typeof o.attr("height")&&-1!==o.attr("height").indexOf("%"),y="string"==typeof o.attr("width")&&-1!==o.attr("width").indexOf("%"),_=isNaN(f)?g:f,w=isNaN(v)?p:v;minimumHeight=n.constrain(n.options.minimumHeight,0,w),minimumWidth=n.constrain(n.options.minimumWidth,0,_),childObj={element:o,hasBeenHandled:!1,originalWidth:_,originalHeight:w,widthIsPercentage:y,heightIsPercentage:b,actualWidth:f,actualHeight:v,actualRotation:m,minimumHeight:minimumHeight>w?w:minimumHeight,minimumWidth:minimumWidth>_?_:minimumWidth,ratio:w/_,isDraggable:o[0].hasAttribute("data-draggable"),isInWallpaper:null!==h,isInSlideshow:null!==d,isInMarquee:null!==marqueeParent,isInColumns:null!==s,isInThumbnails:null!==c,isInGallery:null!==r,isinFixedPinnedPage:null!==fixedPinParent,isInAdjustingPinnedPage:null!==u,nodeName:o[0].nodeName.toLowerCase(),isAudioPlayer:o.hasClass("audio_component"),noResize:o.parent("[data-elementresizer-no-resize]").length>0||o[0].hasAttribute("data-elementresizer-no-resize"),noCentering:o.parent("[data-elementresizer-no-centering]").length>0||o[0].hasAttribute("data-elementresizer-no-centering"),noVerticalResize:o.parent("[data-elementresizer-no-vertical-resize]").length>0||o[0].hasAttribute("data-elementresizer-no-vertical-resize"),prevLeftMargin:0,lastSize:o[0]._cachedLastSize?o[0]._cachedLastSize:0,lastQ:o[0]._cachedLastQ?o[0]._cachedLastQ:0,isSoundCloudFrame:-1!==(o.attr("src")+"").indexOf("soundcloud")&&"IFRAME"===o[0].nodeName},l.push(childObj)}}),l=l.concat([]);var d=parseInt(e(s).css("paddingLeft"))+parseInt(e(s).css("paddingRight"));isNaN(d)&&(d=0),n.options.targets[_.uniqueId()]={container:e(a),resize_parent:s,children:l,padding:d}}),n.matchImagesWithImageModels(),n.update(),Cargo.Event.trigger("elementresizer_refresh_complete",o)},matchImagesWithImageModels:function(){_.each(n.options.targets,function(e){if(Cargo.View.ImagesView)_.each(e.children,function(e){if(e.element[0].nodeType===Node.ELEMENT_NODE&&"IMG"===e.element[0].nodeName){var t=parseInt(e.element[0].getAttribute("data-mid"));isNaN(t)||(e.imageModel=Cargo.View.ImagesView.collection.findWhere({id:t}))}});else if(e.container[0].hasAttribute("thumbnails"))_.each(e.children,function(e){if(!e.imageModel){var t=i(e.element[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.classList.contains("thumbnail")});if(t){var n=parseInt(t.getAttribute("data-id")),o=Cargo.View.Thumbnail.collection.get(n);if(o&&o.get("thumb_meta")&&o.get("thumb_meta").thumbnail_crop&&o.get("thumb_meta").thumbnail_crop.imageModel)e.imageModel=new Cargo.o.model.image(o.get("thumb_meta").thumbnail_crop.imageModel);else{var a=Cargo.Collection.Scaffolding.getModel({id:n});if(void 0!==a&&void 0!==a.get("images")){var r=parseInt(e.element[0].getAttribute("data-mid"));isNaN(r)||(e.imageModel=_.where(a.get("images"),{id:r})[0])}}}}});else{var t,n=i(e.container[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&"DIV"===e.nodeName)return e.hasAttribute("data-id")});if(n&&(t=parseInt(n.getAttribute("data-id"))),!isNaN(t)){var o=Cargo.Collection.Scaffolding.getModel({id:parseInt(t)});void 0!==o&&void 0!==o.get("images")&&_.each(e.children,function(e){var t=parseInt(e.element[0].getAttribute("data-mid"));isNaN(t)||(e.imageModel=_.where(o.get("images"),{id:t})[0])})}}})},requestRefreshTick:function(){n.vars.refresh_ticking||(requestAnimationFrame(function(){n.refresh()}),n.vars.refresh_ticking=!0)},requestTick:function(){n.vars.ticking||(requestAnimationFrame(function(){n.vars.refresh_ticking||n.update()}),n.vars.ticking=!0)},constrain:function(e,t,i){return e>i?i:e<t?t:e},update:function(){var t,a,r;for(t in n.options.targets){var s=(r=n.options.targets[t]).container.width(),l=(r.padding,r.resize_parent.width()-n.options.forceHorizontalMargin),d=n.options.adjustElementsToWindowHeight?document.documentElement.clientHeight-n.options.forceVerticalMargin:9e9,c=n.options.forceMobileImagesFullWidth&&Cargo.Helper.IsMobileWindowSize(document.documentElement.clientWidth),h=1;n.options.adjustElementsToWindowHeight&&void 0!==window.orientation&&0!=window.orientation&&(v=document.documentElement.clientWidth-(!1===n.options.forceMargin?40:n.options.forceMargin));var u=!!n.vars.isInCargoFrame&&null!==i(r.container[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("page_content")});for(a in r.children){var g,p=l,m=(g=r.children[a]).minimumHeight,f=g.minimumWidth,v=d,b=c&&!g.isInMarquee?1:parseInt(g.element.attr("data-scale"))/100||1;if(rotation=parseInt(g.element[0].getAttribute("data-rotation")),transformX=g.isDraggable?g.element[0].getAttribute("data-transform-x"):0,transformY=g.isDraggable?g.element[0].getAttribute("data-transform-y"):0,!g.noResize){if(g.isInColumns){var y=i(g.element[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.hasAttribute("grid-col")});y&&(s=p=e(y).width(),p-=n.options.forceHorizontalMargin)}if(g.noVerticalResize)v=9e9;else{var w=i(r.container[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("content_padding")}),C=0;w&&(C+=Math.ceil(parseFloat(e(w).css("padding-top"),10))),!g.isInAdjustingPinnedPage&&Cargo.View.PinnedTop.pinCollection.findWhere({content_accommodate_page:!0})&&(C+=Cargo.View.PinnedTop.pinCollection.findWhere({content_accommodate_page:!0}).get("page_height")),v=d+-2*(C=Math.min(C,.25*d))}var S=g.actualWidth,k=g.actualHeight;p=p*b,n.constrain(p-S,1,9e9),n.constrain(v-k,1,9e9),h=[p/g.actualWidth,v/g.actualHeight];if(h=Math.min(h[0],h[1]),k=n.constrain(k*h,-9e9,g.originalHeight),S=n.constrain(S*h,-9e9,g.originalWidth),g.widthIsPercentage?(S=s/100*g.originalWidth,k=g.heightIsPercentage?g.originalHeight/100*S:g.originalHeight):g.heightIsPercentage&&(k=S/100*g.originalHeight),(k<=m||S<=f)&&(h=[f/S,m/k],k*=h=Math.max(h[0],h[1]),S*=h),(!1===g.hasBeenHandled||Math.abs(g.actualWidth-S)>.5||Math.abs(g.actualHeight-k)>.5||g.actualRotation!==rotation)&&!isNaN(S)&&!isNaN(k)){g.actualWidth=S,g.actualHeight=k,g.actualRotation=rotation;var x=g.isInGallery||isNaN(rotation)?"":"rotate("+rotation+"deg)";(transformX||transformY)&&(x="translate("+transformX+"%, "+transformY+"%) "+x),g.element.add("object"===g.nodeName?g.element.find("embed"):"").css({width:g.actualWidth+"px",height:g.actualHeight+"px",transform:x}),g.hasBeenHandled=!0}}n.options.centerElements&&!g.noCentering&&n.setLeftMargin(g,s),function(t){var o=t.isInGallery||t.isInThumbnails?t.element.parent():t.element;if(t.isInSlideshow&&t.isInGallery&&(o=e(i(t.element[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("image-gallery")}))),t.isInMarquee&&(o=e(i(t.element[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("marquee")}))),!u&&"undefined"!=typeof scrollMonitor&&!t.isinFixedPinnedPage)if(void 0!==t.element[0]._scrollWatcher||t.isInSlideshow&&t.isInGallery||t.isInMarquee?t.element[0]._scrollWatcher&&t.element[0]._scrollWatcher.recalculateLocation():(t.element[0]._scrollWatcher=scrollMonitor.create(t.element[0],n.isMobile?screen.height/4:screen.height),t.element[0]._scrollWatcher.enterViewport(function(){if(!i(this.watchItem,function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return"BODY"===e.nodeName}))return this.watchItem._scrollWatcher.destroy(),void 0!==this.watchItem._scrollWatchEnterThreshold&&this.watchItem._scrollWatchEnterThreshold.destroy(),void(void 0!==this.watchItem._referenceScrollWatch&&this.watchItem._referenceScrollWatch.destroy());this.watchItem._animationFrameCancelID=requestAnimationFrame(_.bind(function(){this.watchItem.hasAttribute("data-lazy-src")&&(this.watchItem.setAttribute("src",this.watchItem.getAttribute("data-lazy-src")),this.watchItem.removeAttribute("data-lazy-src")),n.options.scrollTransition&&!u&&o.css("will-change","opacity, transform"),delete this.watchItem._animationFrameCancelID},this))}),t.element[0]._scrollWatcher.exitViewport(function(){this.watchItem._animationFrameCancelID&&cancelAnimationFrame(this.watchItem._animationFrameCancelID),this.isBelowViewport&&n.options.scrollTransition&&!u&&o.css("will-change","")})),n.options.scrollTransition){u||o.addClass("scroll-transition-fade"),void 0!==t.element[0]._scrollWatchEnterThreshold||o[0]._is_watched||(t.element[0]._scrollWatchEnterThreshold=scrollMonitor.create(o[0],n.options.scrollTransitionThreshold),o[0]._is_watched=!0,t.element[0]._scrollWatchEnterThreshold.enterViewport(function(){this.watchItem._startScrollWatchLeave&&(cancelAnimationFrame(this.watchItem._startScrollWatchLeave),delete this.watchItem._startScrollWatchLeave),this.watchItem._endScrollWatchLeave&&(cancelAnimationFrame(this.watchItem._endScrollWatchLeave),delete this.watchItem._endScrollWatchLeave);var e=0,i=0,n=0;t.isDraggable&&(e=t.element[0].getAttribute("data-transform-x")||0,i=t.element[0].getAttribute("data-transform-y")||0,n=t.element[0].getAttribute("data-transform-z")||0),this.watchItem.style.transitionDuration="",t.isInMarquee?this.watchItem.style.transform="":t.isInGallery&&t.actualRotation?this.watchItem.style.transform="rotate("+-t.actualRotation+"deg) translate("+e+"%, "+i+"%) rotate("+t.actualRotation+"deg) translateZ("+n+"px)":t.actualRotation||t.isDraggable?this.watchItem.style.transform="translate("+e+"%, "+i+"%) rotate("+t.actualRotation+"deg) translateZ("+n+"px)":this.watchItem.style.transform="",this.watchItem.classList.remove("below-viewport")})),void 0===t.element[0]._referenceScrollWatch&&(t.element[0]._referenceScrollWatch=scrollMonitor.create(o[0]),t.element[0]._referenceScrollWatch.enterViewport(function(){if(scrollMonitor.documentHeight-this.bottom<=-1*n.options.scrollTransitionThreshold){var e=0,i=0,o=0;t.isDraggable&&(e=t.element[0].getAttribute("data-transform-x")||0,i=t.element[0].getAttribute("data-transform-y")||0,o=t.element[0].getAttribute("data-transform-z")||0),t.isInMarquee?this.watchItem.style.transform="":t.isInGallery&&t.actualRotation?this.watchItem.style.transform="rotate("+-t.actualRotation+"deg) translate("+e+"%, "+i+"%) rotate("+t.actualRotation+"deg) translateZ("+o+"px)":t.actualRotation||t.isDraggable?this.watchItem.style.transform="translate("+e+"%, "+i+"%) rotate("+t.actualRotation+"deg) translateZ("+o+"px)":this.watchItem.style.transform="",this.watchItem.classList.remove("below-viewport")}}),t.element[0]._referenceScrollWatch.exitViewport(function(){if(this.isBelowViewport&&!u)this.watchItem.style.transitionDuration="initial",this.watchItem._startScrollWatchLeave=requestAnimationFrame(_.bind(function(){this.watchItem.classList.add("below-viewport");var e=0,i=0,o=0;t.isDraggable&&(e=t.element[0].getAttribute("data-transform-x")||0,i=t.element[0].getAttribute("data-transform-y")||0,o=t.element[0].getAttribute("data-transform-z")||0),t.isInMarquee?this.watchItem.style.transform="":t.actualRotation&&t.isInGallery?this.watchItem.style.transform="rotate("+-t.actualRotation+"deg) translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+o+"px)":!t.actualRotation||e||i?t.isDraggable?this.watchItem.style.transform="translate("+e+"%, "+i+"%) translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+o+"px)":this.watchItem.style.transform="":this.watchItem.style.transform="translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+o+"px)",void 0!==t.element[0]._scrollWatchEnterThreshold&&t.element[0]._scrollWatchEnterThreshold.recalculateLocation(),void 0!==t.element[0]._referenceScrollWatch&&t.element[0]._referenceScrollWatch.recalculateLocation(),this.watchItem._endScrollWatchLeave=requestAnimationFrame(_.bind(function(){this.watchItem.style.transitionDuration=""},this))},this));else if(this.isAboveViewport){this.watchItem.classList.remove("below-viewport");var e=0,i=0,o=0;t.isDraggable&&(e=t.element[0].getAttribute("data-transform-x")||0,i=t.element[0].getAttribute("data-transform-y")||0,o=t.element[0].getAttribute("data-transform-z")||0),t.isInMarquee?this.watchItem.style.transform="":t.isInGallery&&t.actualRotation?this.watchItem.style.transform="rotate("+-t.actualRotation+"deg) translate("+e+"%, "+i+"%) rotate("+t.actualRotation+"deg) translateZ("+o+"px)":t.actualRotation||t.isDraggable?this.watchItem.style.transform="translate("+e+"%, "+i+"%) rotate("+t.actualRotation+"deg) translateZ("+o+"px)":this.watchItem.style.transform="",this.watchItem.style.willChange=""}})),void 0===o[0]._reCalculateScrolMonitorOnTransitionEnd&&(o[0]._reCalculateScrolMonitorOnTransitionEnd=function(e){var i=e.propertyName;"transform"!=i&&"top"!=i&&"margin-top"!=i&&"margin"!=i||(void 0!==t.element[0]._scrollWatchEnterThreshold&&(t.element[0]._scrollWatchEnterThreshold.recalculateLocation(),t.element[0]._scrollWatchEnterThreshold.update(),t.element[0]._scrollWatchEnterThreshold.triggerCallbacks()),void 0!==t.element[0]._referenceScrollWatch&&(t.element[0]._referenceScrollWatch.recalculateLocation(),t.element[0]._referenceScrollWatch.update(),t.element[0]._referenceScrollWatch.triggerCallbacks()))},o[0].addEventListener("transitionend",o[0]._reCalculateScrolMonitorOnTransitionEnd));var a=e(t.element[0]._referenceScrollWatch.watchItem);a[0].style.transitionDuration="",a[0].classList.remove("below-viewport");var r=0,s=0,l=0;t.isDraggable&&(r=t.element[0].getAttribute("data-transform-x")||0,s=t.element[0].getAttribute("data-transform-y")||0,l=t.element[0].getAttribute("data-transform-z")||0),t.isInMarquee?a[0].style.transform="":t.isInGallery&&t.actualRotation?a[0].style.transform="rotate("+-t.actualRotation+"deg) translate("+r+"%, "+s+"%) rotate("+t.actualRotation+"deg) translateZ("+l+"px)":t.actualRotation||t.isDraggable?a[0].style.transform="translate("+r+"%, "+s+"%) rotate("+t.actualRotation+"deg) translateZ("+l+"px)":a[0].style.transform="",t.element[0]._referenceScrollWatch.isInViewport||t.element[0]._referenceScrollWatch.isAboveViewport||(t.isInMarquee?a[0].style.transform="":t.actualRotation&&t.isInGallery?a[0].style.transform="rotate("+-t.actualRotation+"deg) translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+l+"px)":!t.actualRotation||r||s?t.isDraggable?a[0].style.transform="translate("+r+"%, "+s+"%) translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+l+"px)":a[0].style.transform="":a[0].style.transform="translate("+n.imageTransforms.x+"px, "+n.imageTransforms.y+"px) rotate("+t.actualRotation+"deg) translateZ("+l+"px)",a[0].classList.add("below-viewport"))}else void 0!==o[0]._scrollWatchEnterThreshold&&(o[0]._scrollWatchEnterThreshold.destroy(),delete o[0]._scrollWatchEnterThreshold,o.style.transform="",o.style.willChange="",o.removeClass("scroll-transition-fade below-viewport")),void 0!==o[0]._referenceScrollWatch&&(o[0]._referenceScrollWatch.destroy(),delete o[0]._referenceScrollWatch),void 0!==o[0]._reCalculateScrolMonitorOnTransitionEnd&&(o[0].removeEventListener("transitionend",o[0]._reCalculateScrolMonitorOnTransitionEnd),delete o[0]._reCalculateScrolMonitorOnTransitionEnd)}(g)}}n.setResponsiveImageSrcs(),n.vars.ticking=!1,n.vars.refresh_ticking=!1,"undefined"!=typeof scrollMonitor&&scrollMonitor.update(),Cargo.Event.trigger("elementresizer_update_complete",o)},setResponsiveImageSrcs:function(){var e=!1;_.each(this.options.targets,function(n){var o,a,r,s=n.container.width();for(r=0;r<n.children.length;r++)if(a=n.children[r],isNaN(a.actualWidth)||void 0===a.imageModel||"function"!=typeof a.imageModel.get)t&&a.element[0].setAttribute("src",a.element[0].getAttribute("data-src"));else if(t)if(a.imageModel.get("width")>3500){var l=a.imageModel.getImageWithOptions({w:3500});a.element[0].getAttribute("src")!==l.url&&a.element[0].setAttribute("src",l.url)}else a.element[0].setAttribute("src",a.element[0].getAttribute("data-src"));else{var d=!1;if(a.isInThumbnails)s=a.element[0].parentElement.offsetWidth,s=Math.max(.01*parseFloat(a.element[0].style.width)*s,s)||s,o=Math.floor(Math.min(250*Math.ceil(s/250),a.imageModel.get("width"))),d=!0;else if(a.isInGallery){var c=i(a.element[0],function(e){if(e&&e.nodeType===Node.ELEMENT_NODE)return e.classList.contains("gallery_card")});if(!c)continue;s=c.offsetWidth,o=Math.floor(Math.min(250*Math.ceil(s/250),a.imageModel.get("width"))),d=!0}else a.isInWallpaper?(s=a.element[0].parentElement.offsetWidth,o=Math.floor(Math.min(250*Math.ceil(s/250),a.imageModel.get("width"))),d=!0):a.isInColumns?(s=a.element[0].parentElement.offsetWidth,o=Math.floor(Math.min(250*Math.ceil(Math.max(a.actualWidth,s)/250),a.imageModel.get("width")))):o=Math.floor(Math.min(250*Math.ceil(a.actualWidth/250),a.imageModel.get("width")));if(0!=o)(l=a.imageModel.getImageWithOptions({w:o})).retina&&(d&&s/l.w>.51||a.actualWidth/l.w>.51)&&(l=a.imageModel.getImageWithOptions({w:o,q:94})),l.w>=0&&(l.w>a.lastSize||l.q>a.lastQ)&&(a.isInSlideshow&&!a.element[0].hasAttribute("src")?(a.element[0].hasAttribute("data-lazy")||(e=!0),a.element[0].hasAttribute("data-lazy")!==l.url&&a.element[0].setAttribute("data-lazy",l.url)):a.element[0]._scrollWatcher&&!a.isInWallpaper?a.element[0]._scrollWatcher.isInViewport?a.element[0].getAttribute("src")!==l.url&&a.element[0].setAttribute("src",l.url):a.element[0].getAttribute("src")!==l.url&&a.element[0].getAttribute("data-lazy-src")!==l.url&&a.element[0].setAttribute("data-lazy-src",l.url):a.element[0].getAttribute("src")!==l.url&&a.element[0].setAttribute("src",l.url),a.lastSize=l.w,a.lastQ=l.q,a.element[0]._cachedLastSize=l.w,a.element[0]._cachedLastQ=l.q)}},this),e&&Cargo.Event.trigger("slideshow-lazyload")},setLeftMargin:function(e,t,i){var n;n=e.isSoundCloudFrame?(t-e.element.width())/2:(t-e.actualWidth)/2,isNaN(n)||(e.prevLeftMargin!==n&&e.element.css("marginLeft",n),e.prevLeftMargin=n)}},o={options:n.options,init:n.init,refresh:n.refresh,update:n.update,requestTick:n.requestTick,requestRefreshTick:n.requestRefreshTick,setOptions:function(t){e.extend(n.options,t),!1!==n.options.forceMargin&&(n.options.forceHorizontalMargin=n.options.forceMargin,n.options.forceVerticalMargin=n.options.forceMargin),n.options.allowInit&&n.vars.initialized&&n.update()},targets:function(){return n.options.targets}};return e(function(){n.init()}),o}(jQuery),function(e,t){"use strict";this.PhotoSwipe=function(i,o,a,r){var s={features:null,bind:function(e,t,i,n){var o=(n?"remove":"add")+"EventListener";t=t.split(" ");for(var a=0;a<t.length;a++)t[a]&&e[o](t[a],i,!1)},isArray:function(e){return e instanceof Array},createEl:function(e,t){var i=document.createElement(t||"div");return e&&(i.className=e),i},getScrollY:function(){var i=e.pageYOffset;return i!==t?i:document.documentElement.scrollTop},unbind:function(e,t,i){s.bind(e,t,i,!0)},removeClass:function(e,t){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(e,t){s.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},hasClass:function(e,t){return e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},getChildByClass:function(e,t){for(var i=e.firstChild;i;){if(s.hasClass(i,t))return i;i=i.nextSibling}},arraySearch:function(e,t,i){for(var n=e.length;n--;)if(e[n][i]===t)return n;return-1},extend:function(e,t,i){for(var n in t)if(t.hasOwnProperty(n)){if(i&&e.hasOwnProperty(n))continue;e[n]=t[n]}},easing:{sine:{out:function(e){return Math.sin(e*(Math.PI/2))},inOut:function(e){return-(Math.cos(Math.PI*e)-1)/2}},cubic:{out:function(e){return--e*e*e+1}}},detectFeatures:function(){if(s.features)return s.features;var t=s.createEl(),i=t.style,n="",o={};if(o.oldIE=document.all&&!document.addEventListener,o.touch="ontouchstart"in e,e.requestAnimationFrame&&(o.raf=e.requestAnimationFrame,o.caf=e.cancelAnimationFrame),o.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled,!o.pointerEvent){var a=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var r=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);r&&r.length>0&&(r=parseInt(r[1],10))>=1&&r<8&&(o.isOldIOSPhone=!0)}var l=a.match(/Android\s([0-9\.]*)/),d=l?l[1]:0;(d=parseFloat(d))>=1&&(d<4.4&&(o.isOldAndroid=!0),o.androidVersion=d),o.isMobileOpera=/opera mini|opera mobi/i.test(a)}for(var c,h,u=["transform","perspective","animationName"],g=["","webkit","Moz","ms","O"],p=0;p<4;p++){n=g[p];for(var m=0;m<3;m++)c=u[m],h=n+(n?c.charAt(0).toUpperCase()+c.slice(1):c),!o[c]&&h in i&&(o[c]=h);n&&!o.raf&&(n=n.toLowerCase(),o.raf=e[n+"RequestAnimationFrame"],o.raf&&(o.caf=e[n+"CancelAnimationFrame"]||e[n+"CancelRequestAnimationFrame"]))}if(!o.raf){var f=0;o.raf=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-f)),o=e.setTimeout(function(){t(i+n)},n);return f=i+n,o},o.caf=function(e){clearTimeout(e)}}return o.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,s.features=o,o}};s.detectFeatures(),s.features.oldIE&&(s.bind=function(e,t,i,n){t=t.split(" ");for(var o,a=(n?"detach":"attach")+"Event",r=function(){i.handleEvent.call(i)},s=0;s<t.length;s++)if(o=t[s])if("object"==typeof i&&i.handleEvent){if(n){if(!i["oldIE"+o])return!1}else i["oldIE"+o]=r;e[a]("on"+o,i["oldIE"+o])}else e[a]("on"+o,i)});var l=this,d={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(e){return"A"===e.tagName},getDoubleTapZoom:function(e,t){return e?1:t.initialZoomLevel<.7?1:1.33},maxSpreadZoom:1.33,modal:!0,scaleMode:"fit"};s.extend(d,r);var c,h,u,g,p,m,f,v,b,y,_,w,C,S,k,x,E,I,T,A,M,P,O,L,D,N,$,V,H,R,G,F,B,z,q,W,j,U,K,Z,X,Y,J,Q,ee,te,ie,ne,oe,ae,re,se,le,de,ce,he,ue={x:0,y:0},ge={x:0,y:0,rotation:0},pe={x:0,y:0,rotation:0},me={},fe=0,ve={},be={x:0,y:0},ye=0,_e=!0,we=[],Ce={},Se=!1,ke=function(e,t){s.extend(l,t.publicMethods),we.push(e)},xe=function(e){var t=qt();return e>t-1?e-t:e<0?t+e:e},Ee={},Ie=function(e,t){return Ee[e]||(Ee[e]=[]),Ee[e].push(t)},Te=function(e){var t=Ee[e];if(t){var i=Array.prototype.slice.call(arguments);i.shift();for(var n=0;n<t.length;n++)t[n].apply(l,i)}},Ae=function(){return(new Date).getTime()},Me=function(e){de=e,l.bg.style.opacity=e*d.bgOpacity},Pe=function(e,t,i,n,o,a){(!Se||o&&o!==l.currItem)&&(n/=o?o.fitRatio:l.currItem.fitRatio),e[P]=w+t+"px, "+i+"px"+C+" scale("+n+") rotateZ("+a+"rad)"},Oe=function(e){oe&&(e&&(y>l.currItem.fitRatio?Se||(Qt(l.currItem,!1,!0),Se=!0):Se&&(Qt(l.currItem),Se=!1)),Pe(oe,pe.x,pe.y,y,null,pe.rotation))},Le=function(e){e.container&&Pe(e.container.style,e.initialPosition.x,e.initialPosition.y,e.initialZoomLevel,e,0)},De=function(e,t){t[P]=w+e+"px, 0px"+C},Ne=function(e,t){if(!d.loop&&t){var i=g+(be.x*fe-e)/be.x,n=Math.round(e-gt.x);(i<0&&n>0||i>=qt()-1&&n<0)&&(e=gt.x+n*d.mainScrollEndFriction)}gt.x=e,De(e,p)},$e=function(e,t){var i=pt[e]-ve[e];return ge[e]+ue[e]+i-i*(t/_)},Ve=function(e,t){e.x=t.x,e.y=t.y,t.id&&(e.id=t.id)},He=function(e){e.x=Math.round(e.x),e.y=Math.round(e.y)},Re=null,Ge=function(){Re&&(s.unbind(document,"mousemove",Ge),s.addClass(i,"pswp--has_mouse"),d.mouseUsed=!0,Te("mouseUsed")),Re=setTimeout(function(){Re=null},100)},Fe=function(e,t){var i=Zt(l.currItem,me,e);return t&&(ne=i),i},Be=function(e){return e||(e=l.currItem),e.initialZoomLevel},ze=function(e){return e||(e=l.currItem),e.w>0?d.maxSpreadZoom:1},qe=function(e,t,i,n){return n===l.currItem.initialZoomLevel?(i[e]=l.currItem.initialPosition[e],!0):(i[e]=$e(e,n),i[e]>t.min[e]?(i[e]=t.min[e],!0):i[e]<t.max[e]&&(i[e]=t.max[e],!0))},We=function(e){var t="";d.escKey&&27===e.keyCode?t="close":d.arrowKeys&&(37===e.keyCode?t="prev":39===e.keyCode&&(t="next")),t&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||(e.preventDefault?e.preventDefault():e.returnValue=!1,l[t]()))},je=function(e){e&&(Y||X||ae||j)&&(e.preventDefault(),e.stopPropagation())},Ue=function(){l.setScrollOffset(0,s.getScrollY())},Ke={},Ze=0,Xe=function(e){Ke[e]&&(Ke[e].raf&&N(Ke[e].raf),Ze--,delete Ke[e])},Ye=function(e){Ke[e]&&Xe(e),Ke[e]||(Ze++,Ke[e]={})},Je=function(){for(var e in Ke)Ke.hasOwnProperty(e)&&Xe(e)},Qe=function(e,t,i,n,o,a,r){var s,l=Ae();Ye(e);var d=function(){if(Ke[e]){if((s=Ae()-l)>=n)return Xe(e),a(i),void(r&&r());a((i-t)*o(s/n)+t),Ke[e].raf=D(d)}};d()},et={shout:Te,listen:Ie,viewportSize:me,options:d,isMainScrollAnimating:function(){return ae},getZoomLevel:function(){return y},getCurrentIndex:function(){return g},isDragging:function(){return K},isZooming:function(){return te},setScrollOffset:function(e,t){ve.x=e,R=ve.y=t,Te("updateScrollOffset",ve)},applyZoomPan:function(e,t,i,n){pe.x=t,pe.y=i,y=e,Oe(n)},init:function(){if(!c&&!h){var a;n("init",l),l.framework=s,l.template=i,l.bg=s.getChildByClass(i,"pswp__bg"),$=i.className,c=!0,G=s.detectFeatures(),D=G.raf,N=G.caf,P=G.transform,H=G.oldIE,l.scrollWrap=s.getChildByClass(i,"pswp__scroll-wrap"),l.container=s.getChildByClass(l.scrollWrap,"pswp__container"),p=l.container.style,l.itemHolders=x=[{el:l.container.children[0],wrap:0,index:-1},{el:l.container.children[1],wrap:0,index:-1},{el:l.container.children[2],wrap:0,index:-1}],x[0].el.style.display=x[2].el.style.display="none",function(){if(P){var e=G.perspective&&!L;return w="translate"+(e?"3d(":"("),void(C=G.perspective?", 0px)":")")}P="left",s.addClass(i,"pswp--ie"),De=function(e,t){t.left=e+"px"},Le=function(e){var t=e.fitRatio>1?1:e.fitRatio,i=e.container.style,n=t*e.w,o=t*e.h;i.width=n+"px",i.height=o+"px",i.left=e.initialPosition.x+"px",i.top=e.initialPosition.y+"px"},Oe=function(){if(oe){var e=oe,t=l.currItem,i=t.fitRatio>1?1:t.fitRatio,n=i*t.w,o=i*t.h;e.width=n+"px",e.height=o+"px",e.left=pe.x+"px",e.top=pe.y+"px"}}}(),b={resize:l.updateSize,orientationchange:function(){clearTimeout(F),F=setTimeout(function(){me.x!==l.scrollWrap.clientWidth&&l.updateSize()},500)},scroll:Ue,keydown:We,click:je};var r=G.isOldIOSPhone||G.isOldAndroid||G.isMobileOpera;for(G.animationName&&G.transform&&!r||(d.showAnimationDuration=d.hideAnimationDuration=0),a=0;a<we.length;a++)l["init"+we[a]]();if(o){var u=l.ui=new o(l,s);u.init()}Te("firstUpdate"),g=g||d.index||0,(isNaN(g)||g<0||g>=qt())&&(g=0),l.currItem=zt(g),(G.isOldIOSPhone||G.isOldAndroid)&&(_e=!1),i.setAttribute("aria-hidden","false"),d.modal&&(_e?i.style.position="fixed":(i.style.position="absolute",i.style.top=s.getScrollY()+"px")),R===t&&(Te("initialLayout"),R=V=s.getScrollY());var f="pswp--open ";for(d.mainClass&&(f+=d.mainClass+" "),d.showHideOpacity&&(f+="pswp--animate_opacity "),f+=L?"pswp--touch":"pswp--notouch",f+=G.animationName?" pswp--css_animation":"",f+=G.svg?" pswp--svg":"",s.addClass(i,f),l.updateSize(),m=-1,ye=null,a=0;a<3;a++)De((a+m)*be.x,x[a].el.style);H||s.bind(l.scrollWrap,v,l),Ie("initialZoomInEnd",function(){l.setContent(x[0],g-1),l.setContent(x[2],g+1),x[0].el.style.display=x[2].el.style.display="block",d.focus&&i.focus(),s.bind(document,"keydown",l),G.transform&&s.bind(l.scrollWrap,"click",l),d.mouseUsed||s.bind(document,"mousemove",Ge),s.bind(e,"resize scroll orientationchange",l),Te("bindEvents")}),l.setContent(x[1],g),l.updateCurrItem(),Te("afterInit"),n("after-init",l),_e||(S=setInterval(function(){Ze||K||te||y!==l.currItem.initialZoomLevel||l.updateSize()},1e3)),s.addClass(i,"pswp--visible")}},close:function(){c&&(c=!1,h=!0,Te("close"),n("closing",l),s.unbind(e,"resize scroll orientationchange",l),s.unbind(e,"scroll",b.scroll),s.unbind(document,"keydown",l),s.unbind(document,"mousemove",Ge),G.transform&&s.unbind(l.scrollWrap,"click",l),K&&s.unbind(e,f,l),clearTimeout(F),Te("unbindEvents"),Wt(l.currItem,null,!0,l.destroy))},destroy:function(){Te("destroy"),n("destroy",l),Rt&&clearTimeout(Rt),i.setAttribute("aria-hidden","true"),i.className=$,S&&clearInterval(S),s.unbind(l.scrollWrap,v,l),s.unbind(e,"scroll",l),vt(),Je(),Ee=null},panTo:function(e,t,i){i||(e>ne.min.x?e=ne.min.x:e<ne.max.x&&(e=ne.max.x),t>ne.min.y?t=ne.min.y:t<ne.max.y&&(t=ne.max.y)),pe.x=e,pe.y=t,Oe()},handleEvent:function(t){t=t||e.event,b[t.type]&&b[t.type](t)},goTo:function(e){var t=(e=xe(e))-g;ye=t,g=e,l.currItem=zt(g),fe-=t,Ne(be.x*fe),Je(),ae=!1,l.updateCurrItem()},next:function(){l.goTo(g+1)},prev:function(){l.goTo(g-1)},updateCurrZoomItem:function(e){if(e&&(Te("beforeChange",0),n("before-slide-change",l,0)),x[1].el.children.length){var t=x[1].el.children[0];oe=s.hasClass(t,"pswp__zoom-wrap")?t.style:null}else oe=null;ne=l.currItem.bounds,_=y=l.currItem.initialZoomLevel,pe.x=ne.center.x,pe.y=ne.center.y,e&&(Te("afterChange"),n("after-slide-change",l))},invalidateCurrItems:function(){k=!0;for(var e=0;e<3;e++)x[e].item&&(x[e].item.needsUpdate=!0)},updateCurrItem:function(e){if(0!==ye){var t,i=Math.abs(ye);if(!(e&&i<2)){l.currItem=zt(g),Se=!1,Te("beforeChange",ye);var o=ye;null===o&&(o=0),n("slide-change",l,o),i>=3&&(m+=ye+(ye>0?-3:3),i=3);for(var a=0;a<i;a++)ye>0?(t=x.shift(),x[2]=t,De((++m+2)*be.x,t.el.style),l.setContent(t,g-i+a+1+1)):(t=x.pop(),x.unshift(t),De(--m*be.x,t.el.style),l.setContent(t,g+i-a-1-1));if(oe&&1===Math.abs(ye)){var r=zt(E);r.initialZoomLevel!==y&&(Zt(r,me),Qt(r),Le(r))}ye=0,l.updateCurrZoomItem(),E=g,Te("afterChange")}}},updateSize:function(n){if(!_e&&d.modal){var o=s.getScrollY();if(R!==o&&(i.style.top=o+"px",R=o),!n&&Ce.x===e.innerWidth&&Ce.y===e.innerHeight)return;Ce.x=e.innerWidth,Ce.y=e.innerHeight,i.style.height=Ce.y+"px"}if(me.x=l.scrollWrap.clientWidth,me.y=l.scrollWrap.clientHeight,Ue(),be.x=me.x+Math.round(me.x*d.spacing),be.y=me.y,Ne(be.x*fe),Te("beforeResize"),m!==t){for(var a,r,c,h=0;h<3;h++)a=x[h],De((h+m)*be.x,a.el.style),c=g+h-1,d.loop&&qt()>2&&(c=xe(c)),(r=zt(c))&&(k||r.needsUpdate||!r.bounds)?(l.cleanSlide(r),l.setContent(a,c),1===h&&(l.currItem=r,l.updateCurrZoomItem(!0)),r.needsUpdate=!1):-1===a.index&&c>=0&&l.setContent(a,c),r&&r.container&&(Zt(r,me),Qt(r),Le(r));k=!1}_=y=l.currItem.initialZoomLevel,(ne=l.currItem.bounds)&&(pe.x=ne.center.x,pe.y=ne.center.y,Oe(!0)),Te("resize")},zoomTo:function(e,t,i,n,o){t&&(_=y,pt.x=Math.abs(t.x)-pe.x,pt.y=Math.abs(t.y)-pe.y,Ve(ge,pe));var a=Fe(e,!1),r={};qe("x",a,r,e),qe("y",a,r,e);var l=y,d={x:pe.x,y:pe.y};He(r);var c=function(t){1===t?(y=e,pe.x=r.x,pe.y=r.y):(y=(e-l)*t+l,pe.x=(r.x-d.x)*t+d.x,pe.y=(r.y-d.y)*t+d.y),o&&o(t),Oe(1===t)};i?Qe("customZoomTo",0,1,i,n||s.easing.sine.inOut,c):c(1)}},tt={},it={},nt={},ot={},at={},rt=[],st={},lt=[],dt={},ct=0,ht={x:0,y:0},ut=0,gt={x:0,y:0},pt={x:0,y:0},mt={x:0,y:0},ft=function(e,t){return dt.x=Math.abs(e.x-t.x),dt.y=Math.abs(e.y-t.y),Math.sqrt(dt.x*dt.x+dt.y*dt.y)},vt=function(){J&&(N(J),J=null)},bt=function(){K&&(J=D(bt),Ot())},yt=function(e,t){return!(!e||e===document)&&!(e.getAttribute("class")&&e.getAttribute("class").indexOf("pswp__scroll-wrap")>-1)&&(t(e)?e:yt(e.parentNode,t))},_t={},wt=function(e,t){return _t.prevent=!yt(e.target,d.isClickableElement),Te("preventDragEvent",e,t,_t),_t.prevent},Ct=function(e,t){return t.x=e.pageX,t.y=e.pageY,t.id=e.identifier,t},St=function(e,t,i){i.x=.5*(e.x+t.x),i.y=.5*(e.y+t.y)},kt=function(){var e=pe.y-l.currItem.initialPosition.y;return Math.min(1.2-Math.abs(e/(me.y/2)),1)},xt={},Et={},It=[],Tt=function(e){for(;It.length>0;)It.pop();return O?(he=0,rt.forEach(function(e){0===he?It[0]=e:1===he&&(It[1]=e),he++})):e.type.indexOf("touch")>-1?e.touches&&e.touches.length>0&&(It[0]=Ct(e.touches[0],xt),e.touches.length>1&&(It[1]=Ct(e.touches[1],Et))):(xt.x=e.pageX,xt.y=e.pageY,xt.id="",It[0]=xt),It},At=function(e,i){var n,o,a,r,s=pe[e]+i[e],c=i[e]>0,h=gt.x+i.x,u=gt.x-st.x;if(n=s>ne.min[e]||s<ne.max[e]?d.panEndFriction:1,s=pe[e]+i[e]*n,(d.allowPanToNext||y===l.currItem.initialZoomLevel)&&(oe?"h"!==re||"x"!==e||X||(c?(s>ne.min[e]&&(n=d.panEndFriction,ne.min[e],o=ne.min[e]-ge[e]),(o<=0||u<0)&&qt()>1?(r=h,u<0&&h>st.x&&(r=st.x)):ne.min.x!==ne.max.x&&(a=s)):(s<ne.max[e]&&(n=d.panEndFriction,ne.max[e],o=ge[e]-ne.max[e]),(o<=0||u>0)&&qt()>1?(r=h,u>0&&h<st.x&&(r=st.x)):ne.min.x!==ne.max.x&&(a=s))):r=h,"x"===e))return r!==t&&(Ne(r,!0),Q=r!==st.x),ne.min.x!==ne.max.x&&(a!==t?pe.x=a:Q||(pe.x+=i.x*n)),r!==t;ae||Q||y>l.currItem.fitRatio&&(pe[e]+=i[e]*n)},Mt=function(t){if(!("mousedown"===t.type&&t.button>0))if(Bt)t.preventDefault();else if(!U||"mousedown"!==t.type){if(wt(t,!0)&&t.preventDefault(),Te("pointerDown"),O){var i=s.arraySearch(rt,t.pointerId,"id");i<0&&(i=rt.length),rt[i]={x:t.pageX,y:t.pageY,id:t.pointerId}}var n=Tt(t),o=n.length;ee=null,Je(),K&&1!==o||(K=se=!0,s.bind(e,f,l),W=ce=le=j=Q=Y=Z=X=!1,re=null,Te("firstTouchStart",n),Ve(ge,pe),ue.x=ue.y=0,Ve(ot,n[0]),Ve(at,ot),st.x=be.x*fe,lt=[{x:ot.x,y:ot.y}],z=B=Ae(),Fe(y,!0),vt(),bt()),!te&&o>1&&!ae&&!Q&&(_=y,X=!1,te=Z=!0,ue.y=ue.x=0,Ve(ge,pe),Ve(tt,n[0]),Ve(it,n[1]),St(tt,it,mt),pt.x=Math.abs(mt.x)-pe.x,pt.y=Math.abs(mt.y)-pe.y,ie=ft(tt,it))}},Pt=function(e){if(e.preventDefault(),O){var t=s.arraySearch(rt,e.pointerId,"id");if(t>-1){var i=rt[t];i.x=e.pageX,i.y=e.pageY}}if(K){var n=Tt(e);if(re||Y||te)ee=n;else if(gt.x!==be.x*fe)re="h";else{var o=Math.abs(n[0].x-ot.x)-Math.abs(n[0].y-ot.y);Math.abs(o)>=10&&(re=o>0?"h":"v",ee=n)}}},Ot=function(){if(ee){var e=ee.length;if(0!==e)if(Ve(tt,ee[0]),nt.x=tt.x-ot.x,nt.y=tt.y-ot.y,te&&e>1){if(ot.x=tt.x,ot.y=tt.y,!nt.x&&!nt.y&&function(e,t){return e.x===t.x&&e.y===t.y}(ee[1],it))return;Ve(it,ee[1]),X||(X=!0,Te("zoomGestureStarted"));var t=ft(tt,it),i=Vt(t);i>l.currItem.initialZoomLevel+l.currItem.initialZoomLevel/15&&(ce=!0);var n=1,o=Be(),a=ze();if(i<o)if(d.pinchToClose&&!ce&&_<=l.currItem.initialZoomLevel){var r=o-i,s=1-r/(o/1.2);Me(s),Te("onPinchClose",s),le=!0}else(n=(o-i)/o)>1&&(n=1),i=o-n*(o/3);else i>a&&((n=(i-a)/(6*o))>1&&(n=1),i=a+n*o);n<0&&(n=0),St(tt,it,ht),ue.x+=ht.x-mt.x,ue.y+=ht.y-mt.y,Ve(mt,ht),pe.x=$e("x",i),pe.y=$e("y",i),W=i>y,y=i,Oe()}else{if(!re)return;if(se&&(se=!1,Math.abs(nt.x)>=10&&(nt.x-=ee[0].x-at.x),Math.abs(nt.y)>=10&&(nt.y-=ee[0].y-at.y)),ot.x=tt.x,ot.y=tt.y,0===nt.x&&0===nt.y)return;if("v"===re&&d.closeOnVerticalDrag&&"fit"===d.scaleMode&&y===l.currItem.initialZoomLevel){ue.y+=nt.y,pe.y+=nt.y;var c=kt();return j=!0,Te("onVerticalDrag",c),Me(c),void Oe()}!function(e,t,i){if(e-z>50){var n=lt.length>2?lt.shift():{};n.x=t,n.y=i,lt.push(n),z=e}}(Ae(),tt.x,tt.y),Y=!0,ne=l.currItem.bounds;var h=At("x",nt);h||(At("y",nt),He(pe),Oe())}}},Lt=function(t){if(G.isOldAndroid){if(U&&"mouseup"===t.type)return;t.type.indexOf("touch")>-1&&(clearTimeout(U),U=setTimeout(function(){U=0},600))}var i;if(Te("pointerUp"),wt(t,!1)&&t.preventDefault(),O){var n=s.arraySearch(rt,t.pointerId,"id");n>-1&&(i=rt.splice(n,1)[0],navigator.pointerEnabled?i.type=t.pointerType||"mouse":(i.type={4:"mouse",2:"touch",3:"pen"}[t.pointerType],i.type||(i.type=t.pointerType||"mouse")))}var o,a=Tt(t),r=a.length;if("mouseup"===t.type&&(r=0),2===r)return ee=null,!0;1===r&&Ve(at,a[0]),0!==r||re||ae||(i||("mouseup"===t.type?i={x:t.pageX,y:t.pageY,type:"mouse"}:t.changedTouches&&t.changedTouches[0]&&(i={x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY,type:"touch"})),Te("touchRelease",t,i));var c=-1;if(0===r&&(K=!1,s.unbind(e,f,l),vt(),te?c=0:-1!==ut&&(c=Ae()-ut)),ut=1===r?Ae():-1,o=-1!==c&&c<150?"zoom":"swipe",te&&r<2&&(te=!1,1===r&&(o="zoomPointerUp"),Te("zoomGestureEnded")),ee=null,Y||X||ae||j)if(Je(),q||(q=Dt()),q.calculateSwipeSpeed("x"),j){var h=kt();if(h<d.verticalDragRange)l.close();else{var u=pe.y,g=de;Qe("verticalDrag",0,1,300,s.easing.cubic.out,function(e){pe.y=(l.currItem.initialPosition.y-u)*e+u,Me((1-g)*e+g),Oe()}),Te("onVerticalDrag",1)}}else{if((Q||ae)&&0===r){var p=$t(o,q);if(p)return;o="zoomPointerUp"}ae||("swipe"===o?!Q&&y>l.currItem.fitRatio&&Nt(q):Ht())}},Dt=function(){var e,i,n={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(t){lt.length>1?(e=Ae()-z+50,i=lt[lt.length-2][t]):(e=Ae()-B,i=at[t]),n.lastFlickOffset[t]=ot[t]-i,n.lastFlickDist[t]=Math.abs(n.lastFlickOffset[t]),n.lastFlickDist[t]>20?n.lastFlickSpeed[t]=n.lastFlickOffset[t]/e:n.lastFlickSpeed[t]=0,Math.abs(n.lastFlickSpeed[t])<.1&&(n.lastFlickSpeed[t]=0),n.slowDownRatio[t]=.95,n.slowDownRatioReverse[t]=1-n.slowDownRatio[t],n.speedDecelerationRatio[t]=1},calculateOverBoundsAnimOffset:function(e,i){n.backAnimStarted[e]||(pe[e]>ne.min[e]?n.backAnimDestination[e]=ne.min[e]:pe[e]<ne.max[e]&&(n.backAnimDestination[e]=ne.max[e]),n.backAnimDestination[e]!==t&&(n.slowDownRatio[e]=.7,n.slowDownRatioReverse[e]=1-n.slowDownRatio[e],n.speedDecelerationRatioAbs[e]<.05&&(n.lastFlickSpeed[e]=0,n.backAnimStarted[e]=!0,Qe("bounceZoomPan"+e,pe[e],n.backAnimDestination[e],i||300,s.easing.sine.out,function(t){pe[e]=t,Oe()}))))},calculateAnimOffset:function(e){n.backAnimStarted[e]||(n.speedDecelerationRatio[e]=n.speedDecelerationRatio[e]*(n.slowDownRatio[e]+n.slowDownRatioReverse[e]-n.slowDownRatioReverse[e]*n.timeDiff/10),n.speedDecelerationRatioAbs[e]=Math.abs(n.lastFlickSpeed[e]*n.speedDecelerationRatio[e]),n.distanceOffset[e]=n.lastFlickSpeed[e]*n.speedDecelerationRatio[e]*n.timeDiff,pe[e]+=n.distanceOffset[e])},panAnimLoop:function(){if(Ke.zoomPan&&(Ke.zoomPan.raf=D(n.panAnimLoop),n.now=Ae(),n.timeDiff=n.now-n.lastNow,n.lastNow=n.now,n.calculateAnimOffset("x"),n.calculateAnimOffset("y"),Oe(),n.calculateOverBoundsAnimOffset("x"),n.calculateOverBoundsAnimOffset("y"),n.speedDecelerationRatioAbs.x<.05&&n.speedDecelerationRatioAbs.y<.05))return pe.x=Math.round(pe.x),pe.y=Math.round(pe.y),Oe(),void Xe("zoomPan")}};return n},Nt=function(e){if(e.calculateSwipeSpeed("y"),ne=l.currItem.bounds,e.backAnimDestination={},e.backAnimStarted={},Math.abs(e.lastFlickSpeed.x)<=.05&&Math.abs(e.lastFlickSpeed.y)<=.05)return e.speedDecelerationRatioAbs.x=e.speedDecelerationRatioAbs.y=0,e.calculateOverBoundsAnimOffset("x"),e.calculateOverBoundsAnimOffset("y"),!0;Ye("zoomPan"),e.lastNow=Ae(),e.panAnimLoop()},$t=function(e,t){var i,n,o;if(ae||(ct=g),"swipe"===e){var a=ot.x-at.x,r=t.lastFlickDist.x<10;a>30&&(r||t.lastFlickOffset.x>20)?n=-1:a<-30&&(r||t.lastFlickOffset.x<-20)&&(n=1)}n&&((g+=n)<0?(g=d.loop?qt()-1:0,o=!0):g>=qt()&&(g=d.loop?0:qt()-1,o=!0),o&&!d.loop||(ye+=n,fe-=n,i=!0));var c,h=be.x*fe,u=Math.abs(h-gt.x);return i||h>gt.x==t.lastFlickSpeed.x>0?(c=Math.abs(t.lastFlickSpeed.x)>0?u/Math.abs(t.lastFlickSpeed.x):333,c=Math.min(c,400),c=Math.max(c,250)):c=333,ct===g&&(i=!1),ae=!0,Te("mainScrollAnimStart"),Qe("mainScroll",gt.x,h,c,s.easing.cubic.out,Ne,function(){Je(),ae=!1,ct=-1,(i||ct!==g)&&l.updateCurrItem(),Te("mainScrollAnimComplete")}),i&&l.updateCurrItem(!0),i},Vt=function(e){return 1/ie*e*_},Ht=function(){var e=y,t=Be(),i=ze();y<t?e=t:y>i&&(e=i);var n,o=de;return le&&!W&&!ce&&y<t?(l.close(),!0):(le&&(n=function(e){Me((1-o)*e+o)}),l.zoomTo(e,0,200,s.easing.cubic.out,n),!0)};ke("Gestures",{publicMethods:{initGestures:function(){var e=function(e,t,i,n,o){I=e+t,T=e+i,A=e+n,M=o?e+o:""};(O=G.pointerEvent)&&G.touch&&(G.touch=!1),O?navigator.pointerEnabled?e("pointer","down","move","up","cancel"):e("MSPointer","Down","Move","Up","Cancel"):G.touch?(e("touch","start","move","end","cancel"),L=!0):e("mouse","down","move","up"),f=T+" "+A+" "+M,v=I,O&&!L&&(L=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),l.likelyTouchDevice=L,b[I]=Mt,b[T]=Pt,b[A]=Lt,M&&(b[M]=b[A]),G.touch&&(v+=" mousedown",f+=" mousemove mouseup",b.mousedown=b[I],b.mousemove=b[T],b.mouseup=b[A]),L||(d.allowPanToNext=!1)}}});var Rt,Gt,Ft,Bt,zt,qt,Wt=function(e,n,o,a){var r;Rt&&clearTimeout(Rt),Bt=!0,Ft=!0,e.initialLayout?(r=e.initialLayout,e.initialLayout=null):r=d.getThumbBoundsFn&&d.getThumbBoundsFn(g);var c,h,p=o?d.hideAnimationDuration:d.showAnimationDuration,m=function(){Xe("initialZoom"),o?(l.template.removeAttribute("style"),l.bg.removeAttribute("style")):(Me(1),n&&(n.style.display="block"),s.addClass(i,"pswp--animated-in"),Te("initialZoom"+(o?"OutEnd":"InEnd"))),a&&a(),Bt=!1};if(!p||!r||r.x===t)return Te("initialZoom"+(o?"Out":"In")),y=e.initialZoomLevel,Ve(pe,e.initialPosition),Oe(),i.style.opacity=o?0:1,Me(1),void(p?setTimeout(function(){m()},p):m());c=u,h=!l.currItem.src||l.currItem.loadError||d.showHideOpacity,e.miniImg&&(e.miniImg.style.webkitBackfaceVisibility="hidden"),o||(y=r.w/e.w,pe.rotation=r.transform.rotation,pe.x=r.x,pe.y=r.y-V,l[h?"template":"bg"].style.opacity=.001,Oe(),pe.rotation=0),Ye("initialZoom"),o&&!c&&s.removeClass(i,"pswp--animated-in"),h&&(o?s[(c?"remove":"add")+"Class"](i,"pswp--animate_opacity"):setTimeout(function(){s.addClass(i,"pswp--animate_opacity")},30)),Rt=setTimeout(function(){if(Te("initialZoom"+(o?"Out":"In")),o){var t=r.w/e.w,n={x:pe.x,y:pe.y,rotation:0},a=y,l=de,d=function(e){1===e?(y=t,pe.x=r.x,pe.y=r.y-R,pe.rotation=r.transform.rotation):(y=(t-a)*e+a,pe.x=(r.x-n.x)*e+n.x,pe.y=(r.y-R-n.y)*e+n.y,pe.rotation=(r.transform.rotation-n.rotation)*e+n.rotation),Oe(),h?i.style.opacity=1-e:Me(l-e*l)};c?Qe("initialZoom",0,1,p,s.easing.cubic.out,d,m):(d(1),Rt=setTimeout(m,p+20))}else y=e.initialZoomLevel,Ve(pe,e.initialPosition),Oe(),Me(1),h?i.style.opacity=1:Me(1),Rt=setTimeout(m,p+20)},o?25:90)},jt={},Ut=[],Kt={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return Gt.length}},Zt=function(e,t,i){if(e.src&&!e.loadError){var n=!i;if(n&&(e.vGap||(e.vGap={top:0,bottom:0}),e.hGap||(e.hGap={left:0,right:0}),Te("parseVerticalMargin",e)),jt.x=t.x-e.hGap.left-e.hGap.right,jt.y=t.y-e.vGap.top-e.vGap.bottom,n){var o=jt.x/e.w,a=jt.y/e.h;e.fitRatio=o<a?o:a;var r=d.scaleMode;"orig"===r?i=1:"fit"===r&&(i=e.fitRatio),i>1&&(i=1),e.initialZoomLevel=i,e.bounds||(e.bounds={center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}})}if(!i)return;return function(e,t,i){var n=e.bounds;n.center.x=Math.round((jt.x-t)/2)+e.hGap.left,n.center.y=Math.round((jt.y-i)/2)+e.vGap.top,n.max.x=t>jt.x?Math.round(jt.x-t)+e.hGap.left:n.center.x,n.max.y=i>jt.y?Math.round(jt.y-i)+e.vGap.top:n.center.y,n.min.x=t>jt.x?e.hGap.left:n.center.x,n.min.y=i>jt.y?e.vGap.top:n.center.y}(e,e.w*i,e.h*i),n&&i===e.initialZoomLevel&&(e.initialPosition=e.bounds.center),e.bounds}return e.w=e.h=0,e.initialZoomLevel=e.fitRatio=1,e.bounds={center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}},e.initialPosition=e.bounds.center,e.bounds},Xt=function(e,t,i,n,o,a){t.loadError||n&&(t.imageAppended=!0,Qt(t,n,t===l.currItem&&Se),i.appendChild(n),a&&setTimeout(function(){t&&t.loaded&&t.placeholder&&(t.placeholder.style.display="none",t.placeholder=null)},500))},Yt=function(e){e.loading=!0,e.loaded=!1;var t=e.img=s.createEl("pswp__img","img"),i=function(){e.loading=!1,e.loaded=!0,e.loadComplete?e.loadComplete(e):e.img=null,t.onload=t.onerror=null,t=null};return t.onload=i,t.onerror=function(){e.loadError=!0,i()},t.src=e.src,t},Jt=function(e,t){if(e.src&&e.loadError&&e.container)return t&&(e.container.innerHTML=""),e.container.innerHTML=d.errorMsg.replace("%url%",e.src),!0},Qt=function(e,t,i){if(e.src){t||(t=e.container.lastChild);var n=i?e.w:Math.round(e.w*e.fitRatio),o=i?e.h:Math.round(e.h*e.fitRatio);e.placeholder&&!e.loaded&&(e.placeholder.style.width=n+"px",e.placeholder.style.height=o+"px"),t.style.width=n+"px",t.style.height=o+"px"}},ei=function(){if(Ut.length){for(var e,t=0;t<Ut.length;t++)(e=Ut[t]).holder.index===e.index&&Xt(e.index,e.item,e.baseDiv,e.img,0,e.clearPlaceholder);Ut=[]}};ke("Controller",{publicMethods:{lazyLoadItem:function(e){e=xe(e);var t=zt(e);t&&(!t.loaded&&!t.loading||k)&&(Te("gettingData",e,t),t.src&&Yt(t))},initController:function(){s.extend(d,Kt,!0),l.items=Gt=a,zt=l.getItemAt,qt=d.getNumItemsFn,d.loop,qt()<3&&(d.loop=!1),Ie("beforeChange",function(e){var t,i=d.preload,n=null===e||e>=0,o=Math.min(i[0],qt()),a=Math.min(i[1],qt());for(t=1;t<=(n?a:o);t++)l.lazyLoadItem(g+t);for(t=1;t<=(n?o:a);t++)l.lazyLoadItem(g-t)}),Ie("initialLayout",function(){l.currItem.initialLayout=d.getThumbBoundsFn&&d.getThumbBoundsFn(g)}),Ie("mainScrollAnimComplete",ei),Ie("initialZoomInEnd",ei),Ie("destroy",function(){for(var e,t=0;t<Gt.length;t++)(e=Gt[t]).container&&(e.container=null),e.placeholder&&(e.placeholder=null),e.img&&(e.img=null),e.preloader&&(e.preloader=null),e.loadError&&(e.loaded=e.loadError=!1);Ut=null})},getItemAt:function(e){return e>=0&&Gt[e]!==t&&Gt[e]},allowProgressiveImg:function(){return d.forceProgressiveLoading||!L||d.mouseUsed||screen.width>1200},setContent:function(e,t){d.loop&&(t=xe(t));var i=l.getItemAt(e.index);i&&(i.container=null);var n,o=l.getItemAt(t);if(o){Te("gettingData",t,o),e.index=t,e.item=o;var a=o.container=s.createEl("pswp__zoom-wrap");if(!o.src&&o.html&&(o.html.tagName?a.appendChild(o.html):a.innerHTML=o.html),Jt(o),Zt(o,me),!o.src||o.loadError||o.loaded)o.src&&!o.loadError&&((n=s.createEl("pswp__img","img")).style.opacity=1,n.src=o.src,Qt(o,n),Xt(0,o,a,n));else{if(o.loadComplete=function(i){if(c){if(e&&e.index===t){if(Jt(i,!0))return i.loadComplete=i.img=null,Zt(i,me),Le(i),void(e.index===g&&l.updateCurrZoomItem());i.imageAppended?!Bt&&i.placeholder&&(i.placeholder.style.display="none",i.placeholder=null):G.transform&&(ae||Bt)?Ut.push({item:i,baseDiv:a,img:i.img,index:t,holder:e,clearPlaceholder:!0}):Xt(0,i,a,i.img,0,!0)}i.loadComplete=null,i.img=null,Te("imageLoadComplete",t,i)}},s.features.transform){var r="pswp__img pswp__img--placeholder";r+=o.msrc?"":" pswp__img--placeholder--blank";var h=s.createEl(r,o.msrc?"img":"");o.msrc&&(h.src=o.msrc),Qt(o,h),a.appendChild(h),o.placeholder=h}o.loading||Yt(o),l.allowProgressiveImg()&&(!Ft&&G.transform?Ut.push({item:o,baseDiv:a,img:o.img,index:t,holder:e}):Xt(0,o,a,o.img,0,!0))}Ft||t!==g?Le(o):(oe=a.style,Wt(o,n||o.img)),e.el.innerHTML="",e.el.appendChild(a)}else e.el.innerHTML=""},cleanSlide:function(e){e.img&&(e.img.onload=e.img.onerror=null),e.loaded=e.loading=e.img=e.imageAppended=!1}}});var ti,ii,ni={},oi=function(e,t,i){var n=document.createEvent("CustomEvent"),o={origEvent:e,target:e.target,releasePoint:t,pointerType:i||"touch"};n.initCustomEvent("pswpTap",!0,!0,o),e.target.dispatchEvent(n)};ke("Tap",{publicMethods:{initTap:function(){Ie("firstTouchStart",l.onTapStart),Ie("touchRelease",l.onTapRelease),Ie("destroy",function(){ni={},ti=null})},onTapStart:function(e){e.length>1&&(clearTimeout(ti),ti=null)},onTapRelease:function(e,t){var i,n;if(t&&!Y&&!Z&&!Ze){var o=t;if(ti&&(clearTimeout(ti),ti=null,i=o,n=ni,Math.abs(i.x-n.x)<25&&Math.abs(i.y-n.y)<25))return void Te("doubleTap",o);if("mouse"===t.type)return void oi(e,t,"mouse");var a=e.target.tagName.toUpperCase();if("BUTTON"===a||s.hasClass(e.target,"pswp__single-tap"))return void oi(e,t);Ve(ni,o),ti=setTimeout(function(){oi(e,t),ti=null},300)}}}}),ke("DesktopZoom",{publicMethods:{initDesktopZoom:function(){H||(L?Ie("mouseUsed",function(){l.setupDesktopZoom()}):l.setupDesktopZoom(!0))},setupDesktopZoom:function(e){ii={};var t="wheel mousewheel DOMMouseScroll";Ie("bindEvents",function(){s.bind(i,t,l.handleMouseWheel)}),Ie("unbindEvents",function(){ii&&s.unbind(i,t,l.handleMouseWheel)}),l.mouseZoomedIn=!1;var n,o=function(){l.mouseZoomedIn&&(s.removeClass(i,"pswp--zoomed-in"),l.mouseZoomedIn=!1),y<1?s.addClass(i,"pswp--zoom-allowed"):s.removeClass(i,"pswp--zoom-allowed"),a()},a=function(){n&&(s.removeClass(i,"pswp--dragging"),n=!1)};Ie("resize",o),Ie("afterChange",o),Ie("pointerDown",function(){l.mouseZoomedIn&&(n=!0,s.addClass(i,"pswp--dragging"))}),Ie("pointerUp",a),e||o()},handleMouseWheel:function(e){if(y<=l.currItem.fitRatio)return d.modal&&(!d.closeOnScroll||Ze||K?e.preventDefault():P&&Math.abs(e.deltaY)>2&&(u=!0,l.close())),!0;if(e.stopPropagation(),ii.x=0,"deltaX"in e)1===e.deltaMode?(ii.x=18*e.deltaX,ii.y=18*e.deltaY):(ii.x=e.deltaX,ii.y=e.deltaY);else if("wheelDelta"in e)e.wheelDeltaX&&(ii.x=-.16*e.wheelDeltaX),e.wheelDeltaY?ii.y=-.16*e.wheelDeltaY:ii.y=-.16*e.wheelDelta;else{if(!("detail"in e))return;ii.y=e.detail}Fe(y,!0);var t=pe.x-ii.x,i=pe.y-ii.y;(d.modal||t<=ne.min.x&&t>=ne.max.x&&i<=ne.min.y&&i>=ne.max.y)&&e.preventDefault(),l.panTo(t,i)},toggleDesktopZoom:function(e){e=e||{x:me.x/2+ve.x,y:me.y/2+ve.y};var t=d.getDoubleTapZoom(!0,l.currItem),n=y===t;l.mouseZoomedIn=!n,l.zoomTo(n?l.currItem.initialZoomLevel:t,e,333),s[(n?"remove":"add")+"Class"](i,"pswp--zoomed-in")}}}),s.extend(l,et)},this.template='<div class="pswp image-zoom-navigation" tabindex="-1" role="dialog" aria-hidden="true"> \t\x3c!-- Background of PhotoSwipe. \t\t It\'s a separate element as animating opacity is faster than rgba(). --\x3e \t<div class="pswp__bg image-zoom-background"></div> \t\x3c!-- Slides wrapper with overflow:hidden. --\x3e \t<div class="pswp__scroll-wrap"> \t\t\x3c!-- Container that holds slides. \t\t\tPhotoSwipe keeps only 3 of them in the DOM to save memory.\t\t\tDon\'t modify these 3 pswp__item elements, data is added later on. --\x3e \t\t<div class="pswp__container"> \t\t\t<div class="pswp__item"></div> \t\t\t<div class="pswp__item"></div> \t\t\t<div class="pswp__item"></div> \t\t</div> \t\t<div class="pswp__ui pswp__ui--hidden pswp__custom_nav"> \t\t\t<div class="pswp__group pswp__group-prev"> \t\t\t\t<div class="pswp__button pswp__button-prev"> \t\t\t\t\t<svg version="1.1" class="left-arrow" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t\t\t\t\t\t viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve">\t\t\t\t\t\t\t<path class="shape-outline outer-color" d="M8.0008001,17.2999992c-0.4000001,0.3999996-0.4000001,1,0,1.3999996l15.7991991,15.7992001\t\t\t\t\t\t\t\tc0.3999996,0.4000015,1,0.4000015,1.3999996,0l2.6992016-2.6991997c0.3999996-0.3999996,0.3999996-1,0-1.3999996\t\t\t\t\t\t\t\tL16.2992001,18.7000008c-0.4000006-0.3999996-0.4000006-1,0-1.3999996L27.8992004,5.6999998\t\t\t\t\t\t\t\tc0.3999996-0.4000001,0.3999996-1,0-1.4000001l-2.6992016-2.6992002c-0.3999996-0.4-1-0.4-1.3999996,0L8.0008001,17.2999992z"/>\t\t\t\t\t\t\t<path class="shape-shape inner-color" d="M9.6999998,17.6000004c-0.1999998,0.2000008-0.1999998,0.5,0,0.7000008l14.500001,14.5000019\t\t\t\t\t\t\t\tc0.2000008,0.2000008,0.5,0.2000008,0.7000008,0l1.3999996-1.3999996c0.2000008-0.2000008,0.2000008-0.5,0-0.7000008\t\t\t\t\t\t\t\tL13.8999996,18.3999996c-0.1999998-0.2000008-0.1999998-0.5,0-0.7000008L26.2999992,5.3000002\t\t\t\t\t\t\t\tc0.2000008-0.1999998,0.2000008-0.5,0-0.6999998l-1.3999996-1.4000001c-0.2000008-0.2-0.5-0.2-0.7000008,0L9.6999998,17.6000004z"/>\t\t\t\t\t</svg>\t\t\t\t</div> \t\t\t</div>\t\t\t<div class="pswp__group pswp__group-next"> \t\t\t\t<div class="pswp__button pswp__button-next"> \t\t\t\t\t<svg version="1.1" class="right-arrow" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t\t\t\t\t\t viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve">\t\t\t\t\t\t\t<path class="shape-outline outer-color" d="M8.0008001,17.2999992c-0.4000001,0.3999996-0.4000001,1,0,1.3999996l15.7991991,15.7992001\t\t\t\t\t\t\t\tc0.3999996,0.4000015,1,0.4000015,1.3999996,0l2.6992016-2.6991997c0.3999996-0.3999996,0.3999996-1,0-1.3999996\t\t\t\t\t\t\t\tL16.2992001,18.7000008c-0.4000006-0.3999996-0.4000006-1,0-1.3999996L27.8992004,5.6999998\t\t\t\t\t\t\t\tc0.3999996-0.4000001,0.3999996-1,0-1.4000001l-2.6992016-2.6992002c-0.3999996-0.4-1-0.4-1.3999996,0L8.0008001,17.2999992z"/>\t\t\t\t\t\t\t<path class="shape-shape inner-color" d="M9.6999998,17.6000004c-0.1999998,0.2000008-0.1999998,0.5,0,0.7000008l14.500001,14.5000019\t\t\t\t\t\t\t\tc0.2000008,0.2000008,0.5,0.2000008,0.7000008,0l1.3999996-1.3999996c0.2000008-0.2000008,0.2000008-0.5,0-0.7000008\t\t\t\t\t\t\t\tL13.8999996,18.3999996c-0.1999998-0.2000008-0.1999998-0.5,0-0.7000008L26.2999992,5.3000002\t\t\t\t\t\t\t\tc0.2000008-0.1999998,0.2000008-0.5,0-0.6999998l-1.3999996-1.4000001c-0.2000008-0.2-0.5-0.2-0.7000008,0L9.6999998,17.6000004z"/>\t\t\t\t\t</svg>\t\t\t\t</div> \t\t\t</div> \t\t\t<div class="pswp__group pswp__group-close"> \t\t\t\t<div class="pswp__button pswp__button-close"> \t\t\t\t\t<svg class="close-button" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\t\t\t\t\t\t viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve">\t\t\t\t\t\t\t<path class="shape-outline outer-color" d="M30.4992,9.7l-8,8c-0.2,0.2-0.2,0.5,0,0.7l8.1,8c0.4,0.4,0.4,1,0,1.4L27.9,30.4992c-0.4,0.4-1,0.4-1.4,0l-8-8\t\t\t\t\t\t\t\tc-0.2-0.2-0.5-0.2-0.7,0l-8.2,8c-0.4,0.4-1,0.4-1.4,0L5.5008,27.8c-0.4-0.4-0.4-1,0-1.4l8.1-8.1c0.2-0.2,0.1-0.5,0-0.7l-8-8\t\t\t\t\t\t\t\tc-0.4-0.4-0.4-1,0-1.4L8.3,5.5008c0.4-0.4,1-0.4,1.4,0l0,0l8.1,8.1c0.2,0.2,0.5,0.1,0.7,0l8-8c0.4-0.4,1-0.4,1.4,0L30.5992,8.3\t\t\t\t\t\t\t\tC30.8992,8.6,30.8992,9.3,30.4992,9.7L30.4992,9.7z"/>\t\t\t\t\t\t\t<path class="shape-shape inner-color" d="M28.8,26.7L28.8,26.7L28.8,26.7l-8.3-8.3c-0.2-0.2-0.2-0.5,0-0.7l8.3-8.4c0.2-0.2,0.2-0.5,0-0.7l-1.4-1.4l0,0\t\t\t\t\t\t\t\tc-0.2-0.2-0.5-0.2-0.7,0l-8.3,8.3c-0.2,0.2-0.5,0.2-0.7,0L9.3,7.2l0,0l0,0C9.1,7,8.8,7,8.6,7.2L7.2,8.6C7,8.8,7,9.1,7.2,9.3\t\t\t\t\t\t\t\tl8.4,8.4c0.2,0.2,0.2,0.5,0,0.7l-8.4,8.3c-0.2,0.2-0.2,0.5,0,0.7l1.4,1.4l0,0c0.2,0.2,0.5,0.2,0.7,0l8.4-8.4c0.2-0.2,0.5-0.1,0.7,0\t\t\t\t\t\t\t\tl8.4,8.4c0.2,0.2,0.5,0.2,0.7,0l1.4-1.4C29,27.2,29,26.9,28.8,26.7z"/>\t\t\t\t\t</svg>\t\t\t\t</div> \t\t\t</div>\t\t</div> \t</div><div id="freshbox" style="display: none; width: 0; height: 0;">\x3c!-- legacy support --\x3e</div> </div>';var i=function(){var e=document.createElement("div");for(e.innerHTML=this.template;e.childNodes.length>0;)document.body.appendChild(e.childNodes[0]);e=null}.bind(this),n=function(){};this.setEventProxy=function(e){"function"==typeof e&&(n=e)},this.isActive=!1,this.activeGallery=t,this.openImageArray=function(n,o,a){var r=function(e,t,i,n,o,a,r){var s=Math.acos,l=Math.atan,d=Math.sqrt,c=Math.PI,h={x:o,y:a},u=0,g={x:1,y:1},p={x:0,y:0},m=e*n-t*i;if(r)e?(p={x:l(i/e),y:l(t/e)},g={x:e,y:m/e}):t?(u=.5*c,g={x:t,y:m/t},p.x=l(n/t)):(g={x:i,y:n},p.x=.25*c);else if(e||t){var f=d(e*e+t*t);u=t>0?s(e/f):-s(e/f),g={x:f,y:m/f},p.x=l((e*i+t*n)/(f*f))}else if(i||n){var v=d(i*i+n*n);u=.5*c-(n>0?s(-i/v):-s(i/v)),g={x:m/v,y:v},p.y=l((e*i+t*n)/(v*v))}else g={x:0,y:0};return{scale:g,translate:h,rotation:u,skew:p}};if(n!==t&&this.activeGallery===t){var s=document.querySelectorAll(".pswp")[0];s===t&&(i(),s=document.querySelectorAll(".pswp")[0]);var l=[],d=0;if(Array.prototype.forEach.call(n,function(e){if(e.hasAttribute("data-src")&&(e.hasAttribute("width_o")||e.hasAttribute("width"))&&(e.hasAttribute("height_o")||e.hasAttribute("height"))){e===o&&(d=l.length);var i=e.getAttribute("data-src"),n=e.hasAttribute("width_o")?e.getAttribute("width_o"):e.getAttribute("width"),a=e.hasAttribute("height_o")?e.getAttribute("height_o"):e.getAttribute("height");e._lightboxSrc!==t&&(i=e._lightboxSrc),e._lightboxWidth!==t&&(n=e._lightboxWidth),e._lightboxHeight!==t&&(a=e._lightboxHeight),l.push({src:i,msrc:e.getAttribute("src"),w:n,h:a,el:e})}}),0==l.length)return!1;var c=this,h={index:d,maxSpreadZoom:1,getThumbBoundsFn:function(i){if(a&&a.preventAnimation)return!1;if(c.activeGallery==t)return!1;var n=c.activeGallery.getItemAt(i);if(n==t||n.el==t||"function"!=typeof n.el.getBoundingClientRect)return!1;var o=n.el,s=!1;if(n.el.hasAttribute("data-gallery-uid")){var l=$(n.el).closest(".gallery_card");l.length>0&&(s=!0,o=l[0])}var d=e.getComputedStyle(o).getPropertyValue("transform"),h=o.getBoundingClientRect();if(0===h.width)return!1;o.style.transformOrigin="left top";var u,g=o.getBoundingClientRect(),p=(n.el.getBoundingClientRect(),[]),m=d.indexOf("matrix(")>-1,f=d.indexOf("matrix3d(")>-1,v=m||f;if(m){p=d.replace(")","").replace("matrix(","").split(",");for(var b=0;b<p.length;b++)p[b]=parseFloat(p[b]);u=r(p[0],p[1],p[2],p[3],p[4],p[5],!1)}else if(f){p=d.replace(")","").replace("matrix3d(","").split(",");for(b=0;b<p.length;b++)p[b]=parseFloat(p[b]);u=r(p[0],p[1],p[4],p[5],p[12],p[13],!1)}else u={rotation:0,scale:{x:1,y:1},skew:{x:0,y:0},translate:{x:0,y:0}};var y,_=0,w=0,C=0,S=0;if(v){var k=o.style.transform;if(o.style.transformOrigin="",o.style.transform="",y=o.getBoundingClientRect(),C=g.left-y.left,S=g.top-y.top,s){var x=n.el.getBoundingClientRect();w=y.width-x.width,_=2*(x.top-y.top);var E=Math.sqrt(w*w+_*_),I=u.rotation+.25*Math.PI;C-=Math.cos(I)*E*.5,S-=Math.sin(I)*E*.5}o.style.transform=k}else s?h=y=n.el.getBoundingClientRect():y=h;var T=e.pageYOffset||document.documentElement.scrollTop;return{x:h.left+-C+u.translate.x,y:h.top+-S+T+u.translate.y,w:y.width*u.scale.x-w,h:y.height*u.scale.y-_,transform:u}},closeEl:!0,arrowEl:l.length>1,tapToClose:!0,closeOnScroll:!1},u=!1;if(a!==t&&"object"==typeof a){for(var g in a)a.hasOwnProperty(g)&&(h[g]=a[g]);!0===a.disableZoom&&(u=!0,h.zoomEl=!1,h.getDoubleTapZoom=function(e,t){return t.initialZoomLevel},h.pinchToClose=!1)}return this.activeGallery=new this.PhotoSwipe(s,this.PhotoSwipeUI_Default,l,h),u?s.classList.add("pswp--zoom-disabled"):s.classList.remove("pswp--zoom-disabled"),this.activeGallery.init(),this.isActive=!0,this.activeGallery.listen("destroy",function(){null!==s.parentNode&&s.parentNode.removeChild(s),c.isActive=!1,c.activeGallery=t}),this.activeGallery}},function(t,i){t.PhotoSwipeUI_Default=function(){return function(t,i){var n,o,a,r,s,l,d,c,h,u=this,g=!1,p=!0,m={closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:1500,timeToIdleOutside:1500,closeEl:!0,fullscreenEl:!0,zoomEl:!0,counterEl:!0,arrowEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,fitControlsWidth:1200},f=function(t){if(d)return!0;t=t||e.event,l.timeToIdle&&l.mouseUsed&&!r&&_();for(var n=t.target||t.srcElement;"svg"===n.nodeName||"path"===n.nodeName;)n=n.parentNode;for(var o,a,s=n.getAttribute("class")||"",c=0;c<C.length;c++)(o=C[c]).onTap&&s.indexOf("pswp__"+o.name)>-1&&(o.onTap(),a=!0);if(a){t.stopPropagation&&t.stopPropagation(),d=!0;var h=i.features.isOldAndroid?600:30;setTimeout(function(){d=!1},h)}},v=function(e,t,n){i[(n?"add":"remove")+"Class"](e,"pswp__"+t)},b=function(e){for(var t=0;t<l.closeElClasses.length;t++)if(i.hasClass(e,"pswp__"+l.closeElClasses[t]))return!0},y=0,_=function(){clearTimeout(h),y=0,r&&u.setIdle(!1)},w=function(t){var i=(t=t||e.event).relatedTarget||t.toElement;i&&"HTML"!==i.nodeName||(clearTimeout(h),h=setTimeout(function(){u.setIdle(!0)},l.timeToIdleOutside))},C=[{name:"button--zoom",option:"zoomEl",onTap:t.toggleDesktopZoom},{name:"button-close",option:"closeEl",onTap:t.close},{name:"button-prev",option:"arrowEl",onTap:t.prev},{name:"button-next",option:"arrowEl",onTap:t.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){n.isFullscreen()?n.exit():n.enter()}}];u.init=function(){var e;i.extend(t.options,m,!0),l=t.options,o=i.getChildByClass(t.scrollWrap,"pswp__ui"),(s=t.listen)("onVerticalDrag",function(e){p&&e<.95?u.hideControls():!p&&e>=.95&&u.showControls()}),s("onPinchClose",function(t){p&&t<.9?(u.hideControls(),e=!0):e&&!p&&t>.9&&u.showControls()}),s("zoomGestureEnded",function(){(e=!1)&&!p&&u.showControls()}),s("beforeChange",u.update),s("doubleTap",function(e){var i=t.currItem.initialZoomLevel;t.getZoomLevel()!==i?t.zoomTo(i,e,333):t.zoomTo(l.getDoubleTapZoom(!1,t.currItem),e,333)}),s("preventDragEvent",function(e,t,i){var n=e.target||e.srcElement;n&&n.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(n.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(n.tagName))&&(i.prevent=!1)}),s("bindEvents",function(){i.bind(o,"pswpTap click",f),i.bind(t.scrollWrap,"pswpTap",u.onGlobalTap),t.likelyTouchDevice||i.bind(t.scrollWrap,"mouseover",u.onMouseOver)}),s("unbindEvents",function(){c&&clearInterval(c),i.unbind(document,"mouseout",w),i.unbind(document,"mousemove",_),i.unbind(o,"pswpTap click",f),i.unbind(t.scrollWrap,"pswpTap",u.onGlobalTap),i.unbind(t.scrollWrap,"mouseover",u.onMouseOver),n&&(i.unbind(document,n.eventK,u.updateFullscreen),n.isFullscreen()&&(l.hideAnimationDuration=0,n.exit()),n=null)}),s("destroy",function(){l.captionEl&&(_fakeCaptionContainer&&o.removeChild(_fakeCaptionContainer),i.removeClass(_captionContainer,"pswp__caption--empty")),i.removeClass(o,"pswp__ui--over-close"),i.addClass(o,"pswp__ui--hidden"),u.setIdle(!1)}),l.showAnimationDuration||i.removeClass(o,"pswp__ui--hidden"),s("initialZoomInEnd",function(){l.showAnimationDuration&&i.removeClass(o,"pswp__ui--hidden")}),s("initialZoomOut",function(){i.addClass(o,"pswp__ui--hidden")}),function(){var e,t,n,a=function(o){if(o){for(var a=o.length,r=[],s=0;s<a;s++){e=o[s],t=e.className;for(var d=0;d<C.length;d++)n=C[d],t.indexOf("pswp__"+n.name)>-1&&(l[n.option]?(i.removeClass(e,"pswp__element--disabled"),r.push(e),n.onInit&&n.onInit(e)):i.addClass(e,"pswp__element--disabled"))}r.length}};a(o.children);for(var r=o.querySelectorAll(".pswp__group"),s=0;s<r.length;s++)a(r[s].children)}(),l.timeToIdle&&s("mouseUsed",function(){i.bind(document,"mousemove",_),i.bind(document,"mouseout",w),c=setInterval(function(){2==++y&&u.setIdle(!0)},l.timeToIdle/2)}),clearTimeout(h),h=setTimeout(function(){u.setIdle(!0)},l.timeToIdleOutside),l.fullscreenEl&&!i.features.isOldAndroid&&(n||(n=u.getFullscreenAPI()),n?(i.bind(document,n.eventK,u.updateFullscreen),u.updateFullscreen(),i.addClass(t.template,"pswp--supports-fs")):i.removeClass(t.template,"pswp--supports-fs"))},u.setIdle=function(e){r=e,v(o,"ui--idle",e)},u.update=function(){g=!(!p||!t.currItem)},u.updateFullscreen=function(e){e&&setTimeout(function(){t.setScrollOffset(0,i.getScrollY())},50),i[(n.isFullscreen()?"add":"remove")+"Class"](t.template,"pswp--fs")},u.onGlobalTap=function(n){var o=(n=n||e.event).target||n.srcElement;if(!d)if(n.detail&&"mouse"===n.detail.pointerType){if(b(o))return void t.close();if(i.hasClass(o,"pswp__img")){if(l.disableZoom)return void t.close();if(1===t.getZoomLevel()&&t.getZoomLevel()<=t.currItem.fitRatio){if(l.clickToCloseNonZoomable)return void t.close()}else t.toggleDesktopZoom(n.detail.releasePoint)}}else if(l.tapToToggleControls&&(p?u.hideControls():u.showControls()),l.tapToClose&&(i.hasClass(o,"pswp__img")||b(o)))return void t.close()},u.onMouseOver=function(t){var i=(t=t||e.event).target||t.srcElement;v(o,"ui--over-close",b(i))},u.hideControls=function(){i.addClass(o,"pswp__ui--hidden"),p=!1},u.showControls=function(){p=!0,g||u.update(),i.removeClass(o,"pswp__ui--hidden")},u.toggleFullscreen=function(){n.isFullscreen()?n.exit():n.enter()},u.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)},u.getFullscreenAPI=function(){var e,i=document.documentElement,n="fullscreenchange";return i.requestFullscreen?e={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:n}:i.mozRequestFullScreen?e={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+n}:i.webkitRequestFullscreen?e={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+n}:i.msRequestFullscreen&&(e={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),e&&(e.enter=function(){if(a=l.closeOnScroll,l.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK)return t.template[this.enterK]();t.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},e.exit=function(){return l.closeOnScroll=a,document[this.exitK]()},e.isFullscreen=function(){return document[this.elementK]}),e}}}()}(this)}.call(window.lightbox={},window),function(){"use strict";new MobileAdjustments,window.baseUnit=new BaseUnit,Cargo.Event.on("element_resizer_init",function(e){e.setOptions({cargo_refreshEvents:["inline-editor-load-complete","inspector_preview","page_collection_reset","direct_link_loaded","mobile_padding_set"],generic_refreshEvents:[],updateEvents:["resize","orientationchange"],forceVerticalMargin:0,forceMobileImagesFullWidth:Cargo.Model.DisplayOptions.get("layout_options").mobile_images_full_width,adjustElementsToWindowHeight:Cargo.Model.DisplayOptions.get("layout_options").limit_vertical_images,scrollTransitionThreshold:-100,scrollTransition:Cargo.Model.DisplayOptions.get("layout_options").scroll_transition,centerElements:!1,allowInit:!0})})}(),function(global,setTimeout){function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){var i;if(e)for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}function eachReverse(e,t){var i;if(e)for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,n){return t&&eachProp(t,function(t,o){!i&&hasProp(e,o)||(!n||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[o]=t:(e[o]||(e[o]={}),mixin(e[o],t,i,n)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,n){var o=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return o.requireType=e,o.requireModules=n,i&&(o.originalError=i),o}function newContext(e){function t(e,t,i){var n,o,a,r,s,l,d,c,h,u,g=t&&t.split("/"),p=w.map,m=p&&p["*"];if(e&&(l=(e=e.split("/")).length-1,w.nodeIdCompat&&jsSuffixRegExp.test(e[l])&&(e[l]=e[l].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&g&&(e=g.slice(0,g.length-1).concat(e)),function(e){var t,i;for(t=0;t<e.length;t++)if("."===(i=e[t]))e.splice(t,1),t-=1;else if(".."===i){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}(e),e=e.join("/")),i&&p&&(g||m)){e:for(a=(o=e.split("/")).length;a>0;a-=1){if(s=o.slice(0,a).join("/"),g)for(r=g.length;r>0;r-=1)if((n=getOwn(p,g.slice(0,r).join("/")))&&(n=getOwn(n,s))){d=n,c=a;break e}!h&&m&&getOwn(m,s)&&(h=getOwn(m,s),u=a)}!d&&h&&(d=h,c=u),d&&(o.splice(0,c,d),e=o.join("/"))}return getOwn(w.pkgs,e)||e}function i(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===b.contextName)return t.parentNode.removeChild(t),!0})}function n(e){var t=getOwn(w.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),b.require.undef(e),b.makeRequire(null,{skipMap:!0})([e]),!0}function o(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function a(e,i,n,a){var r,s,l,d,c=null,h=i?i.name:null,u=e,g=!0,p="";return e||(g=!1,e="_@r"+(A+=1)),c=(d=o(e))[0],e=d[1],c&&(c=t(c,h,a),s=getOwn(E,c)),e&&(c?p=s&&s.normalize?s.normalize(e,function(e){return t(e,h,a)}):-1===e.indexOf("!")?t(e,h,a):e:(c=(d=o(p=t(e,h,a)))[0],p=d[1],n=!0,r=b.nameToUrl(p))),{prefix:c,name:p,parentMap:i,unnormalized:!!(l=!c||s||n?"":"_unnormalized"+(M+=1)),url:r,originalName:u,isDefine:g,id:(c?c+"!"+p:p)+l}}function r(e){var t=e.id,i=getOwn(C,t);return i||(i=C[t]=new b.Module(e)),i}function s(e,t,i){var n=e.id,o=getOwn(C,n);!hasProp(E,n)||o&&!o.defineEmitComplete?(o=r(e)).error&&"error"===t?i(o.error):o.on(t,i):"defined"===t&&i(E[n])}function l(e,t){var i=e.requireModules,n=!1;t?t(e):(each(i,function(t){var i=getOwn(C,t);i&&(i.error=e,i.events.error&&(n=!0,i.emit("error",e)))}),n||req.onError(e))}function d(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(b.defQueueMap[t]=!0),x.push(e)}),globalDefQueue=[])}function c(e){delete C[e],delete S[e]}function h(){var e,t,o=1e3*w.waitSeconds,a=o&&b.startTime+o<(new Date).getTime(),r=[],s=[],d=!1,c=!0;if(!f){if(f=!0,eachProp(S,function(e){var o=e.map,l=o.id;if(e.enabled&&(o.isDefine||s.push(e),!e.error))if(!e.inited&&a)n(l)?(t=!0,d=!0):(r.push(l),i(l));else if(!e.inited&&e.fetched&&o.isDefine&&(d=!0,!o.prefix))return c=!1}),a&&r.length)return(e=makeError("timeout","Load timeout for modules: "+r,null,r)).contextName=b.contextName,l(e);c&&each(s,function(e){!function e(t,i,n){var o=t.map.id;t.error?t.emit("error",t.error):(i[o]=!0,each(t.depMaps,function(o,a){var r=o.id,s=getOwn(C,r);!s||t.depMatched[a]||n[r]||(getOwn(i,r)?(t.defineDep(a,E[r]),t.check()):e(s,i,n))}),n[o]=!0)}(e,{},{})}),a&&!t||!d||!isBrowser&&!isWebWorker||_||(_=setTimeout(function(){_=0,h()},50)),f=!1}}function u(e){hasProp(E,e[0])||r(a(e[0],null,!0)).init(e[1],e[2])}function g(e,t,i,n){e.detachEvent&&!isOpera?n&&e.detachEvent(n,t):e.removeEventListener(i,t,!1)}function p(e){var t=e.currentTarget||e.srcElement;return g(t,b.onScriptLoad,"load","onreadystatechange"),g(t,b.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function m(){var e;for(d();x.length;){if(null===(e=x.shift())[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));u(e)}b.defQueueMap={}}var f,v,b,y,_,w={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},C={},S={},k={},x=[],E={},I={},T={},A=1,M=1;return y={require:function(e){return e.require?e.require:e.require=b.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?E[e.map.id]=e.exports:e.exports=E[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(w.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},(v=function(e){this.events=getOwn(k,e.id)||{},this.map=e,this.shim=getOwn(w.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,i,n){n=n||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,b.startTime=(new Date).getTime();var e=this.map;return this.shim?void b.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;I[e]||(I[e]=!0,b.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,n=this.depExports,o=this.exports,a=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(a)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=b.execCb(i,a,n,o)}catch(t){e=t}else o=b.execCb(i,a,n,o);if(this.map.isDefine&&void 0===o&&((t=this.module)?o=t.exports:this.usingExports&&(o=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",l(this.error=e)}else o=a;if(this.exports=o,this.map.isDefine&&!this.ignore&&(E[i]=o,req.onResourceLoad)){var r=[];each(this.depMaps,function(e){r.push(e.normalizedMap||e)}),req.onResourceLoad(b,this.map,r)}c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(b.defQueueMap,i)||this.fetch()}},callPlugin:function(){var e=this.map,i=e.id,n=a(e.prefix);this.depMaps.push(n),s(n,"defined",bind(this,function(n){var o,d,h,u=getOwn(T,this.map.id),g=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,m=b.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(g=n.normalize(g,function(e){return t(e,p,!0)})||""),s(d=a(e.prefix+"!"+g,this.map.parentMap),"defined",bind(this,function(e){this.map.normalizedMap=d,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),void((h=getOwn(C,d.id))&&(this.depMaps.push(d),this.events.error&&h.on("error",bind(this,function(e){this.emit("error",e)})),h.enable()))):u?(this.map.url=b.nameToUrl(u),void this.load()):((o=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})})).error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[i],eachProp(C,function(e){0===e.map.id.indexOf(i+"_unnormalized")&&c(e.map.id)}),l(e)}),o.fromText=bind(this,function(t,n){var s=e.name,d=a(s),c=useInteractive;n&&(t=n),c&&(useInteractive=!1),r(d),hasProp(w.config,i)&&(w.config[s]=w.config[i]);try{req.exec(t)}catch(e){return l(makeError("fromtexteval","fromText eval for "+i+" failed: "+e,e,[i]))}c&&(useInteractive=!0),this.depMaps.push(d),b.completeLoad(s),m([s],o)}),void n.load(e.name,m,o,w))})),b.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){S[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,n,o;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,o=getOwn(y,e.id))return void(this.depExports[t]=o(this));this.depCount+=1,s(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?s(e,"error",bind(this,this.errback)):this.events.error&&s(e,"error",bind(this,function(e){this.emit("error",e)}))}i=e.id,n=C[i],hasProp(y,i)||!n||n.enabled||b.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(C,e.id);t&&!t.enabled&&b.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},(b={config:w,contextName:e,registry:C,defined:E,urlFetched:I,defQueue:x,defQueueMap:{},Module:v,makeModuleMap:a,nextTick:req.nextTick,onError:l,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,i){return(-1===i.indexOf("?")?"?":"&")+t}}var i=w.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(w[t]||(w[t]={}),mixin(w[t],e,!0,!0)):w[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(T[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=b.makeShimExports(e)),i[t]=e}),w.shim=i),e.packages&&each(e.packages,function(e){var t;t=(e="string"==typeof e?{name:e}:e).name,e.location&&(w.paths[t]=e.location),w.pkgs[t]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(C,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t,null,!0))}),(e.deps||e.callback)&&b.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}},makeRequire:function(n,o){function s(t,i,d){var c,u;return o.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof t?isFunction(i)?l(makeError("requireargs","Invalid require call"),d):n&&hasProp(y,t)?y[t](C[n.id]):req.get?req.get(b,t,n,s):(c=a(t,n,!1,!0).id,hasProp(E,c)?E[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(n?"":". Use require([])")))):(m(),b.nextTick(function(){m(),(u=r(a(null,n))).skipMap=o.skipMap,u.init(t,i,d,{enabled:!0}),h()}),s)}return o=o||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var i,o=e.lastIndexOf("."),a=e.split("/")[0];return-1!==o&&(!("."===a||".."===a)||o>1)&&(i=e.substring(o,e.length),e=e.substring(0,o)),b.nameToUrl(t(e,n&&n.id,!0),i,!0)},defined:function(e){return hasProp(E,a(e,n,!1,!0).id)},specified:function(e){return e=a(e,n,!1,!0).id,hasProp(E,e)||hasProp(C,e)}}),n||(s.undef=function(e){d();var t=a(e,n,!0),o=getOwn(C,e);o.undefed=!0,i(e),delete E[e],delete I[t.url],delete k[e],eachReverse(x,function(t,i){t[0]===e&&x.splice(i,1)}),delete b.defQueueMap[e],o&&(o.events.defined&&(k[e]=o.events),c(e))}),s},enable:function(e){getOwn(C,e.id)&&r(e).enable()},completeLoad:function(e){var t,i,o,a=getOwn(w.shim,e)||{},r=a.exports;for(d();x.length;){if(null===(i=x.shift())[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);u(i)}if(b.defQueueMap={},o=getOwn(C,e),!t&&!hasProp(E,e)&&o&&!o.inited){if(!(!w.enforceDefine||r&&getGlobal(r)))return n(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));u([e,a.deps||[],a.exportsFn])}h()},nameToUrl:function(e,t,i){var n,o,a,r,s,l,d=getOwn(w.pkgs,e);if(d&&(e=d),l=getOwn(T,e))return b.nameToUrl(l,t,i);if(req.jsExtRegExp.test(e))r=e+(t||"");else{for(n=w.paths,a=(o=e.split("/")).length;a>0;a-=1)if(s=getOwn(n,o.slice(0,a).join("/"))){isArray(s)&&(s=s[0]),o.splice(0,a,s);break}r=o.join("/"),r=("/"===(r+=t||(/^data\:|^blob\:|\?/.test(r)||i?"":".js")).charAt(0)||r.match(/^[\w\+\.\-]+:/)?"":w.baseUrl)+r}return w.urlArgs&&!/^blob\:/.test(r)?r+w.urlArgs(e,r):r},load:function(e,t){req.load(b,e,t)},execCb:function(e,t,i,n){return t.apply(n,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=p(e);b.completeLoad(t.id)}},onScriptError:function(e){var t=p(e);if(!n(t.id)){var i=[];return eachProp(C,function(e,n){0!==n.indexOf("_@r")&&each(e.depMaps,function(e){if(e.id===t.id)return i.push(n),!0})}),l(makeError("scripterror",'Script error for "'+t.id+(i.length?'", needed by: '+i.join(", "):'"'),e,[t.id]))}}}).require=b.makeRequire(),b}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.2",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,n){var o,a,r=defContextName;return isArray(e)||"string"==typeof e||(a=e,isArray(t)?(e=t,t=i,i=n):e=[]),a&&a.context&&(r=a.context),(o=getOwn(contexts,r))||(o=contexts[r]=req.s.newContext(r)),a&&o.configure(a),o.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,i){var n=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return n.type=e.scriptType||"text/javascript",n.charset="utf-8",n.async=!0,n},req.load=function(e,t,i){var n,o=e&&e.config||{};if(isBrowser)return(n=req.createNode(o,t,i)).setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",t),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=i,o.onNodeCreated&&o.onNodeCreated(n,o,t,i),currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{setTimeout(function(){},0),importScripts(i),e.completeLoad(t)}catch(n){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,n,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,i){var n,o;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&((n=currentlyAddingScript||getInteractiveScript())&&(e||(e=n.getAttribute("data-requiremodule")),o=contexts[n.getAttribute("data-requirecontext")])),o?(o.defQueue.push([e,t,i]),o.defQueueMap[e]=!0):globalDefQueue.push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout);